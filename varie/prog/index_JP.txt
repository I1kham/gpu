<html>
<head>
	<title>PROGRAMMING MENU</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link href="style.css" rel="stylesheet" type="text/css">
	<link href="keyboard.css" rel="stylesheet" type="text/css">
</head>

<body onLoad="rheaBootstrap()">
<div class="wrapper1024x600">
	<div id="pagePinCode">
		<div id="pagePinCode_alert1" style="display:none; background-color:#dda300; margin-top:10px; color:#fff; padding:20px"><b>注意</b>: 設定されたサニタイズサイクルは <b>テストサイクル</b>であり、まだ有効ではありません。</div>

		<div style="margin:10px auto 0 auto; display:inline-block">
			<div id="pagePinCodeDisplay"></div>
			<div class="pagePinCodeButton" onclick="pagePinCode_onBtnPress(1)">1</div>
			<div class="pagePinCodeButton" onclick="pagePinCode_onBtnPress(2)">2</div>
			<div class="pagePinCodeButton" onclick="pagePinCode_onBtnPress(3)">3</div>
			<div class="clear"></div>
			<div class="pagePinCodeButton" onclick="pagePinCode_onBtnPress(4)">4</div>
			<div class="pagePinCodeButton" onclick="pagePinCode_onBtnPress(5)">5</div>
			<div class="pagePinCodeButton" onclick="pagePinCode_onBtnPress(6)">6</div>
			<div class="clear"></div>
			<div class="pagePinCodeButton" onclick="pagePinCode_onBtnPress(7)">7</div>
			<div class="pagePinCodeButton" onclick="pagePinCode_onBtnPress(8)">8</div>
			<div class="pagePinCodeButton" onclick="pagePinCode_onBtnPress(9)">9</div>
			<div class="clear"></div>
		</div>
	</div>
	
	
	<!-- modal "are you sure" -->
	<div id="divAreYouSure" class="pagePleaseWait" style="background-color:rgba(0,0,0,0.95)">
		<div class="page">
			<br><br><center>選択した操作を起動してよろしいですか？</center>

			<div style="position:absolute; top:450px; left:680px;"><div class="UIButton bigButton3x4" onclick="areYouSure_onBtnYES()"><p>はい</p></div></div>
			<div style="position:absolute; top:450px; left:20px;"><div class="UIButton bigButton3x4" onclick="areYouSure_onBtnNO()"><p>いいえ</p></div></div>
		</div>
	</div> <!-- modal "are you sure" -->
	
	<!-- modal "lavaggio sanitario cappuccinatore indux" -->
	<div id="divLavSanMilkerIndux" class="pagePleaseWait" style="background-color:rgba(0,0,0,0.95)">
		<div class="page">
			<br><br><center>ミルカーワンタッチクリーニング</center>

			<br><br><br>
			<center>
			<div class="UIButton bigButton3x4" onclick="divLavSanMilkerIndux_onBtnPressed(0)"><p>中断します</p></div>
			<br>
			<div class="UIButton bigButton3x4" onclick="divLavSanMilkerIndux_onBtnPressed(1)"><p>クリーニングタブレットを使用します</p></div>
			<br>
			<div class="UIButton bigButton3x4" onclick="divLavSanMilkerIndux_onBtnPressed(2)"><p>液体洗剤を使用します</p></div>
			</center>
		</div>
	</div> <!-- modal "divLavSanMilkerIndux" -->	
	
	<!--modal wifi password -->
	<div id="pagePasswordForWiFi" class="pagePleaseWait" style="background-color:rgba(0,0,0,0.95)">
		<div class="page">
			<div id="pagePasswordForWiFi_pwd" style="margin-top:60px; padding:10px">
				PASSWORD:
				<input type='text' id='txtPasswordForWiFi' class='UITextInputBox use-keyboard-input' style='width:800px;'>
				<div style="margin-left:600px"><div class="UIButton bigButton3x4" onclick="pageDevices_network_onWiFiPwdEntered()"><p>OK</p></div></div>
			</div>
			
			<div id="pagePasswordForWiFi_list" class="UISelectFullPage" style="padding:10px">
				<div id="pagePasswordForWiFi_list_cnt"></div>
				<div style="position:absolute; top:5px; right:25px"><img src="img/close32x32.png" style="width:48px" draggable='false' onmousedown="javascript:pageDevices_network_hidePagePasswordWiFi()"></div>
			</div>
		</div>
	</div>	<!--modal wifi password -->

	<!--modal LTE APN -->
	<div id="pageLTEConfig" class="pagePleaseWait" style="background-color:rgba(0,0,0,0.95)">
		<div class="page">
			<br>
			<table border='0' cellspacing='0' align="center">
				<tr><td>APN:</td>  <td><input type='text' id='pageLTEConfig_apn' class='UITextInputBox use-keyboard-input' style='width:800px;'></td></tr>
				<tr><td>USER:</td> <td><input type='text' id='pageLTEConfig_usr' class='UITextInputBox use-keyboard-input' style='width:800px;'></td></tr>
				<tr><td>PWD:</td>  <td><input type='text' id='pageLTEConfig_pwd' class='UITextInputBox use-keyboard-input' style='width:800px;'></td></tr>
			</table>
			<div style="padding:10px">
				<div style="float:left"><div class="UIButton bigButton3x4" onclick="pageDevices_network_onLTEConfigEnd(0)"><p>QUIT</p></div></div>
				<div style="float:right"><div class="UIButton bigButton3x4" onclick="pageDevices_network_onLTEConfigEnd(1)"><p>確認</p></div></div>
				<div class="clear"></div>
			</div>
		</div>
	</div>	<!--modal wifi password -->	
	
	<div id="pagePleaseWait" class="pagePleaseWait">
		<div id="pagePleaseWait_header_left" class="pagePleaseWait_header_left"></div>
		<div id="pagePleaseWait_header_right" class="pagePleaseWait_header_right"></div>
		<div class="clear"></div>

		<!-- pagina dedicata al lavaggio capp induzione. E' un riepilogo delle operazioni da fare prima di far partire il lavaggio -->
		<div id="pagePleaseWait_milkerInduxWashing" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%; background-color:rgb(58,29,12); overflow:hidden;">
			<div style="width:94%; margin:20px auto auto auto; position:relative">
				<table border='0' cellspacing='0' align="center" style="width:930px">
					<tr valign="top" style="height:234px">
						<td>
							<h2>ミルカーワンタッチクリーニング</h2>
							<div id="pagePleaseWait_milkerInduxWashing_info">清掃を開始する前に確認してください。<OL> <LI>給水が利用可能です</ LI> <LI>廃棄物タンクは空</ LI> <Li>ミルクチューブがクリーニングジャグ内にあります</ li> < Li>洗剤は容器に充填されています</ li> </ OL></div>
						</td>
						<td id="pagePleaseWait_milkerInduxWashing_1" style="width:310px; text-align:center;:center"><img src="img/milkerInduxClean01.jpg" style="width:260px"></td>
					</tr>
				</table>
				<table border='0' cellspacing='0' align="center" style="width:930px">
					<tr valign="top">
						<td style="width:310px; text-align:center;"><img id="pagePleaseWait_milkerInduxWashing_2" src="img/milkerInduxClean02.jpg" style="width:260px"></td>
						<td style="width:310px; text-align:center;"><img id="pagePleaseWait_milkerInduxWashing_3" src="img/milkerInduxClean03.jpg" style="width:260px"></td>
						<td style="width:310px; text-align:center;"><img id="pagePleaseWait_milkerInduxWashing_4" src="img/milkerInduxClean04.jpg" style="width:260px"></td>
					</tr>
				</table>
			</div>
		</div>				

		<!-- page please wait -->
		<div class="page">
			<div id="pagePleaseWait_wait" style="position:absolute; top:150px; left:462px"><img draggable='false' src="img/animationRound.gif"></div>
			
			<div id="pagePleaseWait_freeText" class="pagePleaseWait_freeText"></div>
			
			<div id="pagePleaseWait_calibMilkPump" style="position:absolute; top:40px; left:10px; width:984px; height:500px; background-color:rgba(40,40,40,0.7); color:#fff; display:none; padding:10px; border:solid 1px #fff; border-radius:10px;">
				<div id="pagePleaseWait_calibMilkPump_1">
					<table border='0' cellspacing='0' cellpadding='0'>
						<tr valign="middle">
							<td>再度、すすぎをしますか</td>
							<td>&nbsp;&nbsp;</td>
							<td><div id='pagePleaseWait_calibMilkPump_1_water' class='UIButton bigButton60 actionButton' data-caption='もう一度' data-onclick="pageMilker_dispenseAgainWater()"></div></td>
						</tr>
					</table>
					<hr>
				</div>
				
				<div id="pagePleaseWait_calibMilkPump_text"></div>
				<div class="UINumber" id="pagePleaseWait_calibMilkPump_num" data-numfigures="3" data-max="999" data-um="ml"></div>
	
			</div>			
								
			<div id="pagePleaseWait_calibration" style="position:absolute; top:40px; left:10px; width:984px; height:500px; background-color:rgba(40,40,40,0.7); color:#fff; display:none; padding:10px; border:solid 1px #fff; border-radius:10px;">
				<div id="pagePleaseWait_calibration_1">
					<table border='0' cellspacing='0' cellpadding='0'>
						<tr valign="middle">
							<td>もう一度押すと挽けます</td>
							<td>&nbsp;&nbsp;</td>
							<td><div id='pagePleaseWait_calibration_1_grind' class='UIButton bigButton60 actionButton' data-caption='GRIND AGAIN' data-onclick="pageCalibration_grindAgain()"></div></td>
						</tr>
					</table>
					<hr>

					<div id="pagePleaseWait_calibration_1_varigrind">
						Varigrindの挽き目調整
						<table border='0' class='elenco'>
							<tr>
								<td style="width:33%" align="center">
									ポジション<br>
									<div style="float:left; margin-right:10px">現在の値:</div>
									<div id="pagePleaseWait_calibration_1_vg" style="float:left" class="bigCaption15">000</div>
									<div class="clear"></div>
								</td>
								<td style="width:34%" align="center">
									<div style="float:left; margin-right:10px"><br>目標値</div>
									<div style="float:left;"><div class="UINumber" id="pagePleaseWait_calibration_1_vg_target" data-numfigures="3" data-max="500"></div></div>
									<div class="clear"></div>
								</td>
								<td style="width:33%" align="center"><div id='pagePleaseWait_calibration_1_vg_set' class='UIButton bigButton60 actionButton' data-caption='SET' data-onclick="pageCalibration_setVGrind()"></div></td>
							</tr>
						</table>
						<br>
					</div>
				</div>
				
				<div id="pagePleaseWait_calibration_2">
					<table border='0' cellspacing='0' cellpadding='0'>
						<tr valign="middle">
							<td>もう一度押すと挽けます</td>
							<td>&nbsp;&nbsp;</td>
							<td><div id='pagePleaseWait_calibration_2_runMotor' class='UIButton bigButton60 actionButton' data-caption='RUN MOTOR AGAIN' data-onclick="pageCalibration_runMotorAgain()"></div></td>
						</tr>
					</table>
					<hr>
				</div>
				<div id="pagePleaseWait_calibration_text"></div>
				<div class="UINumber" id="pagePleaseWait_calibration_num" data-numfigures="4" data-decimal="1" data-max="9999" data-um="gr"></div>
			</div>
			
			<div id="pagePleaseWait_grinderCleaning" style="display:none; position:absolute; top:80px; left:20px; width:1006;">
			   クリーニングするグラインダーを選択し、[続行]or[キャンセル]を押してください.<br>
				<div id="pagePleaseWait_grinderCleaning_1or2" class="UIOption" data-option="1|グラインダー 1|2|グラインダー 2"></div></td>
			</div>

			<!-- pagina dedicata alla calibrazione delle pompe EV, permette di scegliere una velocita' -->
			<div id="pagePleaseWait_calibEVPump" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%; overflow:hidden; background-color:rgb(0,0,0)">
				<br>
				<table border='0' class="elenco" cellspacing='0' align="center" style="width:930px">
					<tr>
						<th style="text-align:left; width:300px">速度</th>
						<th style="text-align:left; width:300px">cc/sec</th>
						<th style="text-align:left"></th></tr>
					<tr>
						<td>低い</td>
						<td><div id="pagePleaseWait_calibEVPump_low"></div></td>
						<td><div class='UIButton bigButton60 actionButton' onclick="pageCalibration_waterreset(255,0)"><p>リセット</p></div></td>
						<td><div class='UIButton bigButton60 actionButton' onclick="pageCalibration_waterstart(255,0)"><p>校正</p></div></td>
					</tr>
					<tr>
						<td>普通</td>
						<td><div id="pagePleaseWait_calibEVPump_norm"></div></td>
						<td><div class='UIButton bigButton60 actionButton' onclick="pageCalibration_waterreset(255,1)"><p>リセット</p></div></td>
						<td><div class='UIButton bigButton60 actionButton' onclick="pageCalibration_waterstart(255,1)"><p>校正</p></div></td>
					</tr>
					<tr>
						<td>高い</td>
						<td><div id="pagePleaseWait_calibEVPump_high"></div></td>
						<td><div class='UIButton bigButton60 actionButton' onclick="pageCalibration_waterreset(255,2)"><p>リセット</p></div></td>
						<td><div class='UIButton bigButton60 actionButton' onclick="pageCalibration_waterstart(255,2)"><p>校正</p></div></td>
					</tr>
				</table>
			</div>
			
			<div id="pagePleaseWait_freeBtn1" style="position:absolute; top:450px; left:680px; display:none">
				<div id="bntFree1" class="UIButton bigButton3x4"><p id="bntFree1Text">testo bottone 1</p></div>
			</div>
			<div id="pagePleaseWait_freeBtn3" style="position:absolute; top:450px; left:350px; display:none">
				<div id="bntFree3" class="UIButton bigButton3x4"><p id="bntFree3Text">testo bottone 3</p></div>
			</div>			
			<div id="pagePleaseWait_freeBtn2" style="position:absolute; top:450px; left:20px; display:none">
				<div id="bntFree2" class="UIButton bigButton3x4"><p id="bntFree2Text">testo bottone 2 bottone 2</p></div>
			</div>

			<div id="pagePleaseWait_freeBtnTrick" style="position:absolute; right:10px; top:50px; width:100px; height:80px; background-color:rgba(40,40,40,0.7);">&nbsp;&nbsp;&nbsp;&nbsp;</div>
			
		</div>
	</div>
	
	<div id="UISelectFullPage" class="UISelectFullPage">
		<div id="UISelectFullPage_cnt" style="padding:10px"></div>
		<div style="position:absolute; top:5px; right:5px"><img src="img/close32x32.png" style="width:48px" draggable='false' onmousedown="javascript:UISelect_hideFullPage()"></div>
	</div>
			
	<!-- header -->
	<div class="header">
		<div id="divHeaderC" class="header_C"></div>
		<div class="header_R colorGrey">
			<div id="divHeaderR_data" style="float:left; margin-right:10px"></div>
			<div id="divHeaderR_ora" style="float:left;"></div>
			<div class="clear"></div>
		</div>
		<div class="clear"></div>
		
		<div id="divCurLang" style="position:absolute; top:0; left:0; width:150px; height:46px; z-index:50;" onclick="menuLang_show(1)">
			<div style="padding-left:15px"><img src="img/flags/JP.png"></div>
		</div>
	</div> <!-- header -->
	
	<div id="divMenuLang">
		<div style="padding:10px">
			<div style="float:left; width:33%">
				<ul>
					<li onmousedown="menuLang_onUserSelected('GB')"><img src="img/flags/GB.png"> ENGLISH</li>
					<li onmousedown="menuLang_onUserSelected('IT')"><img src="img/flags/IT.png"> ITALIANO</li>
					<li onmousedown="menuLang_onUserSelected('FR')"><img src="img/flags/FR.png"> FRANÇAIS</li>
					<li onmousedown="menuLang_onUserSelected('DE')"><img src="img/flags/DE.png"> DEUTSCH</li>
					<li onmousedown="menuLang_onUserSelected('ES')"><img src="img/flags/ES.png"> ESPAÑOL</li>
					<li onmousedown="menuLang_onUserSelected('PT')"><img src="img/flags/PT.png"> PORTUGUÉS</li>
					<li onmousedown="menuLang_onUserSelected('TR')"><img src="img/flags/TR.png"> TÜRKÇE</li>
				</ul>
			</div>
			<div style="float:left; width:33%">
				<ul>
					<li onmousedown="menuLang_onUserSelected('HU')"><img src="img/flags/HU.png"> MAGYAR</li>		<!-- ungherese -->
					<li onmousedown="menuLang_onUserSelected('CN')"><img src="img/flags/CN.png"> 中文</li>
					<li onmousedown="menuLang_onUserSelected('RU')"><img src="img/flags/RU.png"> РУССКИЙ</li>
					<li onmousedown="menuLang_onUserSelected('RO')"><img src="img/flags/RO.png"> ROMÂNĂ</li>
					<li onmousedown="menuLang_onUserSelected('NL')"><img src="img/flags/NL.png"> NEDERLANDS</li>
					<li onmousedown="menuLang_onUserSelected('PL')"><img src="img/flags/PL.png"> POLSKI</li>
					<li onmousedown="menuLang_onUserSelected('JP')"><img src="img/flags/JP.png"> 日本</li>
				</ul>
			</div>
			<div style="float:right; width:33%">
				<ul>
					<li onmousedown="menuLang_onUserSelected('CZ')"><img src="img/flags/CZ.png"> ČEŠTINA</li>	<!-- czech -->
					<li onmousedown="menuLang_onUserSelected('KO')"><img src="img/flags/KO.png"> 한글어</li>		<!-- koreano -->
					<li onmousedown="menuLang_onUserSelected('BG')"><img src="img/flags/BG.png"> БЪЛГАРСКИ</li>	<!-- bulgaro -->
					<li onmousedown="menuLang_onUserSelected('UA')"><img src="img/flags/UA.png"> УКРАЇНСЬКА</li>	<!-- ucraino -->
					<li onmousedown="menuLang_onUserSelected('HR')"><img src="img/flags/HR.png"> HRVATSKI</li>	<!-- croato -->
				</ul>
			</div>
			
			<div class="clear"></div>
		</div>
		<div style="position:absolute; top:5px; right:5px"><img src="img/close32x32.png" style="width:48px" draggable='false' onmousedown="menuLang_show(0)"></div>
	</div>
	

	<div id="divPage" class="page">
		<!--- page Main Menu -->
		<div id="pageMainMenu" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' cellspacing='0' cellpadding='0' width='99%' align='center'>
					<tr valign="middle">
						<td width="33%" align="center"><div class="UIButton bigButton3x4" data-caption="メンテナンス" data-onclick="pageMaintenance_show()"></div></td>
						<td width="33%" align="center"><div class="UIButton bigButton3x4" data-caption="クリーニング/ <br>リンス" data-onclick="pageCleaning_show()"></div></td>
						<td width="33%" align="center"><div id="pageMainMenu_btnDataAudit" class="UIButton bigButton3x4" data-caption="データー　オーデット" data-onclick="pageDataAudit_show(1)"></div></td>
					</tr>
					<tr valign="middle">
						<td width="33%" align="center"><div class="UIButton bigButton3x4" data-caption="メニューボタン設定" data-onclick="pageSelections_show()"></div></td>
						<td width="33%" align="center"><div id="pageMainMenu_btnEspressoCalib" class="UIButton bigButton3x4 UIdisabled" data-caption="コーヒーキャリブレーション" data-onclick="pageExpCalib_show()"></div></td>
						<td width="33%" align="center"><div id="pageMainMenu_btnInstantCalib" class="UIButton bigButton3x4" data-caption="パウダー<br>キャリブレーション" data-onclick="pageCalibration_show()"></div></td>
					</tr>
					<tr valign="middle">
						<td width="33%" align="center"><div class="UIButton bigButton3x4" data-caption="温度" data-onclick="pageTemperature_show()"></div></td>
						<td width="33%" align="center"><div id="pageMainMenu_btnPayment" class="UIButton bigButton3x4" data-caption="ペイメントシステム" data-onclick="pagePayment_show()"></div></td>
						<td width="33%" align="center"><div id="pageMainMenu_btnProdQty" class="UIButton bigButton3x4" data-caption="製品数量設定" data-onclick="pageProductQty_show()"></div></td>
					</tr>
					<tr valign="middle">
						<td width="33%" align="center"><div class="UIButton bigButton3x4" data-caption="デバイス" data-onclick="pageDevices_show()"></div></td>						
						<td width="33%" align="center"><div class="UIButton bigButton3x4" data-caption="時計" data-onclick="pageClock_show()"></div></td>
						<td width="33%" align="center"><div id="pageMainMenu_btnMilker" class="UIButton bigButton3x4 UIdisabled" data-caption="ミルカー" data-onclick="pageMilker_show()"></div></td>
					</tr>
					<tr valign="middle">
						<td width="33%" align="center"><div class="UIButton bigButton3x4" data-caption="その他" data-onclick="pageMiscellaneous_show()"></div></td>

						<td width="33%" align="center" id="tab_mainmenu_tdManual"><div id="divBtnManual" style="display:none"><div class="UIButton bigButton3x4" data-caption="マニュアル" data-onclick="manualViewBox_show()"></div></div></td>
						<td width="33%" align="center">
							<div id="divBtnOldMenuProg" class="UIButton bigButton3x4" style="display:none" data-caption="旧Progメニュー" data-onclick="pageMiscellaneous_oldProgMenu()"></div>
							<div id="divBtnQuitAndSave" class="UIButton bigButton3x4" style="display:none" data-caption="QUIT" data-onclick="quit()"></div>
						</td>
					</tr>
				</table>
			</div>
		</div><!--- page Main Menu -->
		
		<!-- page Maintenance -->
		<div id="pageMaintenance" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' width='100%'>
					<tr valign='middle'>
						<td><div class='UIOptionSmall' id='pageMaintenance_selector' data-option='0|ゼネラルオプション|1|インストール|2|エラーリスト' data-onclick='pageMaintenance_onSelector()'></div></td>
					</tr>
				</table>
				<br>

				<div id="pageMaintenance_gs" style="display:none">
					<table border='0' class='elenco'>
						<tr style="height:1px">
							<td>&nbsp;</td>
							<td style="width:356px">&nbsp;</td>
							<td style="width:267px">&nbsp;</td>
						</tr>
					
						<tr>
							<td>アクティベートH <sub> 2 </ sub> 0フィルターリセット</td>
							<td colspan="2"><div class="UIOption" data-option="1|はい|0|いいえ" data-da3="7090"></div></td>
						</tr>
						
						<tr>
							<td>
								ウォーターフィルターカウンター<br>
								<div style="float:left; margin-right:10px">現在の値:</div>
								<div id="pageMaintenance_11" style="float:left" class="bigCaption15">00000</div>
								<div class="clear"></div>
							</td>
							<td><div class="UINumber" id="pageMaintenance_11_cap" data-numfigures="5" data-da3="7394" data-max="60000" data-forbidden="1"></div></td>
							<td align="right"><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageMaintenance_resetDec(11)"></div></td>
						</tr>
						<tr id="pageMaintenance_decCofBrew">
							<td>
								抽出ユニット カウンター<br>
								<div style="float:left; margin-right:10px">現在の値:</div>
								<div id="pageMaintenance_12" style="float:left" class="bigCaption15">0000</div>
								<div class="clear"></div>
							</td>
							<td><div class="UINumber" id="pageMaintenance_12_cap" data-numfigures="4" data-da3="7396" data-max="1000"></div></td>
							<td align="right"><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageMaintenance_resetDec(12)"></div></td>
						</tr>
						<tr class="noBorder" id="pageMaintenance_decCofGround">
							<td>
								グラインダー カウンター<br>
								<div style="float:left; margin-right:10px">現在の値:</div>
								<div id="pageMaintenance_13" style="float:left" class="bigCaption15">0000</div>
								<div class="clear"></div>
							</td>
							<td><div class="UINumber" id="pageMaintenance_13_cap" data-numfigures="4" data-da3="7398" data-max="1000" data-onChange="pageMaintenance_onOptionBtnResetCG()" ></div></td>
							<td align="right"><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageMaintenance_resetDec(13)"></div></td>
						</tr>
						<tr class="noBorder" id="pageMaintenance_decCofGround_r2">
							<td><div style="margin-left:50px">BTN RESET COFFEE GROUND TIMEOUT</div></td>
							<td colspan="2"><div id="pageMaintenance_decCofGround_opt" class='UISelect' data-option='0|DEFAULT (10s)|1|INFINITE|2|CUSTOM' data-da3='' data-da3bit='8' data-onchange="pageMaintenance_onOptionBtnResetCG()"></div></td>
						</tr>
						<tr class="noBorder" id="pageMaintenance_decCofGround_r3">
							<td><div style="margin-left:50px">TIMEOUT</div></td>
							<td colspan="2"><div id="pageMaintenance_decCofGround_timeout" class="UINumber" data-numfigures="2" data-da3="" data-min="5" data-max="60" data-um="sec"></div></td>
						</tr>						
						
						<tr style="border-top: solid 1px #999999;">
							<td>
								メンテナンスリセット<br>
								<div style="float:left; margin-right:10px">現在の値:</div>
								<div id="pageMaintenance_15" style="float:left" class="bigCaption15">0000</div>
								<div class="clear"></div>
							</td>
							<td>
								<div style="float:left">
									<div class="UINumber" id="pageMaintenance_15_cap" data-numfigures="3" data-da3="7406" data-da3Scale="100" data-max="650" data-um=""></div>
								</div>
								<div style="float:left; font-size:2.9em; color:#fff; letter-spacing:7px">000</div>
								<div class="clear"></div>
							</td>
							<td align="right"><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageMaintenance_resetDec(15)"></div></td>
						</tr>						

						<tr>
							<td>
								メンテナンスリセット<br>閾値<br>
							</td>
							<td colspan="2">
								<div style="float:left">
									<div class="UINumber" data-numfigures="3" data-da3="7408" data-da3Scale="100" data-max="650"></div>
								</div>
								<div style="float:left; font-size:2.9em; color:#fff; letter-spacing:7px">000</div>
								<div class="clear"></div>
							</td>
						</tr>						
						
						<tr style="border:none">
							<td>表示温度<br><span class="tip">CPUメッセージ</span></td>
							<td colspan="2"><div class="UIOption" data-option="1|はい|0|いいえ" data-da3="7112"></div></td>
						</tr>
						<tr style="height:30px;">
							<td></td>
							<td colspan="2">
								<div id="pageMaintenance_temperature" class="tip"></div>
							</td>
						</tr>

						<tr>
							<!-- cliccando 5 volte su questa label si va al vecchio menu di prog -->
							<td id="pageMaintenance_td_labVoltage">電圧</td>
							<td colspan="2"><div id="pageMaintenance_volt" class="bigCaption15"></div></td>
						</tr>						
					</table>
				</div>
				
				<div id="pageMaintenance_inst" style="display:none">
					<table border='0' class='elenco'>
						<tr id="pageMaintenance_rowDis">
							<td>ボイラードレイン</td>
							<td colspan="2" align="center"><div class='UIButton bigButton60 actionButton' style='width:450px' data-caption='水抜き動作を開始する' data-onclick="pageMaintenance_disinstall()"></div></td>
						</tr>					
						<tr>
							<td>初期給水動作</td>
							<td colspan="2"><div class="UIOption" data-option="0|はい|1|いいえ" data-da3="7074"></div></td>
						</tr>
					</table>
				</div>
				
				<div id="pageMaintenance_off" style="display:none">
					<div id="pageMaintenance_off_content"></div>
				</div>
			</div>
		</div><!-- page Maintenance -->
		
		<!-- page Cleaning -->
		<div id="pageCleaning" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' cellspacing='0' cellpadding='0' width='99%' align='center'>
					<tr valign="middle">
                        <td width="33%" align="center"><div class="UIButton bigButton4x4 actionButton" data-caption="リンス開始" data-onclick="pageCleaning_action(160)"></div></td>
                        <td width="33%" align="center"><div id="pageCleaning_btnCleanHC" class="UIButton bigButton4x4 actionButton" data-caption="抽出ユニットの洗浄開始" data-onclick="pageCleaning_action(8)"></div></td>
                        <td width="33%" align="center"><div id="pageCleaning_btnCleanMilker" class="UIButton bigButton4x4 actionButton UIdisabled" data-caption="ミルクモジュールのクリーニングを開始" data-onclick="pageCleaning_action(5)"></div></td>					
					</tr>
				</table>
				
				<table border='0' cellspacing='0' cellpadding='0' width='99%' align='center'>
					<tr valign="middle">
						<td width="25%" align="center"><div id="pageCleaning_btnCleanGrinder" class="UIButton bigButton4x4 actionButton" data-caption="グラインダークリーニング開始" data-onclick="pageGrinderCleaning_show()"></div></td>
						<td width="25%" align="center"><div id="pageCleaning_btnCleaningSyrup" class="UIButton bigButton4x4 actionButton" data-caption="START CLEANING SYRUP MODULE" data-onclick="pageCleaning_action(165)"></div></td>
						<td width="25%" align="center"><div id="pageCleaning_btnDescaling" class="UIButton bigButton4x4 actionButton" data-caption="スケール除去開始" data-onclick="pageCleaning_action(161)"></div></td>
						<td width="25%" align="center"><div id="pageCleaning_btnDescalingMilker" class="UIButton bigButton4x4 actionButton UIdisabled" data-caption="スケール除去開始" data-onclick="pageCleaning_action(164)"></div></td>
						<td></td>
					</tr>
				</table>
				
				<div id="externModuleSi">
					<table border='0' cellspacing='0' cellpadding='0' width='99%' align='center'>
						<tr valign="middle">
							<td width="25%" align="center"><div id="pageCleaning_btnClean1" class="UIButton bigButton4x4 actionButton" data-caption="リンス<br>(BREWER)" data-onclick="pageCleaning_action(1)"></div></td>
							<td width="25%" align="center"><div id="pageCleaning_btnClean2" class="UIButton bigButton4x4 actionButton" data-caption="リンス<br>(MIXER 1)" data-onclick="pageCleaning_action(2)"></div></td>
							<td width="25%" align="center"><div id="pageCleaning_btnClean3" class="UIButton bigButton4x4 actionButton" data-caption="リンス<br>(MIXER 2)" data-onclick="pageCleaning_action(3)"></div></td>
							<td width="25%" align="center"><div id="pageCleaning_btnClean4" class="UIButton bigButton4x4 actionButton" data-caption="リンス<br>(MIXER 3)" data-onclick="pageCleaning_action(4)"></div></td>
						</tr>
					</table>
				</div>
				
				<div id="externModuleNo">
					<table border='0' cellspacing='0' cellpadding='0' width='99%' align='center'>
						<tr valign="middle">
							<td width="16%" align="center"><div id="pageCleaning_btnClean1_ext" class="UIButton bigButton50 actionButton" data-caption="リンス<br>(BREWER)"  data-onclick="pageCleaning_action(1)"></div></td>
							<td width="16%" align="center"><div id="pageCleaning_btnClean2_ext" class="UIButton bigButton50 actionButton" data-caption="リンス<br>(MIXER 1)" data-onclick="pageCleaning_action(2)"></div></td>
							<td width="16%" align="center"><div id="pageCleaning_btnClean3_ext" class="UIButton bigButton50 actionButton" data-caption="リンス<br>(MIXER 2)" data-onclick="pageCleaning_action(3)"></div></td>
							<td width="16%" align="center"><div id="pageCleaning_btnClean4_ext" class="UIButton bigButton50 actionButton" data-caption="リンス<br>(MIXER 3)" data-onclick="pageCleaning_action(4)"></div></td>
							<td width="16%" align="center"><div id="pageCleaning_btnClean5_ext" class="UIButton bigButton50 actionButton" data-caption="リンス<br>(MIXER 5)" data-onclick="pageCleaning_action(21)"></div></td>
							<td width="16%" align="center"><div id="pageCleaning_btnClean6_ext" class="UIButton bigButton50 actionButton" data-caption="リンス<br>(MIXER 6)" data-onclick="pageCleaning_action(22)"></div></td>
						</tr>
					</table>
				</div>
				
				<div id="pageCleaning_milkerInfo" class="tip" style="text-align:center; padding:4px 0 4px 0">ミルククリーニング　：前回{0}　次回{1}</div>

				
				<table border='0' class='elenco'>
					<tr style="border:0">
						<td>自動リンス時間<br><span class="tip">00:00は無効</span></td>
						<td style="width:330px"><div class="UITime24" data-da3="7466"></div></td>
					</tr>	
					<tr id='pageCleaning_tabDissolveTable'>
						<td>タブレット熔解設定<br>
							<span class="tip">オートリンス（HC）中に「タブレット溶解」する時間を設定します。<br>デフォルト時間：000</span>
						</td>
						<td><div class="UINumber" data-numfigures="3" data-max="999" data-da3="7562" data-da3bit="16" data-um="sec"></div></td>
					</tr>	
				</table>
			</div>
		</div> <!-- page Cleaning -->
	
		<!-- page pageMiscellaneous -->
		<div id="pageMiscellaneous" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' width='100%'>
					<tr valign='middle'>
						<td><div class='UIOptionSmall' style='font-size:0.9em' id='pageMiscellaneous_selector' data-option='' data-onclick='pageMiscellaneous_onSelector()'></div></td>
					</tr>
				</table>
				<br>
				
				<div id="pageMiscellaneous_gs" style="display:none">
					<table border='0' class='elenco'>
						<tr>
							<td style="width:380px">メッセージナンバー</td>
							<td><div class="UINumber" data-numfigures="1" data-max="7" data-da3="7056" data-da3bit="8"></div></td>
						</tr>					
						<tr>
							<td>ファン時間</td>
							<td><div class="UINumber" data-numfigures="2" data-min="3" data-max="60" data-da3="7062" data-da3bit="8" data-um="min"></div></td>
						</tr>
						<tr>
							<td>ビープ時間</td>
							<td><div class="UINumber" data-numfigures="2" data-decimal='1' data-max="13" data-da3="7064" data-da3bit="8" data-um="sec"></div></td>
						</tr>
						<tr>
							<td><div onMouseUp="pageMiscellaneous_onLabCPULangClicked()">CPU言語</div></td>
							<td>
								<div id='pageMiscellaneous_cpuLang' class='UISelect' data-option='0|lang 1|1|lang 2' data-da3='7068' data-da3bit='8' data-onchange="pageMiscellaneous_cpuLang_onChange()"></div>
								<div id='pageMiscellaneous_cpuLangML' class='UISelect' data-option='0|BG - БЪЛГАРСКИ|1|CN - 中文|2|CZ - ČEŠTINA|3|DE - DEUTSCH|4|ES - ESPAÑOL|5|ET - EESTI KEEL|6|FI - SUOMALAINEN|7|FR - FRANÇAIS|8|GB - ENGLISH|9|HE - יהודי|10|HR - HRVATSKIs|11|HU - MAGYAR|12|IT - ITALIANO|13|JP - 日本|14|LA|15|LI|16|NL - NEDERLANDS|17|NO|18|PL - POLSKIE|19|PT - PORTUGUÉS|20|RO - ROMÂNĂ|21|RU - РУССКИЙ|22|SK - SLOVENSKÝ|23|SI|24|SE|25|SV - SVENSKA|26|TR - TÜRKÇE|27|UA - УКРАЇНСЬКИЙ' data-da3='7078' data-da3bit='8'></div>
							</td>
						</tr>

						<tr>
							<td>ENABLE BEVERAGE STOP</td>
							<td><div class='UIOption' data-option='1|はい|0|いいえ' data-da3='7070' data-da3bit='8'></div></td>
						</tr>

						
						<tr id="pageMiscellaneous_r1">
							<td>サイドウォーターポンプ</td>
							<td><div class="UINumber" data-numfigures="1" data-max="4" data-da3="8370" data-da3bit="8"></div></td>
						</tr>
						<tr id="pageMiscellaneous_r2">
							<td>砂糖キャニスター</td>
							<td><div class="UINumber" data-numfigures="1" data-max="6" data-da3="7086" data-da3bit="8"></div></td>
						</tr>			
						<tr id="pageMiscellaneous_fmilkTopping" class="toBeHidden"><td colspan="2"></td></tr>
						<tr id="pageMiscellaneous_fmilkTopping"><td>フォームミルクトッピングスイッチ</td><td><div class='UIOption' data-option='1|はい|0|いいえ' data-da3='7096' data-da3bit='8'></div></td></tr>
						<tr id="pageMiscellaneous_r4">
							<td>前にデータ監査を有効にします</td>
							<td><div id="pageMiscellaneous_gs_auditBefore" class='UIOption' data-option='1|はい|0|いいえ' data-da3='7106' data-da3bit='8'></div></td>
						</tr>
						<tr>
							<td>
								PROGメニューPINコード<br>
								<div style="float:left">current&nbsp;</div>
								<div id="pageMiscellaneous_curPIN" class="bigCaption25" style="float:left">000</div>
								<div class="clear"></div>
							</td>
							<td>
								<div style="float:left;">
									<div class='UIButton bigButton60 actionButton' data-caption='ピンコード　セット' data-onclick="pageMiscellaneous_askForNewPINCode()"></div>
								</div>
								<div style="float:right;">
									<div class='UIButton bigButton60 actionButton' data-caption='ピンコード　リセット' data-onclick="pageMiscellaneous_setPINCode('000')"></div>
								</div>
								<div class="clear"></div>
							</td>
						</td>
						<tr>
							<td>
								クイックメニューPINコード<br>
								<div style="float:left">current&nbsp;</div>
								<div id="pageMiscellaneous_curQuickPIN" class="bigCaption25" style="float:left">000</div>
								<div class="clear"></div>
							</td>
							<td>
								<div style="float:left;">
									<div class='UIButton bigButton60 actionButton' data-caption='ピンコード　セット' data-onclick="pageMiscellaneous_askForNewQuickPINCode()"></div>
								</div>
								<div style="float:right;">
									<div class='UIButton bigButton60 actionButton' data-caption='ピンコード　リセット' data-onclick="pageMiscellaneous_setQuickPINCode('000')"></div>
								</div>
								<div class="clear"></div>
							</td>						
							<td></td>
						</td>
 					</table>
				</div>
				
				<div id="pageMiscellaneous_mid" style="display:none">
					<table border='0' class='elenco'>
						<tr>
							<td style="width:380px">マシンコード A</td>
							<td><div class="UINumber" data-numfigures="5" data-max="65535" data-da3="7052" data-da3bit="16"></div></td>
						</tr>
						<tr>
							<td>マシンコード B</td>
							<td><div class="UINumber" data-numfigures="5" data-max="65535" data-da3="7054" data-da3bit="16"></div></td>
						</tr>
					</table>
				</div>
					
				<div id="pageMiscellaneous_lm" style="display:none">
					<table border='0' class='elenco'>
						<tr>
							<td style="width:380px">製品ミルクLM</td>
							<td><div class="UINumber" data-numfigures="1" data-max="6" data-da3="7082" data-da3bit="8"></div></td>
						</tr>
						<tr>
							<td>ミルクLMの水番号</td>
							<td><div class="UINumber" data-numfigures="1" data-max="3" data-da3="7084" data-da3bit="8"></div></td>
						</tr>
					</table>
				</div>
				
				<div id="pageMiscellaneous_fv" style="display:none">
					<table border='0' class='elenco'>
						<tr id="pageMiscellaneous_fv_r0">
							<td style="width:380px">FVハードウェアキー<br>モード</td>
							<td colspan="2"><div id="pageMiscellaneous_fvHwKey" class='UIOption' data-option='0|無効|1|有効 1|2|有効 ++' data-da3="7104" data-da3bit="8"></div></td>
						</tr>
						<tr id="pageMiscellaneous_fv_r1">
							<td>FREEVENDを起動します<br><span class="tip">指定された<br> numを持続します。時間の数</span></td>
							<td align="center"><div id="pageMiscellaneous_fvH" class="UINumber" data-numfigures="3" data-max="255" data-um="時間"></div></td>
							<td align="right"><div class='UIButton actionButton' data-caption='スタート' data-onclick="pageMiscellaneous_startFVNow()"></div></td>
						</tr>
						
						<tr id="pageMiscellaneous_fv_r2">
							<td>Freevendは<b style = 'color：#fff'>実行</ b></td>
							<td align="center"><div id="pageMiscellaneous_fvDateEnd"></div></td>
							<td align="right"><div class='UIButton actionButton' data-caption='STOP IT NOW' data-onclick="pageMiscellaneous_stopFVNow()"></div></td>
						</tr>
						
					</table>
				</div>

				<div id="pageMiscellaneous_blockingCt" style="display:none">
					<div id="pageMiscellaneous_blockingCt_pwd">
						<table border='0' class='elenco'>
							<tr>
								<td>ピンコードを挿入します</td>
								<td><div class="UINumber" id='pageMiscellaneous_pincode' data-numfigures="3" data-max="999"></div></td>
								<td><div class='UIButton actionButton' data-caption='&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;O&nbspK&nbsp;&nbsp;&nbsp;&nbsp&nbsp&nbsp' data-onclick="pageMiscellaneous_onPINCodeInserted()"></div></td>
							</tr>
						</table>
					</div>
					<div id="pageMiscellaneous_blockingCt_unblocked" style="display:none">
						<table border='0' class='elenco' style="table-layout: fixed">
							<tr>
								<td style="width:414px">カウンター<br>
									<div style="float:left; margin-right:10px">現在の値:</div>
									<div id="pageMiscellaneous_blockingCt_unblocked_curct" style="float:left" class="bigCaption15">00000</div>
									<div class="clear"></div>
								</td>
								<td style="width:335px"><div class="UINumber" id="pageMiscellaneous_blockingCt_newValue" data-numfigures="5" data-max="10000" data-da3="7400" data-da3bit="16"></div></td>
								<td style="width:255px" align="right"><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageMiscellaneous_blockingCounter_set()"></div></td>
							</tr>

							<tr>
								<td>後に警告する<br><span class="tip">（前の行に挿入された数に対して）指定された選択に達すると、マシンは警告を表示して、ブロックされます。</span></td>
								<td colspan="2"><div class="UINumber" data-numfigures="2" data-max="50" data-da3="7402" data-da3bit="16" data-um="%"></div></td>
							</tr>

							<tr>
								<td>ピンコード<br><span class="tip">PINコードの変更が可能です</span></td>
								<td colspan="2"><div class="UINumber" id='pageMiscellaneous_newpincode' data-numfigures="3" data-min="111" data-max="999" data-da3="7404" data-da3bit="16"></div></td>
							</tr>
						</table>
					</div>
				</div>
				
				<div id="pageMiscellaneous_advGrinder" style="display:none">
					<table border='0' class='elenco'>
						<tr class="smallHeightNoBorder">
							<th style="text-align:center">グラインダー</th>
							<th style="text-align:center">VIBRATION TIME</th>
							<th style="text-align:center">VIBRATION SPEED</th>
						</tr>
						<tr>
							<td style="text-align:center">1</td>
							<td style="text-align:center"><div class="UINumber" data-numfigures="3" data-max="255" data-da3bit="8" data-da3="8380" data-decimal="1" data-um="sec"></div></td>
							<td style="text-align:center"><div class="UINumber" data-numfigures="3" data-max="100" data-da3bit="8" data-da3="8382" data-um="%"></div></td>
						</tr>
						<tr>
							<td style="text-align:center">2</td>
							<td style="text-align:center"><div class="UINumber" data-numfigures="3" data-max="255" data-da3bit="8" data-da3="8384" data-decimal="1" data-um="sec"></div></td>
							<td style="text-align:center"><div class="UINumber" data-numfigures="3" data-max="100" data-da3bit="8" data-da3="8386" data-um="%"></div></td>
						</tr>
						<tr>
							<td style="text-align:center">3</td>
							<td style="text-align:center"><div class="UINumber" data-numfigures="3" data-max="255" data-da3bit="8" data-da3="8388" data-decimal="1" data-um="sec"></div></td>
							<td style="text-align:center"><div class="UINumber" data-numfigures="3" data-max="100" data-da3bit="8" data-da3="8390" data-um="%"></div></td>
						</tr>
						<tr>
							<td style="text-align:center">4</td>
							<td style="text-align:center"><div class="UINumber" data-numfigures="3" data-max="255" data-da3bit="8" data-da3="8392" data-decimal="1" data-um="sec"></div></td>
							<td style="text-align:center"><div class="UINumber" data-numfigures="3" data-max="100" data-da3bit="8" data-da3="8394" data-um="%"></div></td>
						</tr>						
					</table>						
				</div>
			</div>
		</div>	<!-- page pageMiscellaneous -->
		
		<!-- page pageClock -->
		<div id="pageClock" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' width='100%'>
					<tr valign='middle'>
						<td><div class='UIOptionSmall' id='pageClock_selector' data-option='0|時計|1|HAPPY HOUR|2|ENERGY SAVING' data-onclick='pageClock_onSelector()'></div></td>
					</tr>
				</table>
				<br>

				<div id="pageClock_clock" style="display:none">
					<table border='0' class='elenco'>
						<tr>
							<td>時間</td>
							<td colspan="3"><div class="UITime24" id="pageClock_time" data-onChange="pageClock_onClockChanged()"></div></td>
							<td style="width:60px"><div id="pageClock_tab1_setClock" class='UIButton actionButton' data-caption='SET' data-onclick="pageClock_setTime()"></div></td>
						</tr>
						
						<tr>
							<td>日にち</td>
							<td><div id="pageClock_dd" class="UINumber" data-onChange="pageClock_onDateChanged()" data-numfigures="2" data-max="31" data-min="1" data-um='日'></div></td>
							<td><div id="pageClock_mm" class="UINumber" data-onChange="pageClock_onDateChanged()" data-numfigures="2" data-max="12" data-min="1" data-um='月'></div></td>
							<td><div id="pageClock_yy" class="UINumber" data-onChange="pageClock_onDateChanged()" data-numfigures="4" data-max="2050" data-min="2017" data-um='年'></div></td>
							<td style="width:60px;"><div id="pageClock_tab1_setDate" class='UIButton actionButton' data-caption='SET' data-onclick="pageClock_setDate()"></div></td>
						</tr>
						
						
						<tr style="border:0">
							<td>サマータイム</td>
							<td colspan="2"><div class="UIOption" data-option="1|はい|0|いいえ" data-da3="7080"></div></td>
							<td colspan="2"></td>
						</tr>
					</table>
				</div>

				<div id="pageClock_happyHour" style="display:none">
					<table border='0' class='elenco'>
						<tr style="height:50px; vertical-align:bottom">
							<th style="width:232px; text-align:left">HAPPY HOUR</th>
							<th>START</th>
							<th>END</th>
						</tr>
						<tr>
							<td>HAPPY HOUR 1</td>
							<td align="center"><div class="UITime24" data-da3="7424"></div></td>
							<td align="center"><div class="UITime24" data-da3="7426"></div></td>
						</tr>
						<tr>
							<td>HAPPY HOUR 2</td>
							<td align="center"><div class="UITime24" data-da3="7428"></div></td>
							<td align="center"><div class="UITime24" data-da3="7430"></div></td>
						</tr>
						<tr style="border:0">
							<td>HAPPY HOUR 3</td>
							<td align="center"><div class="UITime24" data-da3="7432"></div></td>
							<td align="center"><div class="UITime24" data-da3="7434"></div></td>
						</tr>
					</table>
				</div>
				
				<div id="pageClock_energySave">
					<div id="pageClock_dyn_en_save_Stm32">
						<table border='0' class='elenco'>
							<tr class="noBorder">
								<td colspan="2">DYNAMIC ENERGY SAVE</td>
								<td style="width:350px"><div id="pageClock_energySave_dynEnSav" class="UIOption" data-option="1|有効|0|無効" data-onclick="pageClock_onDynEnSaveChanged()"></div></td>
							</tr>
							<tr id="pageClock_energySave_dynEnSav_tr2"class="noBorder">
								<td style="width:30px">&nbsp;</td>
								<td>TIMEOUT<br><span class="tip">Machine will enter in DYNAMIC ENERGY SAVE after being in STANDBY mode for at least TIMEOUT minutes</span></td>
								<td><div id="pageClock_energySave_dynEnSav_time" class="UINumber" data-da3="8422" data-numfigures="2" data-max="99" data-min="0" data-um='min'></div></td>
							</tr>
							<tr style='height:auto'><td colspan='3'></td></tr>
						</table>
						<br>
					</div>
				
					<table border='0' class='elenco'>
						<tr style="height:50px; vertical-align:bottom">
							<th style="width:232px; text-align:left">ENERGY SAVING</th>
							<th>電源オン</th>
							<th>電源オフ</th>
						</tr>				
						<tr><td>月曜日</td><td align="center"><div class="UITime24" data-da3="7436"></div></td><td align="center"><div class="UITime24" data-da3="7438"></div></td></tr>					
						<tr><td>火曜日</td><td align="center"><div class="UITime24" 	data-da3="7440"></div></td><td align="center"><div class="UITime24" data-da3="7442"></div></td></tr>					
						<tr><td>水曜日</td><td align="center"><div class="UITime24" 	data-da3="7444"></div></td><td align="center"><div class="UITime24" data-da3="7446"></div></td></tr>					
						<tr><td>木曜日</td><td align="center"><div class="UITime24" 	data-da3="7448"></div></td><td align="center"><div class="UITime24" data-da3="7450"></div></td></tr>					
						<tr><td>金曜日</td><td align="center"><div class="UITime24" 	data-da3="7452"></div></td><td align="center"><div class="UITime24" data-da3="7454"></div></td></tr>					
						<tr><td>土曜日</td><td align="center"><div class="UITime24" 	data-da3="7456"></div></td><td align="center"><div class="UITime24" data-da3="7458"></div></td></tr>					
						<tr><td>日曜日</td><td align="center"><div class="UITime24" 	data-da3="7460"></div></td><td align="center"><div class="UITime24" data-da3="7462"></div></td></tr>					
					</table>
				</div>
			</div>
		</div>	<!-- page pageClock -->
		
		<!-- page productQty -->
		<div id="pageProductQty" class="UIWindow">
			<div class="UIWindowContent" id="pageProductQty_content">
				<!-- il contenuto di questa pagina lo credo dinamicamente perchè dipende da INSTANT o ESPRESSO (vedi pageProductQty_build) -->
			</div>
		</div><!-- page productQty -->
		
		
		<!-- page Milker -->
		<div id="pageMilker" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' class='elenco'>
					<tr style='height:30px; border-bottom:none'>
						<td style="width:424px">バージョン</td>
						<td style="width:150px">ステータス</td>
					</tr>
					<tr style='height:50px;'>
						<td><div id="pageMilker_ver" class="bigCaption15"></div></td>
						<td><div id="pageMilker_status" class="bigCaption15">接続されいるか無効になっています</div></td>
					</tr>
				</table>

				<table border='0' class='elenco'>
					<tr>
						<td>有効</td>
						<td><div id='pageMilker_enabled' class='UIOption' data-option='1|はい|0|いいえ' data-onclick="pageMilker_onEnabledYesNo()"></div></td>
					</tr>
					<tr>
						<td>モデル</td>
						<td><div id='pageMilker_model' class='UISelect' data-option='' data-da3="69" data-onchange="pageMilker_onMilkerTypeChange_fromUser()"></div></td>
					</tr>
				</table>
				
				<div id="pageMilker_params" style="display:none">
					<!-- parametri comuni a tutti i milker -->
					<table border='0' class='elenco'>
						<tr>
							<td style="width:400px">スチーム温度<br><span class="tip">max 128</span></td>
							<td><div class="UINumber" id="pageMilker_temperature" data-numfigures="3" data-max="128" data-da3="7618" data-da3bit="8"></div></td>
						</tr>
						
						<tr>
							<td>スタートアップで<br> <br>ボタンを表示します</td>
							<td><div class="UIOption" data-option="1|はい|0|いいえ" data-da3="7628"></div></td>
						</tr>
					</table>
				
					<!-- parametri relativi al capp venturi -->
					<div id="pageMilker_capp_venturi" style="margin-top:20px; display:none">
						<table border='0' class='elenco'>
							<tr>
								<td>清掃の有効</td>
								<td><div id="pageMilker_capp_venturi_2" class="UIOption" data-option="1|はい|0|いいえ" data-da3="7622"></div></td>
							</tr>

							<tr>
								<td style="width:400px">クリーニング期間<br><span class="tip">max 900</span></td>
								<td><div id="pageMilker_capp_venturi_1" class="UINumber" data-numfigures="3" data-da3="7620" data-da3bit="16" data-max="900" data-um="min."></div></td>
							</tr>
							<tr>
								<td>クリーニングディレイ<br><span class="tip">max 10.0</span></td>
								<td><div id="pageMilker_capp_venturi_3" class="UINumber" data-numfigures="3" data-decimal='1' data-da3="7624"  data-da3bit="16" data-max="100" data-um="sec."></div></td>
							</tr>

							<tr id="pageMilkerV_cleaning_period">
								<td>ミルククリーニング　義務化 する</td>
								<td><div class="UIOption" data-option="0|24時間ごと|1|30時間ごと" data-da3="7632"></div></td>
							</tr>						

							<tr>
								<td>ミルクセンサー</td>
								<td><div id="pageMilker_capp_venturi_4" class="UISelect" data-option="0|いいえ|1|1: 静電容量式及び光学式センサーのみ|2|2: 光センサーのみ|3|3: 静電容量式センサーのみ" data-da3="7626"></div></td>
							</tr>
						</table>
					</div>
					
					<!-- parametri relativi al capp induzione -->
					<div id="pageMilker_capp_induzione" style="margin-top:20px; display:none">
						<table border='0' class='elenco'>
							<!--
							<tr>
								<td style="width:410px">オートリンス時間設定<br></td>
                                <td><div id="pageMilker_capp_indux_1" class="UINumber" data-numfigures="2" data-da3="7620" data-da3bit="16" data-max="30" data-um="min."></div></td>
							</tr-->

							<tr style="border-bottom: none">
								<td style="width:410px">オートリンスモード</td>
								<td><div id="pageMilker_capp_indux_1" class="UISelect" data-option="0|DEFAULT|1|HDE" data-da3="8368" data-da3bit='8' data-onchange="pageMilker_onAutorinsingMode_changed()"></div></td>
							</tr>						
							<tr id="pageMilker_autorinsing_period" style="border-bottom: none">
								<td>オートリンス完了</td>
								<td><div id="pageMilker_capp_indux_2" class="UINumber" data-numfigures="2" data-da3="7620" data-da3bit="16" data-max="15" data-min="3" data-um="min."></div></td>
							</tr>
							
							<tr style="height:2px"><td colspan="2"></td></tr>


							<tr id="pageMilker_Show_cleaning_period">
								<td>ミルククリーニング　義務化 する</td>
								<td><div id="pageMilker_capp_indux_3" class="UIOption" data-option="0|24時間ごと|1|48 - 72 時間ごと" data-da3="7622"></div></td>
							</tr>
							<tr>
								<td>ミルクセンサー</td>
								<td><div id="pageMilker_capp_indux_4" class="UISelect" data-option="0|いいえ|1|1: 伝導率センサーのみ|2|2: ミルクタンクセンサーのみ" data-da3="7626" data-da3bit='8'></div></td>
							</tr>
							
							<!-- nascosta opzione vedi #3361-->
							<tr style="display:none">
								<td>伝導センサーが有効</td>
								<td><div id="pageMilker_capp_indux_5" class="UIOption" data-option="1|はい|0|いいえ" data-da3="7624"></div></td>
							</tr>

							<tr>
								<td colspan="2"><div class='UIButton actionButton' style="margin:0 auto" data-caption='TEST SANITIZATION CYCLE' data-onclick="pageCleaning_action(163)"></div></td>	
							</tr>							
				
							<tr>
								<td>カス箱センサー有効</td>
								<td><div id="pageMilker_capp_indux_6" class="UIOption" id="pageMilker_capp_induzione_enableWasteTankSensor" data-option="1|はい|0|いいえ" data-da3="7632"></div></td>
							</tr>
							
							<tr>
								<td>廃水タンクセンサーを動作させます</td>
								<td><div id="pageMilker_capp_indux_7" class="UISelect" data-option="0|ノーマル|1|サニタイズクリーニング中は無視する|2|HDEとサニタイズクリーニング中は無視する" data-da3="7630"></div></td>
							</tr>
												
							
							
							<tr>
								<td>0</td>
								<td><div id="pageMilker_capp_indux_8" class="UIOption" data-option="1|はい|0|いいえ" data-da3="8360"></div></td>
							</tr>
							<tr>
								<td>タブレット溶解時間</td>
								<td><div id="pageMilker_capp_indux_9" class="UINumber" data-numfigures="3" data-da3="8358" data-da3bit="16" data-min="45" data-max="240" data-um="sec."></div></td>
							</tr>
						</table>
						
						<table border='0' class='elenco'>
							<tr id="pageMilker_tuningSpeedMilkPump">
								<td style="width:200px">ミルクポンプスピード　チューニング<br></td>
								<td style="width:50px"><div id="pageMilker_tuningSpeedMilkPump1" class="bigCaption12"  data_caption='&nbsp;&nbsp'></div></td>
								<td>&nbsp % チューニング &nbsp;&nbsp<span class="tip"><br>&nbsp-30% / 30%</sp></td>
								<td><div class="bigCaption25" id="pageMilker_tSpeedT"></div>	
								<td><div id="pageMilker_tSpeedV" class="UINumber" data-numfigures="2" data-max="30" data-da3bit="8" data-um="%"></div></td>					
								<td><div class='UIButton actionButton' data-caption='&nbsp+&nbsp' data-onclick="pageMilker_tuningPumpP()"></div></td>	
								<td><div class='UIButton actionButton' data-caption='&nbsp&nbsp-&nbsp&nbsp' data-onclick="pageMilker_tuningPumpM()"></div></td>            
                                <td><div class='UIButton actionButton' data-caption='リセット' data-onclick="pageMilker_tuningPumpReset()"></div></td>
                                <td><div class='UIButton actionButton' data-caption='校正' data-onclick="pageMilker_tuningPumpStart()"></div></td>         
                            								
							</tr>
						</table>
						
						
						<table border='0' class='elenco'>	
							<tbody>
							<tr style="background-color:#fff">
								<th style="color:#000" align="left">フォーム</th>
								<th style="color:#000" align="left">エア</th>
								<th style="color:#000" align="left">ポンプスピード</th>
							</tr>
							

					        <tr>
								<td style="color:#f99">ホットミルク　フォーム無し</td>
								<td><div class="UINumber" data-numfigures="3" data-min="000" data-max="000" data-um="%"></div></td>
								<td><div class="UINumber" data-numfigures="3" data-da3="8362" data-da3bit="16" data-min="40" data-max="70" data-um="%"></div></td>
							</tr>							
					
							<tr>
								<td style="color:#f99">ホットミルク　クラシックフォーム</td>
								<td><div class="UINumber" data-numfigures="3" data-da3="7634" data-da3bit="16" data-min="20" data-max="80" data-um="%"></div></td>
								<td><div class="UINumber" data-numfigures="3" data-da3="7636" data-da3bit="16" data-min="30" data-max="100" data-um="%"></div></td>
							</tr>
							<tr>
								<td style="color:#f99">ホットミルク　ふわふわフォーム</td>
								<td><div class="UINumber" data-numfigures="3" data-da3="7640" data-da3bit="16" data-min="20" data-max="100" data-um="%"></div></td>
								<td><div class="UINumber" data-numfigures="3" data-da3="7642" data-da3bit="16" data-min="30" data-max="100" data-um="%"></div></td>
							</tr>
							<tr id="pageMilker_row_tplBarista">
								<td style="color:#f99">ホットミルク　バリスタフォーム</td>
								<td><div id="pageMilker_row_tplBarista_air" class="UINumber" data-numfigures="3" data-da3="7646" data-da3bit="16" data-min="0" data-max="100" data-um="%"></div></td>
								<td><div id="pageMilker_row_tplBarista_pump" class="UINumber" data-numfigures="3" data-da3="7648" data-da3bit="16" data-min="0" data-max="100" data-um="%"></div></td>
							</tr>
							<tr id="pageMilker_row_tplBarista_readonly">
								<td style="color:#f99">ホットミルク　バリスタフォーム</td>
								<td><div id="pageMilker_row_tplBarista_readonly_values"></div></td>
								<td><div class='UIButton bigButton60 actionButton' data-caption='PINを入力してください' data-onclick="pageMilker_onEditBtn()"></div></td>
							</tr>
					
				
							<tr>
								<td style="color:#00f">コールドミルク　フォーム無し</td>
								<td><div class="UINumber" data-numfigures="3" data-min="000" data-max="000" data-um="%"></div></td>
								<td><div class="UINumber" data-numfigures="3" data-da3="8364" data-da3bit="16" data-min="30" data-max="55" data-um="%"></div></td>
							</tr>	

							<tr>
								<td style="color:#00f">コールドミルク　クラシックフォーム</td>
								<td><div class="UINumber" data-numfigures="3" data-da3="8340" data-da3bit="16" data-min="20" data-max="60" data-um="%"></div></td>
								<td><div class="UINumber" data-numfigures="3" data-da3="8342" data-da3bit="16" data-min="45" data-max="100" data-um="%"></div></td>
							</tr>
							<tr>
								<td style="color:#00f">コールドミルク　ふわふわフォーム</td>
								<td><div class="UINumber" data-numfigures="3" data-da3="8346" data-da3bit="16" data-min="60" data-max="100" data-um="%"></div></td>
								<td><div class="UINumber" data-numfigures="3" data-da3="8348" data-da3bit="16" data-min="45" data-max="100" data-um="%"></div></td>
							</tr>
							<tr id="pageMilker_row_tplBaristaCold">
								<td style="color:#00f">コールドミルク　バリスタフォーム</td>
								<td><div id="pageMilker_row_tplBaristaCold_air" class="UINumber" data-numfigures="3" data-da3="8352" data-da3bit="16" data-min="0" data-max="100" data-um="%"></div></td>
								<td><div id="pageMilker_row_tplBaristaCold_pump" class="UINumber" data-numfigures="3" data-da3="8354" data-da3bit="16" data-min="30" data-max="100" data-um="%"></div></td>
							</tr>
							<tr id="pageMilker_row_tplBaristaCold_readonly">
								<td style="color:#00f">コールドミルク　バリスタフォーム</td>
								<td><div id="pageMilker_row_tplBaristaCold_readonly_values"></div></td>
								<td><div class='UIButton bigButton60 actionButton' data-caption='PINを入力してください' data-onclick="pageMilker_onEditBtn()"></div></td>
							</tr>							
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div><!-- page Milker -->
		
		
		<!-- pageSelections -->
		<div id="pageSelections" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' width='100%'>
					<tr valign='middle'>
						<td style="width:140px"><b>メニューボタン設定:</b></td>
						<td><div class='UIOptionSmall' id='pageSelections_selector' data-option='1|1-12|2|13-24|3|25-36|4|37-48' data-onclick='pageSelections_onSelector()'></div></td>
					</tr>
				</table>		
			
				<div id="pageSelections_c2">
					<!-- il contenuto di questa pagina lo credo dinamicamente (vedi pageSelections_build) -->
				</div>
			</div>
		</div><!-- pageSelections -->
		
		<!-- pageSingleSelection -->
		<div id="pageSingleSelection" class="UIWindow">
			<div class="UIWindowContent">
				<div id="pageSingleSelection_selectorAtTop"></div>
				<br>
				<div id="pageSingleSelection_pageG">
					<table border='0' class='elenco'>
						<tr>
							<td>ステータス</td>
							<td><div id='pageSingleSelection_status' class="UISelect" data-option="" data-da3="100" data-onchange='pageSingleSelection_onStatus()'></div></td>
						</tr>
					</table>
					<div id="pageSingleSelection_pageSel">
						<table border='0' class='elenco'>
							<tr id="pageSingleSelection_pageSel_prc1">
								<td>価格 1</td>
								<td><div id='pageSingleSelection_prc1' class="UINumber" data-numfigures="5" data-decimal='0' data-max="65000"></div></td>
							</tr>
							<tr id="pageSingleSelection_pageSel_prc2">
								<td>価格 2<br><span class="tip">ハッピープライス</span></td>
								<td><div id='pageSingleSelection_prc2' class="UINumber" data-numfigures="5" data-decimal='0' data-max="65000"></div></td>
							</tr>
							<tr>
								<td>プログラミング</td>
								<td><div class="UIOption" id='pageSingleSelection_programming' data-option="1|パーシャル|0|トータル" data-da3="101" data-onclick="pageSingleSelection_onProgramming()"></div></td>
							</tr>							
							<tr id="pageSingleSelection_pageSel_rowJug">
								<td>JUG<br><span class="tip">繰り返し回数</span></td>
								<td><div class="UINumber" id="pageSingleSelection_jug" data-numfigures="2" data-max="10" data-da3="177" data-da3bit='8'></div></td>
							</tr>
							<tr id="pageSingleSelection_pageSel_rowSelRepeat">
								<td>繰り返し回数<br><span class="tip">繰り返し回数</span></td>
								<td><div class="UINumber" id="pageSingleSelection_selRepeat" data-numfigures="2" data-max="10" data-da3="192" data-da3bit='8' data-forbidden='1'></div></td>
							</tr>							
							<tr id="pageSingleSelection_pageSel_scalingF">
								<td>スケーリング工数<br></td>
								<td><div class='UINumber' id='pageSingleSelection_sfactor' data-numfigures='3' data-da3='180' data-da3bit='8' data-min='80' data-max='120' data-um='%'></div></td>
							</tr>
							<tr id="pageSingleSelection_pageSel_rowCupSizeBrewmatic">
								<td>カップサイズ<br></td>
								<td><div class='UISelect' id="pageSingleSelection_selCupSize" data-da3='184' data-option='0|(173+) mm|1|(145-173) mm|2|(116-145) mm|3|(101-116) mm|4|(90-101) mm|5|(65-90) mm'></div></td>
							</tr>							
							<tr>
								<td>ボタンのレシピリセット</td>
								<td><div class='UIButton bigButton60 actionButton' data-caption='確認' data-onclick="pageSingleSelection_resetConfirm()"></td>
							</tr>
						</table>
					</div>
				</div> <!--pageSingleSelection_pagegs-->
				
				<div id="pageSingleSelection_pageE"></div>
				<div id="pageSingleSelection_pageMilker"></div>
				<div id="pageSingleSelection_pageP"></div>
				<div id="pageSingleSelection_pageW"></div>
				<div id="pageSingleSelection_pageM"></div>
				<div id="pageSingleSelection_pageExtMod">
					<div class='UIOptionSmall' id='pageSingleSelection_selectorExt' data-option='0|プロダクツ|1|ウオーター|2|MIXERS|3|SYRUPS' data-onclick='pageSingleSelection_onExtSelector()'></div>
					<div id="pageSingleSelection_pageExtMod_pag0"></div>
					<div id="pageSingleSelection_pageExtMod_pag1"></div>
					<div id="pageSingleSelection_pageExtMod_pag2"></div>
					<div id="pageSingleSelection_pageExtMod_pag3"></div>
				</div>
				
			</div>
		</div><!-- pageSingleSelection -->
		
		<!-- pageTemperature -->
		<div id="pageTemperature" class="UIWindow">
			<div class="UIWindowContent">
				<div id="pageTemperature_selectorCnt">
					<table border='0' width='100%'>
						<tr valign='middle'>
							<td><div class='UIOptionSmall' style='font-size:0.9em' id='pageTemperature_selector' data-option='0|TEMPERATURE|1|FIRST COFFEE CYCLE' data-onclick='pageTemperature_onSelector()'></div></td>
						</tr>
					</table>
					<br>
				</div>
				<div id="pageTemperature_0" style="display:none">			
					<!-- creato dinamicamente, vedi pageTemperature_build -->
				</div>
				<div id="pageTemperature_1" style="display:none">
					<table border='0' class='elenco'>
						<tr>
							<td style="width:500px">X9 Wait time 3<br><span class="tip">min time since last coffee</span></td>
							<td><div class='UINumber' id="pageTemperature_1_x9" data-numfigures='2' data-da3='8406' data-da3bit='8' data-min='0' data-max='30' data-um='min' data-onChange="pageTemperature_onX9Changed()"></div></td>
						</tr>
					</table>
					<table border='0' class='elenco' id="pageTemperature_1_params">					
						<tr><td style="width:500px">X4 Rinse 2<br><i><span class="tip">water qty in brewer</span></td><td><div class='UINumber' data-numfigures='3' data-da3='8396' data-da3bit='8' data-min='0' data-max='100' data-um='ml'></div></td></tr>

						<tr><td>X5 Wait time 2<br><span class="tip">time for water to stay in brewer</span></td><td><div class='UINumber' data-numfigures='3' data-decimal="1" data-da3='8398' data-da3bit='8' data-min='0' data-max='250' data-um='sec'></div></td></tr>
						<tr><td>X6 Wait time 3<br><span class="tip">time to empty water from brewer</span></td> <td><div class='UINumber' data-numfigures='3' data-decimal="1" data-da3='8400' data-da3bit='8' data-min='0' data-max='250' data-um='sec'></div></td></tr>

						<tr><td>X7 Rinsing Temperature</td><td><div class='UINumber' data-numfigures='3' data-da3='8402' data-da3bit='8' data-min='0' data-max='110' data-um='&deg;C'></div></td></tr>
						
						<tr><td>X8<br><span class="tip">opening brewer %</span></td><td><div class='UINumber' data-numfigures='3' data-da3='8404' data-da3bit='8' data-min='0' data-max='100' data-um='%'></div></td></tr>

						<tr><td>X10<br><span class="tip">max "beverage" qty</span></td><td><div class='UINumber' data-numfigures='3' data-da3='8408' data-da3bit='8' data-min='0' data-max='200' data-um='cc'></div></td></tr>
						
						<tr><td>X11<br><span class="tip">Release time with closed EVs</span></td><td><div class='UINumber' data-numfigures='3' data-da3='8410' data-decimal="1" data-da3bit='8' data-min='0' data-max='100' data-um='sec'></div></td></tr>
						<tr><td>X12<br><span class="tip">Pressure release time</span></td><td><div class='UINumber' data-numfigures='3' data-da3='8412' data-decimal="1" data-da3bit='8' data-min='0' data-max='100' data-um='sec'></div></td></tr>
						<tr><td>X13<br><span class="tip">Rebuild pressure time</span></td><td><div class='UINumber' data-numfigures='2' data-da3='8414' data-da3bit='8' data-min='0' data-max='10' data-um='sec'></div></td></tr>
						<!-- 2024-12-10: NST non la vuole piu'
						<tr><td>X15<br><span class="tip">Automatic water flush function</span></td><td><div class='UIOption' data-option='1|有効|0|無効' data-da3='8420' data-da3bit='8'></div></td></tr>
						-->
						
					</table>				
				</div>
			</div>
		</div> <!-- pageTemperature -->
		
		
		<!-- pageCalibration -->
		<div id="pageCalibration" class="UIWindow">
			<div class="UIWindowContent">
				<div id="pageCalibration_selectorCnt">
					<table border='0' width='100%'>
						<tr valign='middle'>
							<td><div class='UIOptionSmall' style='font-size:0.9em' id='pageCalibration_selector' data-option='0|プロダクツ|1|ウオーター' data-onclick='pageCalibration_onSelector()'></div></td>
						</tr>
					</table>
					<br>
				</div>
				
				<div id="pageCalibration_0" style="display:none">			
					<table border='0' class='elenco'>
						<tr id="pageCalibration_rowMotor1">
							<td style="width:150px">モーター 1</td>
							<td style="width:274px"><div id="pageCalibration_m1" class="bigCaption15"></div></td>
							<td style="width:300px"><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageCalibration_reset(1)"></div></td>
							<td style="width:300px"><div class='UIButton bigButton60 actionButton' data-caption='校正' data-onclick="pageCalibration_start(1)"></div></td>
						</tr>
						
						<tr id="pageCalibration_rowMotor2">
							<td>モーター 2</td>
							<td><div id="pageCalibration_m2" class="bigCaption15"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageCalibration_reset(2)"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='校正' data-onclick="pageCalibration_start(2)"></div></td>
						</tr>

						<tr>
							<td>モーター 3</td>
							<td><div id="pageCalibration_m3" class="bigCaption15"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageCalibration_reset(3)"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='校正' data-onclick="pageCalibration_start(3)"></div></td>
						</tr>
						
						<tr>
							<td>モーター 4</td>
							<td><div id="pageCalibration_m4" class="bigCaption15"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageCalibration_reset(4)"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='校正' data-onclick="pageCalibration_start(4)"></div></td>
						</tr>

						<tr>
							<td>モーター 5</td>
							<td><div id="pageCalibration_m5" class="bigCaption15"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageCalibration_reset(5)"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='校正' data-onclick="pageCalibration_start(5)"></div></td>
						</tr>
						<tr>
							<td>モーター 6</td>
							<td><div id="pageCalibration_m6" class="bigCaption15"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageCalibration_reset(6)"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='校正' data-onclick="pageCalibration_start(6)"></div></td>
						</tr>
						
						<tr id="pageCalibration_rowMotor21" style="display:none">
							<td>モーター 21 (EXT)</td>
							<td><div id="pageCalibration_m21" class="bigCaption15"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageCalibration_reset(21)"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='校正' data-onclick="pageCalibration_start(21)"></div></td>
						</tr>
						<tr id="pageCalibration_rowMotor22" style="display:none">
							<td>モーター 22 (EXT)</td>
							<td><div id="pageCalibration_m22" class="bigCaption15"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick="pageCalibration_reset(22)"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='校正' data-onclick="pageCalibration_start(22)"></div></td>
						</tr>						
					</table>
				</div>
				<div id="pageCalibration_1" style="display:none">					
				</div>
				
			</div>
		</div> <!-- pageCalibration -->
		
		<!-- page Payment -->
		<div id="pagePayment" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' width='100%'>
					<tr valign='middle'>
						<td id="pagePayment_selector">
							<div class='UIOptionSmall' id='pagePayment_selector' data-option='' data-onclick='pagePayment_onSelector()'></div>
						</td>
					</tr>
				</table>
				<br>
			
				<div id="pagePayment_general" style="display:none">
					<table border='0' class='elenco'>
						<tr style="border-bottom: none;">
							<td>コインメックタイプ</td>
							<td><div id='pagePayment_general_payMethod' class='UISelect' style='min-width:200px' data-option='0|シングルベンド|1|マルチベンド|2|EXECUTIVE|3|価格保持|4|MDB' data-da3='7058' data-da3bit='8' data-onchange="pagePayment_onPaymentMethod()"></div></td>
						</tr>
						<tr id="pagePayment_general_trExe1" style="border-bottom: none;">
							<td><div style="margin-left:100px">スタートアップ時に価格を確認する</div></td>
							<td><div class='UIOption' data-option='0|いいえ|1|はい' data-da3='8416' data-da3bit='8'></div></td>
						</tr>
						<tr id="pagePayment_general_trExe2" style="border-bottom: none;">
							<td><div style="margin-left:100px" id="pagePayment_general_trExe2_label">決済タイムアウト</div></td>
							<td><div class='UINumber' data-numfigures='3' data-da3='8418' data-da3bit='8' data-min='0' data-max='255' data-um='sec'></div></td>
						</tr>												
						<tr style="border-top: solid 1px #999999;;">
							<td>通貨（価格）<br> Decimals Num.</td>
							<td><div class='UIOption' data-option='0|0|1|1|2|2|3|3' data-da3='7066' data-da3bit='8'></div></td>
						</tr>
						<tr>
							<td>現金の価格表</td>
							<td><div class='UIOption' data-option='0|1|1|2' data-da3='8374' data-da3bit='8'></div></td>
						</tr>
						<tr>
							<td>キャッシュレスの価格表</td>
							<td><div class='UIOption' data-option='0|1|1|2' data-da3='8376' data-da3bit='8'></div></td>
						</tr>
					</table>				
				</div>

				<div id="pagePayment_mdb">
					<center>パラメータの変更には再起動してください</center><br>
					<table border='0' class='elenco'>
						<tr>
							<td style="width:400px">エスクローの有効<br><span class="tip">コイン返却タイミング</span></td>
							<td><div class='UIOption' data-option='0|いつでも|1|押した後のみ' data-da3='7236' data-da3bit='8'></div></td>
						</tr>
						<tr><td>クレジットMAX</td><td><div id="pagePayment_creditMax" class="UINumber" data-numfigures="5" data-max="60000" data-da3="7238" data-da3bit="16"></div></td></tr>
						<tr><td>レスト MAX</td><td><div  id="pagePayment_restMax"class="UINumber" data-numfigures="5" data-max="60000" data-da3="7240" data-da3bit="16"></div></td></tr>
						<tr>
							<td>販売タイプ</td>
							<td><div class='UIOption' data-option='0|SINGLE|1|MULTI' data-da3='7242' data-da3bit='8'></div></td>
						</tr>
						<tr><td>トークン値</td><td><div id="pagePayment_tokenV" class="UINumber" data-numfigures="5" data-max="10000" data-da3="7244" data-da3bit="16"></div></td></tr>
						<tr><td>ビルバリ</td><td><div class='UIOption' data-option='0|0|1|1|2|2' data-da3='7310' data-da3bit='8'></div></td></tr>
						
						<tr><td>コインレッション A</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7246' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション B</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7248' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション C</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7250' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション D</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7252' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション E</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7254' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション F</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7256' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション G</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7258' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション H</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7260' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション I</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7262' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション J</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7264' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション K</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7266' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション L</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7268' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション M</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7270' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション N</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7272' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション O</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7274' data-da3bit='16'></div></td></tr>						
						<tr><td>コインレッション P</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7276' data-da3bit='16'></div></td></tr>

						<tr><td>コインなし A</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7278' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし B</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7280' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし C</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7282' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし D</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7284' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし E</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7286' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし F</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7288' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし G</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7290' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし H</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7292' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし I</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7294' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし J</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7296' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし K</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7298' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし L</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7300' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし M</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7302' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし N</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7304' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし O</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7306' data-da3bit='16'></div></td></tr>						
						<tr><td>コインなし P</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7308' data-da3bit='16'></div></td></tr>
					</table>				
				</div>			
				
				<div id="pagePayment_mdbTubes" style="display:none">
					<table border='0' class='elenco'>
						<tr>
							<td>返金用クレジット</td>
							<td><div class="bigCaption15" id="pagePayment_mdbTubes_tot"></div></td>
						</tr>
						<tr><td>TUBE: <span id="pagePayment_mdbTubes_t1"></span></td><td><div class='UIButton bigButton60 actionButton' data-caption='EJECT COINS' data-onclick="pagePayment_tube_eject(1)"></div></td></tr>
						<tr><td>TUBE: <span id="pagePayment_mdbTubes_t2"></span></td><td><div class='UIButton bigButton60 actionButton' data-caption='EJECT COINS' data-onclick="pagePayment_tube_eject(2)"></div></td></tr>
						<tr><td>TUBE: <span id="pagePayment_mdbTubes_t3"></span></td><td><div class='UIButton bigButton60 actionButton' data-caption='EJECT COINS' data-onclick="pagePayment_tube_eject(3)"></div></td></tr>
						<tr><td>TUBE: <span id="pagePayment_mdbTubes_t4"></span></td><td><div class='UIButton bigButton60 actionButton' data-caption='EJECT COINS' data-onclick="pagePayment_tube_eject(4)"></div></td></tr>
						<tr><td>TUBE: <span id="pagePayment_mdbTubes_t5"></span></td><td><div class='UIButton bigButton60 actionButton' data-caption='EJECT COINS' data-onclick="pagePayment_tube_eject(5)"></div></td></tr>
						<tr><td>TUBE: <span id="pagePayment_mdbTubes_t6"></span></td><td><div class='UIButton bigButton60 actionButton' data-caption='EJECT COINS' data-onclick="pagePayment_tube_eject(6)"></div></td></tr>
					</table>
					
				</div>
				
				<div id="pagePayment_mid" style="display:none">
					<table border='0' class='elenco'>
						<tr>
							<td>プロトコル</td>
							<td><div class='UISelect' data-option='0|TM-ON|1|DDCMP 2400++|2|DEX|3|DEX reset|4|DDCMP 9600|5|DDCMP 1200|6|TEST FUN|7|IRDA' data-da3='7330'></div></td>
						</tr>						
						<tr>
							<td>CODE ID 101</td>
							<td><div class="UINumber" data-numfigures="9" data-max="999999999" data-da3="7314" data-da3bit="32"></div></td>
						</tr>
						<tr>
							<td>CODE ID 104</td>
							<td><div class="UINumber" data-numfigures="9" data-max="999999999" data-da3="7318" data-da3bit="32"></div></td>
						</tr>
						<tr>
							<td>CODE ID 106</td>
							<td><div class="UINumber" data-numfigures="9" data-max="999999999" data-da3="7322" data-da3bit="32"></div></td>
						</tr>
						<tr>
							<td>アドレスvidts</td>
							<td><div class="UINumber" data-numfigures="3" data-max="999" data-da3="7326" data-da3bit="16"></div></td>
						</tr>
					</table>
				</div>
				
				<div id="pagePayment_rfid">
					<table border='0' class='elenco'>
						<tr>
							<td>最大クレジットカード</td>
							<td><div id="pagePayment_maxCC" class="UINumber" data-numfigures="5" data-max="60000" data-da3="7136" data-da3bit="16"></div></td>
						</tr>
						<tr>
							<td>割引</td>
							<td><div class="UINumber" data-numfigures="2" data-max="80" data-da3="7196" data-da3bit="16" data-um="%"></div></td>
						</tr>
						<tr><td>COIN A CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7144'></div></td></tr>
						<tr><td>COIN B CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7146'></div></td></tr>
						<tr><td>COIN C CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7148'></div></td></tr>
						<tr><td>COIN D CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7150'></div></td></tr>
						<tr><td>COIN E CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7152'></div></td></tr>
						<tr><td>COIN F CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7154'></div></td></tr>
						<tr><td>COIN G CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7156'></div></td></tr>
						<tr><td>COIN H CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7158'></div></td></tr>
						<tr><td>COIN I CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7160'></div></td></tr>
						<tr><td>COIN J CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7162'></div></td></tr>
						
						<tr><td>COIN A NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7176'></div></td></tr>
						<tr><td>COIN B NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7178'></div></td></tr>
						<tr><td>COIN C NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7180'></div></td></tr>
						<tr><td>COIN D NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7182'></div></td></tr>
						<tr><td>COIN E NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7184'></div></td></tr>
						<tr><td>COIN F NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7186'></div></td></tr>
						<tr><td>COIN G NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7188'></div></td></tr>
						<tr><td>COIN H NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7190'></div></td></tr>
						<tr><td>COIN I NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7192'></div></td></tr>
						<tr><td>COIN J NO CARD</td><td><div class='UIOption' data-option='1|いいえ|0|承認します' data-da3='7194'></div></td></tr>
					</table>
				</div>	

				<div id="pagePayment_alipayChina">
					<table border='0' class='elenco'>
						<tr>
							<td style="width:200px">IP</td>
							<td><div  id="pagePayment_alichina_ip" class="bigCaption15"></div></td>
						</tr>
						<tr>
							<td>PORT</td>
							<td><div  id="pagePayment_alichina_port" class="bigCaption15"></div></td>
						</tr>
						<tr>
							<td>MACHINE NAME</td>
							<td><div  id="pagePayment_alichina_mid" class="bigCaption15"></div></td>
						</tr>
						<tr>
							<td>KEY</td>
							<td><div  id="pagePayment_alichina_key" class="bigCaption15"></div></td>
						</tr>
						
					</table>
				</div>
				
				<div id="pagePayment_parallel">
					<table border='0' class='elenco'>
						<tr><td>COIN A</td><td><div id="pagePayment_coin0" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7012" data-da3bit="16"></div></td></tr>
						<tr><td>COIN B</td><td><div id="pagePayment_coin1" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7014" data-da3bit="16"></div></td></tr>
						<tr><td>COIN C</td><td><div id="pagePayment_coin2" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7016" data-da3bit="16"></div></td></tr>
						<tr><td>COIN D</td><td><div id="pagePayment_coin3" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7018" data-da3bit="16"></div></td></tr>
						<tr><td>COIN E</td><td><div id="pagePayment_coin4" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7020" data-da3bit="16"></div></td></tr>
						<tr><td>COIN F</td><td><div id="pagePayment_coin5" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7022" data-da3bit="16"></div></td></tr>
						<tr><td>COIN G</td><td><div id="pagePayment_coin6" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7024" data-da3bit="16"></div></td></tr>
						<tr><td>COIN H</td><td><div id="pagePayment_coin7" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7026" data-da3bit="16"></div></td></tr>
						<tr><td>COIN I</td><td><div id="pagePayment_coin8" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7028" data-da3bit="16"></div></td></tr>
						<tr><td>COIN J</td><td><div id="pagePayment_coin9" class="UINumber" data-numfigures="5" data-max="65000" data-da3="7030" data-da3bit="16"></div></td></tr>
					</table>
				</div>				
				
			</div>
		</div><!-- page Payment -->		
		
		
		<!-- page Devices -->
		<div id="pageDevices" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' width='100%' id="pageDevices_selectorTable">
					<tr valign='middle'>
						<td><div class='UIOptionSmall' id='pageDevices_selectorVFlex' data-option='' data-onclick='pageDevices_onSelector()'></div></td>
					</tr>
				</table>
				<div style='height:5px'></div>
			
				<!--DEVICES OTHER-->
				<div id="pageDevices_general" style="display:none">
					<table border='0' class='elenco'>
						<tr>
							<td>フローメータ―モデル</td>
							<td><div id="divFlowMeterModelLabel" class="bigCaption12"></div></td>
						</tr>				
						<tr>
							<td style="width:450px">排水トレイの検出</td>
							<td><div class='UIOption' data-option='0|いいえ|1|はい' data-da3='7092' data-da3bit='8'></div></td>
						</tr>
						<tr id="pageDevices_cofSensor"><td>コーヒーセンサー</td><td><div class='UIOption' data-option='1|有効|0|無効' data-da3='7094' data-da3bit='8'></div></td></tr>
						<tr id="pageDevices_cupSensor">
							<td>カップセンサー閾値</td>
							<td>
								<div style="float:left"><div id="pageDevices_cupSensorOBJ" class="UINumber" data-numfigures="3" data-max="180" data-da3="7108" data-da3bit="8"></div></div>
								<div style="float:left; margin-left:40px">現在の値:<br><span class="bigCaption15" id="divCupSensorLiveValue"></span></div>
								<div style="clear"></div>								
							</td>
						</tr>
						<tr id="pageDevices_cupSensorBrewmatic">
							<td>検出されたカップサイズ</td>
							<td><div id="divCupSensorLiveValueBrewmatic" class="bigCaption15"></div></td>
						</tr>
						<tr id="pageDevices_cupSensorWenglor">
							<td>WENGLOR製カップセンサー</td>
							<td><div id="pageDevices_cupSensorWenglorOBJ" class='UIOption' data-option='0|いいえ|1|はい' data-da3='7108' data-da3bit='8'></div></td>
						</tr>						
						<tr id="pageDevices_cupSensorWenglorLive">
							<td>検出されたカップサイズ</td>
							<td><div id="divCupSensorLiveValueWenglor" class="bigCaption15">"スモールカップ（下限）</div></td>
						</tr>
						<tr id="pageDevices_boilerSize"><td>ボイラー</td><td><div class='UIOption' data-option='0|400 cc|1|800 cc' data-da3='7072' data-da3bit='8'></div></td></tr>
						
						<tr><td>モデムテスト</td><td><div class='UIButton bigButton60 actionButton' data-caption='スタート' data-onclick="pageDevices_startModemTest()"></div></td></tr>
						<tr id="pageDevices_grpTest"><td>グループテスト</td><td><div class='UIButton bigButton60 actionButton' data-caption='スタート' data-onclick="pageDevices_startTestAssorbGruppo()"></div></td></tr>
						<tr id="pageDevices_motorTest"><td>モーターテスト</td><td><div class='UIButton bigButton60 actionButton' data-caption='スタート' data-onclick="pageDevices_startTestAssorbMotoriduttore()"></div></td></tr>
						
						<tr id="pageDevices_vibrationTest">
							<td>TEST VIBRATION</td>
							<td>
								<div style="float:left"><div id="pageDevices_vibrationTest_perc" class="UINumber" data-numfigures="3" data-max="100" data-min="1"></div></div>
								<div style="float:left; margin-left:40px">
									<div class='UIButton bigButton60 actionButton' data-caption='スタート' data-onclick="pageDevices_startBrewmaticVibrationTest()"></div>
								</div>
								<div style="clear"></div>
							</td>
						</tr>
					</table>
				</div>

				<!--DEVICES SNACK-->
				<div id="pageDevices_snack" style="display:none">
					<table border='0' class='elenco'>
						<tr>
							<td>SNACK PROGRAMMING</td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='プログラムに入ります' data-onclick="pageDevices_snack_enterProg()"></div></td>
							<td><div class='UIButton bigButton60 actionButton' data-caption='プログラムを出ます' data-onclick="pageDevices_snack_exitProg()"></div></td>
						</tr>
						<tr><td>価格 1</td><td colspan='2'><div id='pageDevices_snack_prc1' class="UINumber" data-da3='7776' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 2</td><td colspan='2'><div id='pageDevices_snack_prc2' class="UINumber" data-da3='7778' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 3</td><td colspan='2'><div id='pageDevices_snack_prc3' class="UINumber" data-da3='7780' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 4</td><td colspan='2'><div id='pageDevices_snack_prc4' class="UINumber" data-da3='7782' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 5</td><td colspan='2'><div id='pageDevices_snack_prc5' class="UINumber" data-da3='7784' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 6</td><td colspan='2'><div id='pageDevices_snack_prc6' class="UINumber" data-da3='7786' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 7</td><td colspan='2'><div id='pageDevices_snack_prc7' class="UINumber" data-da3='7788' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 8</td><td colspan='2'><div id='pageDevices_snack_prc8' class="UINumber" data-da3='7790' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 9</td><td colspan='2'><div id='pageDevices_snack_prc9' class="UINumber" data-da3='7792' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 10</td><td colspan='2'><div id='pageDevices_snack_prc10' class="UINumber" data-da3='7794' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 11</td><td colspan='2'><div id='pageDevices_snack_prc11' class="UINumber" data-da3='7796' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 12</td><td colspan='2'><div id='pageDevices_snack_prc12' class="UINumber" data-da3='7798' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 13</td><td colspan='2'><div id='pageDevices_snack_prc13' class="UINumber" data-da3='7800' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 14</td><td colspan='2'><div id='pageDevices_snack_prc14' class="UINumber" data-da3='7802' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 15</td><td colspan='2'><div id='pageDevices_snack_prc15' class="UINumber" data-da3='7804' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 16</td><td colspan='2'><div id='pageDevices_snack_prc16' class="UINumber" data-da3='7806' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 17</td><td colspan='2'><div id='pageDevices_snack_prc17' class="UINumber" data-da3='7808' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>
						<tr><td>価格 18</td><td colspan='2'><div id='pageDevices_snack_prc18' class="UINumber" data-da3='7810' data-da3bit='16' data-numfigures="5" data-decimal='0' data-max="65000"></div></td></tr>			
					</table>
				</div> <!--DEVICES SNACK-->
				
				<!--DEVICES VARIFLEX / MICRO-->
				<div id="pageDevices_vflex" style="display:none">
					<table border='0' class='elenco'>
						<tr><td>シリンダー径</td><td><div id="pageDevices_vflex_brewerDiam" class='UIOption' data-option='0|36mm|1|45mm' data-da3='7554' data-da3bit='8'></div></td></tr>
						<tr><td>スタート位置</td><td><div class='UIOption' data-option='0|クローズ|1|オープン' data-da3='7556' data-da3bit='8'></div></td></tr>
						<tr id="pageDevices_vflex_autoAdjust"><td>自動補正機能</td><td><div id="pageDevices_vflex_v1AutoAdjust" class='UIOption' data-option='0|いいえ|1|はい' data-da3='7558' data-da3bit='8'></div></td></tr>
						<tr id="pageDevices_vflex_deliveryPhase"><td>抽出速度</td><td><div class='UIOption' data-option='0|ノーマル|1|速い' data-da3='7570' data-da3bit='8'></div></td></tr>
						<tr id="pageDevices_vfles_specialMove1811_1">
							<td>ユニットエラーをリセットする</td>
							<td><div class='UIOption' data-option='0|いいえ|1|はい' data-da3='7580' data-da3bit='8'></div></td>
						</tr>
						<tr id="pageDevices_vfles_specialMove1811_2">
							<td>時間が経過したのでリンスします</td>
							<td><div class='UIOption' data-option='0|無効|1|6 時間|2|12 時間|3|24 時間' data-da3='7582' data-da3bit='8'></div></td>
						</tr>						
						<tr id="pageDevices_grinderSpeedTest">
							<td>OFF09用グラインダー回転数</td>
							<td>
								<table style="width:100%">
									<tr>
										<td><div id="pageDevices_vflex_grnSpeedOff9" class="UINumber" data-numfigures="4" data-max="9999" data-da3="7558" data-da3bit="16"></div></td>
										<td><div class='UIButton bigButton60 actionButton' data-caption='テスト' data-onclick="pageDevices_startGrinderSpeedTest()"></div></td>
									</tr>
								</table>
							</td>
						</tr>
					</table>				
				</div>
				
				<!--DEVICES: network-->
				<div id="pageDevices_network" style="display:none">
					<table border='0' class='elenco'>
						<tr class="smallHeightNoBorder">
							<td>D32 OS-VER</td>
							<td>MAC ADDRESS</td>
							<td>IP: ETH0</td>
							<td>IP: WI-FI</td>
							<td>IP: LTE</td>
						</tr>
						<tr style="height:20px">
							<td><div id="pageDevices_network_verSecoOS" class="bigCaption10"></div></td>
							<td><div id="pageDevices_network_mac" class="bigCaption10"></div></td>
							<td><div id="pageDevices_network_lanIP" class="bigCaption10"></div></td>
							<td><div id="pageDevices_network_wifiIP" class="bigCaption10"></div></td>
							<td><div id="pageDevices_network_LTEIP" class="bigCaption10"></div></td>
							
						</tr>
					</table>

					<table border='0' class='elenco'>					
						<tr style="vertical-align:top">
							<td>MODEM LTE</td>
							<td>
								<div class='UIOption' id="pageDevices_network_LTE" data-onclick="pageDevices_network_onLTEChanged()" data-option='0|無効|1|有効'></div>
								<div id="pageDevices_network_LTE_APN" style="display:none">
									<table border='0' class='elenco'>
										<tr class="smallHeightNoBorder">
											<td id="pageDevices_network_LTE_APN_info">APN:&nbsp;</td>
											<td align="right"><div class='UIButton bigButton60 actionButton' data-caption='CHANGE APN' data-onclick="pageLTEConfigBegin()"></div></td>
										</tr>
									</table>
								</div>								
							</td>
						</tr>
						<tr style="vertical-align:top">
							<td><div style="margin-top:35px">WI-FI</div></td>
							<td>
								<div class='UIOption' id="pageDevices_network_WIFISelector" data-onclick="pageDevices_network_onWIFISelector()" data-option='0|無効|1|CONNECT TO...'></div>
								<div id="pageDevices_network_wifi_ssid" style="display:none">
									<table border='0' class='elenco'>
										<tr class="smallHeightNoBorder">
											<td>
												<div id='pageDevices_network_WIFI_ssidName'>SSID</div>
												<div id='pageDevices_network_WIFI_ssidPwd'>PWD</div>
											</td>
											<td align="right">
												<div class='UIButton bigButton60 actionButton' data-caption='SCAN WI-FI SSID' data-onclick="pageDevices_network_onScanWIFISSID()"></div>
											</td>
										</tr>
									</table>
								</div>
							</td>
						</tr>								
					</table>				
				</div>

				<!--- varigrind-->
				<div id="pageDevices_vgrind" style="display:none">
					<div class='UIOptionSmall' id='pageDevices_vgrind_selector' data-option='1|VARIGRIND 1|2|VARIGRIND 2' data-onclick='pageDevices_onVGrindSelector()'></div>
				
					<!--- vgrind 1-->
					<div id="pageDevices_vgrind1" style="display:none">
						<table border='0' class='elenco'>
							<tr>
								<td style="width:260px">
									ポジション<br>
									<div style="float:left; margin-right:10px">現在の値:</div>
									<div style="float:left" id="pageDevices_vg1" class="bigCaption15">000</div>
									<div class="clear"></div>
								</td>
							</tr>
							<tr>
								<td>自動構成の有効</td>
								<td colspan="2"><div id='pageDevices_vgrind1_selector' class='UIOption' data-option='0|いいえ|1|はい' data-da3='7590' data-da3bit='8' data-onclick='pageDevices_onEnableAuto(1)'></div></td>
							</tr>
						</table>
						<table border='0' class='elenco' id='pageDevices_vgrind1_params'>
							<tr>
								<td>
									<table class='elenco' border='0'>
										<tr valign="middle" style='border:none'>
											<td style='width:155px;'>サンプル杯数</td>
											<td style='width:210px; border-right:solid 1px #999'><div class="UINumber" data-numfigures="3" data-min="10" data-max="100" data-da3="7594" data-da3bit="16"></div></td>
											<td style='width:180px; padding-left:15px;'>参照する <br>ボタン</td>
											<td style='width:160px; border-right:solid 1px #999'><div id='pageDevices_vgrind1_selNum' class="UINumber" data-numfigures="2" data-min="1" data-max="48" data-da3="7588" data-da3bit="8"></div></td>
											<td align="right"><div class='UIButton bigButton60 actionButton' data-caption='セレクションを実行します' data-onclick="pageDevices_vgrind_runSelection(1)"></div></td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table class='elenco' border='0'>
										<tr valign="middle" style='border:none'>
											<td style='width:145px;'>参照する <br>キャリブレーション値</td>
											<td style='width:320px; border-right:solid 1px #999'>
												<div class="UINumber" id='pageDevices_vgrind1_refFlux' data-numfigures="3" data-max="900" data-decimal="2" data-da3="7592" data-da3bit="16" data-um="cc/sec"></div>
											</td>
											<td style='width:175px; padding-left:10px'>参照する<br>パルス値</td>
											<td style='width:70px; border-right:solid 1px #999'><div id='pageDevices_vgrind1_lastPos_caption' style='color:#fff; font-size:1.5em'>000</div></td>
											<td align="right">
												<div id='pageDevices_vgrind1_lastFlux_caption' class="tip" style="color:#fff">最後のフラックス/位置：<br> <b> RUN選択</ b>をクリックしてください</div>
												<div id='pageDevices_vgrind1_lastFlux_btnUse' class='UIButton bigButton60 actionButton' style='font-size:1.0em' data-caption='データ保存' data-onclick="pageDevices_vgrind_useLastFluxAndPos(1)"></div>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</div>
					
					<!--- vgrind 2-->
					<div id="pageDevices_vgrind2" style="display:none">
						<table border='0' class='elenco'>
							<tr>
								<td style="width:260px">
									ポジション<br>
									<div style="float:left; margin-right:10px">現在の値:</div>
									<div style="float:left" id="pageDevices_vg2" class="bigCaption15">000</div>
									<div class="clear"></div>
								</td>
							</tr>
							<tr><td>自動構成の有効</td><td colspan="2"><div id='pageDevices_vgrind2_selector' class='UIOption' data-option='0|いいえ|1|はい' data-da3='7654' data-da3bit='8' data-onclick='pageDevices_onEnableAuto(2)'></div></td></tr>
						</table>
						<table border='0' class='elenco' id='pageDevices_vgrind2_params'>
							<tr>
								<td>
									<table class='elenco' border='0'>
										<tr valign="middle" style='border:none'>
											<td style='width:155px;'>サンプル杯数</td>
											<td style='width:210px; border-right:solid 1px #999'><div class="UINumber" data-numfigures="3" data-min="10" data-max="100" data-da3="7658" data-da3bit="16"></div></td>
											<td style='width:180px; padding-left:15px;'>参照する <br>ボタン</td>
											<td style='width:160px; border-right:solid 1px #999'><div id='pageDevices_vgrind2_selNum' class="UINumber" data-numfigures="2" data-min="1" data-max="48" data-da3="7652" data-da3bit="8"></div></td>
											<td align="right"><div class='UIButton bigButton60 actionButton' data-caption='セレクションを実行します' data-onclick="pageDevices_vgrind_runSelection(2)"></div></td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table class='elenco' border='0'>
										<tr valign="middle" style='border:none'>
											<td style='width:145px;'>参照する <br>キャリブレーション値</td>
											<td style='width:320px; border-right:solid 1px #999'>
												<div class="UINumber" id='pageDevices_vgrind2_refFlux' data-numfigures="3" data-max="900" data-decimal="2" data-da3="7656" data-da3bit="16" data-um="cc/sec"></div>
											</td>
											<td style='width:175px; padding-left:10px'>参照する<br>パルス値</td>
											<td style='width:70px; border-right:solid 1px #999'><div id='pageDevices_vgrind2_lastPos_caption' style='color:#fff; font-size:1.5em'>000</div></td>
											<td align="right">
												<div id='pageDevices_vgrind2_lastFlux_caption' class="tip" style="color:#fff">最後のフラックス/位置：<br> <b> RUN選択</ b>をクリックしてください</div>
												<div id='pageDevices_vgrind2_lastFlux_btnUse' class='UIButton bigButton60 actionButton' style='font-size:1.0em' data-caption='データ保存' data-onclick="pageDevices_vgrind_useLastFluxAndPos(2)"></div>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</div>
					
					<!--- vgrind 3-->
					<div id="pageDevices_vgrind3" style="display:none">
						<table border='0' class='elenco'>
							<tr>
								<td style="width:260px">
									ポジション<br>
									<div style="float:left; margin-right:10px">現在の値:</div>
									<div style="float:left" id="pageDevices_vg3" class="bigCaption15">000</div>
									<div class="clear"></div>
								</td>
							</tr>
							<tr>
								<td>自動構成の有効</td>
								<td colspan="2"><div id='pageDevices_vgrind3_selector' class='UIOption' data-option='0|いいえ|1|はい' data-da3='7686' data-da3bit='8' data-onclick='pageDevices_onEnableAuto(3)'></div></td>
							</tr>
						</table>
						<table border='0' class='elenco' id='pageDevices_vgrind3_params'>
							<tr>
								<td>
									<table class='elenco' border='0'>
										<tr valign="middle" style='border:none'>
											<td style='width:155px;'>サンプル杯数</td>
											<td style='width:210px; border-right:solid 1px #999'><div class="UINumber" data-numfigures="3" data-min="10" data-max="100" data-da3="7690" data-da3bit="16"></div></td>
											<td style='width:180px; padding-left:15px;'>参照する <br>ボタン</td>
											<td style='width:160px; border-right:solid 1px #999'><div id='pageDevices_vgrind3_selNum' class="UINumber" data-numfigures="2" data-min="1" data-max="48" data-da3="7684" data-da3bit="8"></div></td>
											<td align="right"><div class='UIButton bigButton60 actionButton' data-caption='セレクションを実行します' data-onclick="pageDevices_vgrind_runSelection(3)"></div></td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table class='elenco' border='0'>
										<tr valign="middle" style='border:none'>
											<td style='width:145px;'>参照する <br>キャリブレーション値</td>
											<td style='width:320px; border-right:solid 1px #999'>
												<div class="UINumber" id='pageDevices_vgrind3_refFlux' data-numfigures="3" data-max="900" data-decimal="2" data-da3="7688" data-da3bit="16" data-um="cc/sec"></div>
											</td>
											<td style='width:175px; padding-left:10px'>参照する<br>パルス値</td>
											<td style='width:70px; border-right:solid 1px #999'><div id='pageDevices_vgrind3_lastPos_caption' style='color:#fff; font-size:1.5em'>000</div></td>
											<td align="right">
												<div id='pageDevices_vgrind3_lastFlux_caption' class="tip" style="color:#fff">最後のフラックス/位置：<br> <b> RUN選択</ b>をクリックしてください</div>
												<div id='pageDevices_vgrind3_lastFlux_btnUse' class='UIButton bigButton60 actionButton' style='font-size:1.0em' data-caption='データ保存' data-onclick="pageDevices_vgrind_useLastFluxAndPos(3)"></div>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</div>

					<!--- vgrind 4-->
					<div id="pageDevices_vgrind4" style="display:none">
						<table border='0' class='elenco'>
							<tr>
								<td style="width:260px">
									ポジション<br>
									<div style="float:left; margin-right:10px">現在の値:</div>
									<div style="float:left" id="pageDevices_vg4" class="bigCaption15">000</div>
									<div class="clear"></div>
								</td>
							</tr>
							<tr>
								<td>自動構成の有効</td>
								<td colspan="2"><div id='pageDevices_vgrind4_selector' class='UIOption' data-option='0|いいえ|1|はい' data-da3='7718' data-da3bit='8' data-onclick='pageDevices_onEnableAuto(4)'></div></td>
							</tr>
						</table>
						<table border='0' class='elenco' id='pageDevices_vgrind4_params'>
							<tr>
								<td>
									<table class='elenco' border='0'>
										<tr valign="middle" style='border:none'>
											<td style='width:155px;'>サンプル杯数</td>
											<td style='width:210px; border-right:solid 1px #999'><div class="UINumber" data-numfigures="3" data-min="10" data-max="100" data-da3="7722" data-da3bit="16"></div></td>
											<td style='width:180px; padding-left:15px;'>参照する <br>ボタン</td>
											<td style='width:160px; border-right:solid 1px #999'><div id='pageDevices_vgrind4_selNum' class="UINumber" data-numfigures="2" data-min="1" data-max="48" data-da3="7716" data-da3bit="8"></div></td>
											<td align="right"><div class='UIButton bigButton60 actionButton' data-caption='セレクションを実行します' data-onclick="pageDevices_vgrind_runSelection(4)"></div></td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table class='elenco' border='0'>
										<tr valign="middle" style='border:none'>
											<td style='width:145px;'>参照する <br>キャリブレーション値</td>
											<td style='width:320px; border-right:solid 1px #999'>
												<div class="UINumber" id='pageDevices_vgrind4_refFlux' data-numfigures="3" data-max="900" data-decimal="2" data-da3="7720" data-da3bit="16" data-um="cc/sec"></div>
											</td>
											<td style='width:175px; padding-left:10px'>参照する<br>パルス値</td>
											<td style='width:70px; border-right:solid 1px #999'><div id='pageDevices_vgrind4_lastPos_caption' style='color:#fff; font-size:1.5em'>000</div></td>
											<td align="right">
												<div id='pageDevices_vgrind4_lastFlux_caption' class="tip" style="color:#fff">最後のフラックス/位置：<br> <b> RUN選択</ b>をクリックしてください</div>
												<div id='pageDevices_vgrind4_lastFlux_btnUse' class='UIButton bigButton60 actionButton' style='font-size:1.0em' data-caption='データ保存' data-onclick="pageDevices_vgrind_useLastFluxAndPos(4)"></div>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</div>						
				</div>
			</div>
		</div><!-- page Devices -->	

		<!-- page DataAudit -->
		<div id="pageDataAudit" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' width='100%'>
					<tr valign='middle'>
						<td><div class='UIOptionSmall' id='pageDataAudit_selector' data-option='0|概要|1|合計|2|累計|4|プレセレクション|3|データの更新' data-onclick='pageDataAudit_onSelector()'></div></td>
					</tr>
				</table>
				
				<div id="pageDataAudit_o" style="display:none"></div>
				<div id="pageDataAudit_p" style="display:none"></div>
				<div id="pageDataAudit_t" style="display:none"></div>
				<div id="pageDataAudit_prs" style="display:none"></div>
				<div id="pageDataAudit_r" style="display:none">
					<div id="pageDataAudit_lastDownload">EVA-DTS, downloaded on 2019-11-26 11:42</div>
					<br>
					<table border='0' align="center">
						<tr valign='middle'>
							<td><div class='UIButton actionButton' data-caption='データの再更新' data-onclick="pageDataAudit_downloadEVA()"></div></td>
							<td style="width:100px">&nbsp;</td>
							<td><div class='UIButton actionButton' data-caption='合計データの数値リセット' data-onclick="pageDataAudit_resetPartialData()"></div></td>
						</tr>
					</table>
					
					<!-- bottone segreto per fare il reset dei totali dei dati audit. Va cliccato 5/6 volte ripetutamente -->
					<div id="divSecretDAResetButton" style="position:absolute; top:410px; left:910px; width:110px; height:90px;">&nbsp;</div>
				</div>
			</div>
		</div> <!-- page DataAudit -->

		<!-- page page Espresso Calibration -->
		<div id="pageExpCalib" class="UIWindow">
			<div class="UIWindowContent">
				
				<table border='0' class='elenco'>
					<tr style='border-bottom:none'>
						<td style="width:10%"><b style='color:#fff'>セレクション</b></td>
						<td style="width:30%" align="center"><div id='pageExpCalib_selNum' class="UINumber" data-numfigures="2" data-min="1" data-max="48"></div></td>
						<td style="width:30%" align="center"><div class='UIButton bigButton60 actionButton' data-caption='セレクションを実行します' data-onclick="pageExpCalib_runSelection()"></div></td>
						<td style="width:30%" align="center"><div class='UIButton bigButton60 actionButton' data-caption='セレクションを編集する' data-onclick="pageExpCalib_editSelection()"></div></td>
					</tr>

					<tr style='height:50px;'>
						<td>LAST FLUX</td>
						<td align="center"><div id='pageExpCalib_lastFlux'>0.00 cc/sec</div></td>
						<td colspan="2"><span class="tip">フラックス情報は「選択を実行」するたびに更新します</span></td>
					</tr>					

					<tr>
						<td><b style='color:#fff'>グラインダー</b></td>
						<td align="center">現在の校正係数<div id="pageExpCalib_grSec" class="bigCaption15">0 gr/sec</div></td>
						<td align="center"><div class='UIButton bigButton60 actionButton' data-caption='キャリブレーション開始' data-onclick="pageExpCalib_startMacinaCalib()"></div></td>
						<td align="center"><div class='UIButton bigButton60 actionButton' data-caption='キャリブレーションリセット' data-onclick="pageExpCalib_resetMacinaCalib()"></div></td>
					</tr>					


					<tr style='height:125px;' id="pageExpCalib_rowvarigrind">
						<td>
							<b style='color:#fff'>VARIGRIND</b><br>
							<div class="tip" id="pageExpCalib_vgAutoAjustEnabled"></div>
						</td>
						<td align="center">現在位置<div id="pageExpCalib_vgCurPos" class="bigCaption15">000</div></td>
						<td align="center">設定位置<div class="UINumber" id="pageExpCalib_vg_target" data-numfigures="3" data-max="500"></div></td>
						<td align="center"><div class='UIButton bigButton60 actionButton' id="pageExpCalib_vgBtnSet" data-caption='SET' data-onclick="pageExpCalib_regolaVG()"></div></td>
					</tr>
					
					<tr style='border-bottom:none' id="pageExpCalib_rowimpulsi">
						<td><b style='color:#fff'>インパルス</b></td>
						<td align="center">現在<div id="pageExpCalib_imp" class="bigCaption15">0.00 imp/gr</div></td>
						<td colspan="2" align="right">
							<table style="width:100%">
								<tr>
									<td style="width:30%; text-align:right"><b style='color:#fff'>グラインダー&nbsp;</b></td>
									<td style="width:70%"><div class='UIOption' id='pageExpCalib_macina1o2' data-option='' data-onclick='pageExpCalib_onChangeGrinder()'></div></td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</div>
		</div> <!-- page pageExpCalib -->		
			

		<!-- page Grinder cleaning -->
		<div id="pageGrinderCleaning" class="UIWindow">
			<div class="UIWindowContent"></div>
		</div> <!-- page Grinder cleaning -->
		
		<!-- page debugLang -->
		<div id="pageDebugLang" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' width='100%'>
					<tr valign='middle'>
						<td><div class='UIOptionSmall' id='pageDebugLang_selector' data-option='1|LANG 1|2|LANG 2' data-onclick='pageDebugLang_onSelector()'></div></td>
					</tr>
				</table>
				
				<div id="pageDebugLang_content1"></div>
				<div id="pageDebugLang_content2"></div>
			</div>
		</div> <!-- page debugLang -->
		
		<!-- page Debug -->
		<div id="pageDebug" class="UIWindow">
			<div class="UIWindowContent">
				<table border='0' width='100%'>
					<tr>
						<td>1 <div class="UINumber" id="pageDebug_num0" data-numfigures="5" data-max="65535"></div></td>
						<td>2 <div class="UINumber" id="pageDebug_num1" data-numfigures="5" data-max="65535"></div></td>
					</tr>
					<tr>
						<td>3 <div class="UINumber" id="pageDebug_num2" data-numfigures="5" data-max="65535"></div></td>
						<td>4 <div class="UINumber" id="pageDebug_num3" data-numfigures="5" data-max="65535"></div></td>
					</tr>
					<tr>
						<td>5 <div class="UINumber" id="pageDebug_num4" data-numfigures="5" data-max="65535"></div></td>
						<td><div id="pageDebug_snd" class='UIButton bigButton60 actionButton' data-caption='SEND' data-onclick="pageDebug_onBtnSend()"></div>
					</tr>
				</table>
				
				<div id="pageDebug_answ" style="background-color:#888; color:#fff; font-family: monospace, monospace;"></div>
			</div>
		</div> <!-- page Debug -->
		
		
	</div> <!-- divPage -->

	<div id="divFooter" class="footer">
		<div id="footer_L">
			<div style="float:left; margin-right:10px"><div id="bntBack" class="UIButton" data-caption="&nbsp;&nbsp;&nbsp;戻る&nbsp;&nbsp;&nbsp;" data-onclick="btnBack_onClick()"></div></div>
			<div style="float:left"><div id="btnSave" class="UIButton" data-caption="&nbsp;&nbsp;&nbsp;保存する&nbsp;&nbsp;&nbsp;" data-onclick="btnSave_onClick()"></div></div>
			<div class="clear"></div>
		</div>
		
		<div id="footer_C"></div>
		
		<div id="footer_R">
			<div id="footerBtnTestSelection" style="float:right"><div id="bntTestSelection" class="UIButton" style="display:none" data-caption="&nbsp&nbsp&nbsp&nbsp;テスト　セレクション &nbsp&nbsp&nbsp;" data-onclick="pageSingleSelection_test(0)"></div></div>
			<div class="clear"></div>
		</div>
		<div class="clear"></div>
	</div>
</div> <!-- wrapper -->


<div id="manualViewBox" style="position:absolute; top:0; left:0; background-color:rgba(80,80,80,0.9); width:100%; height:100%; text-align:center; display:none; z-index:100;">
	<iframe id='manualViewBoxFrame' class='manualViewBox_frame' src='' border='0'></iframe>
	<div class='manualViewBox_close' onclick='manualViewBox_close()'><img src='img/close32x32.png'></div>
</div>






<script src="js/Helper.js"></script>
<script src="js/PleaseWait.js"></script>
<script src="js/DataOra.js"></script>
<script src="js/DA3.js"></script>
<script src="js/GUIInfo.js"></script>
<script src="js/UI.js"></script>
<script src="js/UIOption.js"></script>
<script src="js/UINumberArrow.js"></script>
<script src="js/UIButtonSel.js"></script>
<script src="js/UITime24.js"></script>
<script src="js/UISelect.js"></script>
<script src="js/StartupOperation.js"></script>
<script src="js/keyboard.js"></script>
<script src="js/Task_JP.js"></script> <!-- questo viene automaticamente sostituito da Task_CUR_LANG.js quando si lancia il prg di traduzione -->



<script id="rheaBootstrapTag" src="js/rheaBootstrap.js" data-ses-clear="1"></script>
<script language="javascript">
var LIMITE_MIN_TEMPERATURA = 75;
var da3 = null;
var guiInfo = null;
var currentPageID="";
var currentCPUStatusID = -1;
var operTuningSpeedMilkPump = "";
var isMilkerAlive = 0;
var timeNowMSec = 0;
var manualFolderName = "";

var ui = null;
var uiStandAloneNum = null;
var uiStandAloneCalbMilkPumpNum = null;
var uiStandAloneOptionGrinderCleaning1or2 = null;
var uiStandAloneVarigringTargetPos = null;

var voidTask = new TaskVoid();
var taskCalibMilkPump = new TaskCalibMilkPump();		//@TP - #1885
var taskCalibMotor = new TaskCalibMotor();
var currentTask = voidTask;

var menuMode = 0;	//0=default, 1=CLOUD

function onRheaBootstrapFinished()
{
	
	pleaseWait_setup();
	
	rhea.onEvent_cpuMessage = 	function(msg, importanceLevel)	 	{ currentTask.onEvent_cpuMessage(msg, importanceLevel); }
	rhea.onEvent_cpuStatus  = 	function(statusID, statusStr, flag16)
								{		
									switch ("JP")
									{
									case "DE":
										switch(parseInt(statusID))
										{
										case 20: statusStr ="BRÜHER REINIGEN"; break; //BREWER CLEANING
										}									
										break;
									}
									//se il milker è collegato, abilito i suoi menu, e viceversa
									if (isMilkerAlive)
									{
										if ((flag16 & 0x04) == 0)
										{
											isMilkerAlive = 0;
											rheaAddClassToElem(rheaGetElemByID("pageCleaning_btnCleanMilker"), "UIdisabled");
											rheaAddClassToElem(rheaGetElemByID("pageCleaning_btnDescalingMilker"), "UIdisabled");
											rheaSetDivHTMLByName("pageMilker_status", "接続されいるか無効になっています");
											rheaSetDivHTMLByName("pageMilker_ver", "??");
										}
									}
									else
									{
										if ((flag16 & 0x04) != 0)
										{
											isMilkerAlive = 1;
											rheaRemoveClassToElem(rheaGetElemByID("pageCleaning_btnCleanMilker"), "UIdisabled");
											rheaRemoveClassToElem(rheaGetElemByID("pageCleaning_btnDescalingMilker"), "UIdisabled");											
											rheaSetDivHTMLByName("pageMilker_status", "有効");

											//chiedo versione del milker
											rhea.ajax ("milkver", "").then( function(result)
											{
												rheaSetDivHTMLByName("pageMilker_ver", result);
											})
											.catch( function(result)
											{
												rheaSetDivHTMLByName("pageMilker_ver", "??");
											});		
											
										}
									}
									
									
									currentCPUStatusID=statusID; 
									currentTask.onEvent_cpuStatus(statusID, statusStr, flag16); 
								}
	
	rhea.onEvent_creditUpdated = function()	
	{ 
	}	
	
	dataOra_setup();
	no_DYN_ENERGY_SAVE_setup();
	
	ui = new UI ("divPage");
	ui.setupStandaloneButton("bntBack");
	ui.setupStandaloneButton("btnSave");
	ui.setupStandaloneButton("bntTestSelection");
	uiStandAloneNum = ui.setupStandaloneNumber("pagePleaseWait_calibration_num");
	uiStandAloneVarigringTargetPos = ui.setupStandaloneNumber("pagePleaseWait_calibration_1_vg_target");
	ui.setupStandaloneButton("pagePleaseWait_calibration_1_vg_set");
	ui.setupStandaloneButton("pagePleaseWait_calibration_1_grind");
	ui.setupStandaloneButton("pagePleaseWait_calibration_2_runMotor");
	uiStandAloneOptionGrinderCleaning1or2 = ui.setupStandaloneUIOption("pagePleaseWait_grinderCleaning_1or2");
	
	uiStandAloneCalbMilkPumpNum = ui.setupStandaloneNumber("pagePleaseWait_calibMilkPump_num");		//@TP - #1885
	ui.setupStandaloneButton("pagePleaseWait_calibMilkPump_1_water");					//@TP - #1885
	
	
	pleaseWait_show();
	pleaseWait_header_setTextL("お待ちください ...");
	pleaseWait_freeText_show();

	//scarica il da3, carica guiInfo... in generale fa tutte quelle operazioni che sono necessarie prima di poter visualizzare il main menu
	startupOperation();
}

function header_setText(s)				{ s=s.replace(/<br>/, "&nbsp;"); rheaSetDivHTMLByName("divHeaderC", s); }

//***************************************************************************
function gotoSpecialURL (url)
{
	console.log ("gotoSpecialURL(" +url +")");
    rhea.ajax ("browserURLChange", {"url":url}).then( function(result)
    {
        console.log ("OK");
        window.location = url;
    })
    .catch( function(result)
    {
        window.location = url;
    });        
}

function gotoHMI()                        
{ 
    gotoSpecialURL("gotoHMI.html");
    //window.location = "gotoHMI.html"; 
}

/***************************************************************************
 *
 * show page
 *	ritorna != 0 se è la prima volta che questa finestra viene visualizzata
 */
function showPage  (pageID, pageTitle, bShowBtnBack, bShowBtnSave)				{ return showPageEx(pageID, pageTitle, bShowBtnBack, bShowBtnSave,0); }
function showPageEx(pageID, pageTitle, bShowBtnBack, bShowBtnSave, da3Offset)	
{ 
	currentPageID = pageID; 
	var win = ui.getWindowByID(currentPageID); 
	var ret = win.firstTimeShow; 
	ui.hideAllExcept(currentPageID); 
	rheaHideElem(rheaGetElemByID("divCurLang"));
	win.loadFromDA3(da3, da3Offset);
	rhea.requestGPUEvent(RHEA_EVENT_CPU_STATUS);
	
	pleaseWait_hide();
	header_setText (pageTitle);
	btnBack_setCallback("btnBack_defaultCallback();");
	btnSave_setCallback("btnSave_defaultCallback();");
	if (bShowBtnBack!=0) btnBack_show(); else btnBack_hide();
	if (bShowBtnSave!=0) btnSave_show(); else btnSave_hide();
	return ret;
}


/***************************************************************************
 *
 * bottoni back / save
 */
var btn_save_callback = null;
var btn_back_callback = null;
function btnSave_show()								{ rheaSetDisplayMode(rheaGetElemByID("btnSave"), "table"); }
function btnSave_hide()								{ rheaHideElem(rheaGetElemByID("btnSave")); }
function btnSave_setCallback (fnToCallWhenFinished)	{ btn_save_callback=fnToCallWhenFinished; }
function btnSave_onClick()							{ eval(btn_save_callback); }
function btnSave_defaultCallback()					{ save( function() { btnBack_onClick();} ); }

function btnBack_show() 							{ rheaSetDisplayMode(rheaGetElemByID("bntBack"), "table"); }
function btnBack_hide() 							{ rheaHideElem(rheaGetElemByID("bntBack")); rheaHideElem(rheaGetElemByID("bntTestSelection")); }
function btnBack_setCallback (fnToCallWhenFinished)	{ btn_back_callback=fnToCallWhenFinished; }
function btnBack_onClick ()							{ eval(btn_back_callback); }
function btnBack_defaultCallback()					{ if (currentTask != voidTask) currentTask = voidTask; pageMainMenu_show(); }

function btnTestSelection_show()					{ rheaShowElem(rheaGetElemByID("bntTestSelection")); }
function btnTestSelection_hide()					{ rheaHideElem(rheaGetElemByID("bntTestSelection")); }


/***************************************************************************
 *
 * save
 * se ci sono state modifiche al da3, le salva e le trasmette a CPU. Al termine, chiama la fn [fnToCallWhenFinished]
 */
var save_fnToCallWhenFinished = "";
function save (fnToCallWhenFinished)
{
	save_fnToCallWhenFinished = fnToCallWhenFinished;
	
	ui.getWindowByID(currentPageID).saveToDA3(da3); 
	var blockList = da3.compare();
	var nBlocchi = blockList.length;
	if (nBlocchi > 0)
	{
		//ci sono dei blocchi da3 che sono stati modificati
		pleaseWait_show();
		pleaseWait_freeText_setText("データファイルの保存中、お待ち下さい。...<br>");
		pleaseWait_freeText_show();
		save_storeDA3Block_step (1, nBlocchi, blockList);
	}
	else
		save_onFinished();
}

function save_storeDA3Block_step (uno_di, nBlocchi, blockList)
{
	console.log ("DA3 save " +uno_di +" di " +nBlocchi);
	var blockNum = blockList[uno_di-1];
	pleaseWait_freeText_appendText (uno_di +"/" +nBlocchi +"&nbsp;&nbsp;&nbsp;block " +blockNum +"... ");
			
	da3.storeBlock (uno_di, nBlocchi, blockNum).then (function(result)
	{
		console.log ("- block " +blockNum);
		pleaseWait_freeText_appendText (result +"<br>");
		
		if (result != "OK")
		{
			setTimeout ( function() { save_storeDA3Block_step (uno_di, nBlocchi, blockList); }, 400 );
			return;
		}
		
		
		da3.copyBlockToOriginal(blockNum);
		if (uno_di >= nBlocchi)
		{
			setTimeout ( function() { save_onFinished(); }, 100);
			return;
		}
		
		uno_di++;
		setTimeout ( function() { save_storeDA3Block_step (uno_di, nBlocchi, blockList); }, 100);
	})
	.catch( function(result)
	{
		setTimeout ( function() { save_storeDA3Block_step (uno_di, nBlocchi, blockList); }, 400 );
	});		
}

function save_onFinished() 	{  save_fnToCallWhenFinished.call(); }


/***************************************************************************
 *
 * menu linguaggio
 * 
 */
function menuLang_show(bShow)
{
	var e = rheaGetElemByID("divMenuLang");
	if (bShow)
		rheaShowElem(e);
	else
		rheaHideElem(e);
}

function menuLang_onUserSelected(iso)
{
	var targetUrl = "index_" +iso +".html";
	rhea.ajax ("setLastUsedLangPrgMenu", { "lang":iso}).then( function(result)
	{
		window.location = targetUrl;
	})
	.catch( function(result)
	{
		window.location = targetUrl;
	});	
}

/***************************************************************************
 *
 * pin code
 *
 */
var pagePinCode_currentPin;
var pagePinCode_callback = null;
function pagePinCode_doShowAndTrapOnEnd (callbackOnEnd)
{
	pagePinCode_currentPin = "";
	pagePinCode_callback = callbackOnEnd;
	rheaSetElemHTML (rheaGetElemByID("pagePinCodeDisplay"), "");
	rheaShowElem(rheaGetElemByID("pagePinCode"));
}

function pagePinCode_hide()						{ rheaHideElem (rheaGetElemByID("pagePinCode_alert1")); rheaHideElem(rheaGetElemByID("pagePinCode")); }

function pagePinCode_onBtnPress (btnPressed)
{
	pagePinCode_currentPin += btnPressed.toString();
	//console.log ("curpin:" +pagePinCode_currentPin);
	
	var d = rheaGetElemByID("pagePinCodeDisplay");
	if (pagePinCode_currentPin.length >= 3)
	{
		rheaSetElemHTML (d, "***");
		pagePinCode_callback (pagePinCode_currentPin);
	}
	else
	{
		var maskedPin = "";
		for (var i=0; i<pagePinCode_currentPin.length; i++)
			maskedPin += "*";
		rheaSetElemHTML (d, maskedPin);
	}
}

var pagePinCode_alreadyAsked = 0; 
var pagePinCode_maxNumTry;
function pagePinCode_askPinCodeForEnteringProgMenu()
{
	if (pagePinCode_alreadyAsked || da3.isProgMenuPinCodeEmpy())
	{
		pagePinCode_alreadyAsked=1;
		return;
	}
	pagePinCode_maxNumTry = 3;
	pagePinCode_doShowAndTrapOnEnd (pagePinCode_askPinCodeForEnteringProgMenu_onEnd);
}

function pagePinCode_askPinCodeForEnteringProgMenu_onEnd(userEnteredPIN)
{
	if (da3.validateProgMenuPinCode(userEnteredPIN))
	{
		pagePinCode_alreadyAsked = 1;
		pagePinCode_hide();
		setTimeout (pageMainMenu_show(), 10);
	}
	else
	{
		pagePinCode_maxNumTry--;
		if (pagePinCode_maxNumTry <= 0)
			gotoHMI();
		else
			pagePinCode_doShowAndTrapOnEnd (pagePinCode_askPinCodeForEnteringProgMenu_onEnd);
	}
}


/***************************************************************************
 *
 * are you sure
 *
 */
var areYouSure_callbackYES = null;
function areYouSureYouWishToLaunchTheChosenOperation (callbackYES)
{
	areYouSure_callbackYES = callbackYES;
	rheaShowElem(rheaGetElemByID("divAreYouSure"));
}

function areYouSure_onBtnYES()
{
	rheaHideElem(rheaGetElemByID("divAreYouSure"));
	setTimeout (areYouSure_callbackYES, 10);
}

function areYouSure_onBtnNO()
{
	rheaHideElem(rheaGetElemByID("divAreYouSure"));
}

/***************************************************************************
 *
 * are you sure
 *
 */
var divLavSanMilkerIndux_callbackYES = null;
function lavSanitarioMilkerIndux (callbackYES)
{
	divLavSanMilkerIndux_callbackYES = callbackYES;
	rheaShowElem(rheaGetElemByID("divLavSanMilkerIndux"));
}

function divLavSanMilkerIndux_onBtnPressed(whichBtn)
{
	rheaHideElem(rheaGetElemByID("divLavSanMilkerIndux"));
	setTimeout (function() {divLavSanMilkerIndux_callbackYES(parseInt(whichBtn)); }, 10);
}


/***************************************************************************
 *
 * manuale
 *
 */
function manualViewBox_show()
{
	rheaShowElem(rheaGetElemByID("manualViewBox"));
	var f = document.getElementById("manualViewBoxFrame");
	f.src = "../../last_installed/manual/" +manualFolderName +"/index.html";
}
function manualViewBox_close()		{ rheaHideElem(rheaGetElemByID("manualViewBox")); }



function no_DYN_ENERGY_SAVE_setup()
{
	//invia periodicamente a CPU il comando di "esci da DYN_EN_SAVE" in modo che
	//CPU non vada mai in quello stato fintanto che siamo in programmazione
	console.log ("no_DYN_ENERGY_SAVE");
	rhea.ajax ("GUINotify", { "p0":1000}).then( function(result)
	{
		setTimeout ( function() {no_DYN_ENERGY_SAVE_setup();}, 55000);
	})
	.catch( function(result)
	{
		setTimeout ( function() { no_DYN_ENERGY_SAVE_setup();}, 55000);
	})	
}

/***************************************************************************
 *
 * pageMainMenu
 *
 */
function pageMainMenu_show()
{
	pagePinCode_askPinCodeForEnteringProgMenu();
	var title = "<div style='margin-left:140px'><center><img  src='img/iconHome.png'> プログラミングメニュー</center></div>";
	showPage("pageMainMenu", title, 0, 0);
	rheaShowElem(rheaGetElemByID("divCurLang"));
}


/***************************************************************************
 *
 * pageGrinderCleaning
 *
 */
function pageGrinderCleaning_show()
{
	if (showPage("pageGrinderCleaning", "グラインダークリーニング", 0, 0))
	{
		//è la prima volta che visualizziamo la pagina
		
		var opzioniPerMacine = "1|グラインダー 1|2|グラインダー 2";
		for (var i=2; i<da3.getNumMacine(); i++)
			opzioniPerMacine += "|" +(i+1) +"|グラインダー " +(i+1);
		uiStandAloneOptionGrinderCleaning1or2.changeOptions (opzioniPerMacine);
		uiStandAloneOptionGrinderCleaning1or2.selectOptionByIndex(0);
	}
	
	currentTask = new TaskGrinderClean();
	currentTask.step1();
}
	
function pageGrinderCleaning_goBack()			
{ 
	rheaHideElem(rheaGetElemByID("pagePleaseWait_grinderCleaning"));
	//btnBack_defaultCallback(); 
	currentTask = voidTask;
	pageCleaning_show();
}



/***************************************************************************
 *
 * pageMaintenance
 *
 */
var pageMaintenance_secretBtnCounter = 0;
var pageMaintenance_secretBtnLastTimeClickedMSec=0;
function pageMaintenance_show()
{
	if (showPage("pageMaintenance", "メンテナンス", 1, 1))
	{
		var win = ui.getWindowByID("pageMaintenance");
	
		//è la prima volta che visualizziamo la pagina
		if (da3.isInstant())
		{
			rheaHideElem(rheaGetElemByID("pageMaintenance_rowDis"));
			rheaHideElem(rheaGetElemByID("pageMaintenance_decCofBrew"));
			rheaHideElem(rheaGetElemByID("pageMaintenance_decCofGround"));
		}
		
		var node = document.getElementById("pageMaintenance_td_labVoltage");		
		node.addEventListener("mousedown", function (ev)
		{
			var timeNowMSec = ev.timeStamp;
			if (timeNowMSec - pageMaintenance_secretBtnLastTimeClickedMSec > 1000)
				pageMaintenance_secretBtnCounter = 0;
			pageMaintenance_secretBtnLastTimeClickedMSec = timeNowMSec;
			pageMaintenance_secretBtnCounter++;
			console.log ("pageMaintenance_secretBtnCounter[" +pageMaintenance_secretBtnCounter +"]");
			if (pageMaintenance_secretBtnCounter >= 6)
			{
				pageMaintenance_secretBtnCounter=0;
				setTimeout (function() {pageMiscellaneous_oldProgMenu();}, 100);
			}
		}, 
		true);
		
		//l'opzione per il btn "reset ground button" le memorizzo in un solo byte
		//i 2 bit MSB li uso per "pageMaintenance_decCofGround_opt", gli altri 6 bit per "pageMaintenance_decCofGround_timeout"
		var b = da3.read8(DA3_POSIZIONE_OPZIONE_BTN_RESET_COUNTER);
		var o = win.getChildByID("pageMaintenance_decCofGround_opt");
		switch ( (b >> 6) )
		{
		default:
		case 0:	o.selectOptionByValue(0); break;
		case 1:	o.selectOptionByValue(1); break;
		case 2:	o.selectOptionByValue(2); break;
		}
		
		win.getChildByID("pageMaintenance_decCofGround_timeout").setValue( (b & 0x3F) );
	}
	btnSave_setCallback ("pageMaintenance_onBtnSave()");

	pageMaintenance_getDecountersValues();		
	pageMaintenance_refreshOFFList(0);
	pageMaintenance_onSelector();
	pageMaintenance_onOptionBtnResetCG();
	currentTask = new TaskMaintenance();
}

function pageMaintenance_onBtnSave()
{
	var b = 0;
	
	if (!da3.isInstant())
	{
		var win = ui.getWindowByID("pageMaintenance");
		var o = win.getChildByID("pageMaintenance_13_cap");
		if (o.getValue() > 0)
		{
			var opt = parseInt (win.getChildByID("pageMaintenance_decCofGround_opt").getSelectedOptionValue());
			if (opt == 2)
			{
				b = parseInt (win.getChildByID("pageMaintenance_decCofGround_timeout").getValue()) & 0x3F;
				b |= (opt << 6);
			}
			else
			{
				b = (opt << 6);
			}
		}
	}

	da3.write8(DA3_POSIZIONE_OPZIONE_BTN_RESET_COUNTER, b);
	btnSave_defaultCallback();
}

function pageMaintenance_onOptionBtnResetCG()
{
	var bShow2 = 0;
	var bShow3 = 0;
	
	if (!da3.isInstant())
	{
		var win = ui.getWindowByID("pageMaintenance");
		var o = win.getChildByID("pageMaintenance_13_cap");
		if (o.getValue() > 0)
		{
			bShow2 = 1;
			
			o = win.getChildByID("pageMaintenance_decCofGround_opt");
			if (2 == parseInt(o.getSelectedOptionValue()))
				bShow3 = 1;
		}
	}
	
	
	if (bShow2)
		rheaShowElem_TR (rheaGetElemByID("pageMaintenance_decCofGround_r2"));
	else
		rheaHideElem (rheaGetElemByID("pageMaintenance_decCofGround_r2"));

	if (bShow3)
		rheaShowElem_TR (rheaGetElemByID("pageMaintenance_decCofGround_r3"));
	else
		rheaHideElem (rheaGetElemByID("pageMaintenance_decCofGround_r3"));
		
	win.adjustScrollBar();
}

function pageMaintenance_onSelector()
{
	var elemGS = rheaGetElemByID("pageMaintenance_gs");
	var elemINST = rheaGetElemByID("pageMaintenance_inst");
	var elemOFF = rheaGetElemByID("pageMaintenance_off");
	rheaHideElem(elemGS);
	rheaHideElem(elemINST);
	rheaHideElem(elemOFF);
	
	var win = ui.getWindowByID("pageMaintenance");
	switch (parseInt(win.getChildByID("pageMaintenance_selector").getSelectedOptionValue()))
	{
		case 0: rheaShowElem(elemGS); break;
		case 1: rheaShowElem(elemINST); break;
		case 2: rheaShowElem(elemOFF); break;
	}
	win.showHideScrollBar();
}


var pageMaintenance_offListHTML="";
function pageMaintenance_refreshOFFList(startIndex)
{
	if (startIndex == 0)
	{
		pageMaintenance_offListHTML="";
		rheaSetDivHTMLByName("pageMaintenance_off_content", "<center><img src='img/animationRound.gif'></center>");
	}

	rhea.ajax ("getOFFList", { "startIndex":startIndex}).then( function(result)
	{
		var data = JSON.parse(result);
		
		if (startIndex == 0)
		{
			pageMaintenance_offListHTML = "<table class='dataAudit' align='center' width='80%'>"
					+"<tr valign='middle'>"
					+"	<th>DATE yyyy/mm/dd</td>"
					+"	<th>TIME</td>"
					+"	<th>OFF CODE</td>"
					+"</tr>";
		}
			
		var numOffs = data.yyyy.length;
		for (var i=0; i<numOffs; i++)
		{
			//la CPU per errore potrebbe mandare degli OFF con data 2001/01/01 alle 01:01 codice:1
			//Questi OFF li filtro e non li mostro
			if (data.yyyy[i]==2001 && data.mm[i]==1 && data.dd[i]==1 && data.hh[i]==1 && data.min[i]==1)
				continue;
			var rowCss="";
			pageMaintenance_offListHTML += "<tr valign='middle'" +rowCss +">"
					+"<td>" +data.yyyy[i] +"/" +data.mm[i] +"/" +data.dd[i] +"</td>"
					+"<td>" +data.hh[i] +":" +data.min[i] +"</td>"
					+"<td>" +data.codice[i] +data.tipo[i] +"</td>"
					"+</tr>";
		}
		
		if (data.nextIndex == 0)
		{
			pageMaintenance_offListHTML += "</table>";
			var d = rheaGetElemByID("pageMaintenance_off_content");
			rheaSetElemHTML(d, pageMaintenance_offListHTML);
			
			win = ui.getWindowByID("pageMaintenance");
			win.showHideScrollBar();
		}
		else
			setTimeout (function(){ pageMaintenance_refreshOFFList(data.nextIndex); }, 200);
	})
	.catch( function(result)
	{
		//console.log ("ERROR");
		console.log (result);
	});
}

function pageMaintenance_formatHTMLForTemperature(jsonObj)
{
	var html = "現在の温度: ";
	if (da3.isInstant())
	{
		html += "boiler=[" +jsonObj.tbol +"&deg;] ";
	}
	else
	{
		if (da3.isInduzione())
		{
			html += "heater=[" +jsonObj.tcam +"&deg;] &nbsp;&nbsp;&nbsp;&nbsp;";
			html += "milker=[" +jsonObj.tcap +"&deg;]";
		}
		else
		{
			html += "espresso=[" +jsonObj.tbol +"&deg;] &nbsp;&nbsp;&nbsp;&nbsp;";
			html += "heater=[" +jsonObj.tcam +"&deg;] &nbsp;&nbsp;&nbsp;&nbsp;";
			html += "milker=[" +jsonObj.tcap +"&deg;]";
		}
	}	
	return html;	
}

function pageMaintenance_resetDec(iDecounter)
{
	//per prima cosa devo salvare eventuali modifiche
	save( function(){ pageMaintenance_reset_afterSave(iDecounter); } );
}
function pageMaintenance_reset_afterSave(iDecounter)
{
	var currentCapacityID = "pageMaintenance_" +iDecounter +"_cap";
	var decValue = parseInt(ui.getWindowByID("pageMaintenance").getChildByID(currentCapacityID).getValue());
		
	if (iDecounter == 15)
	{
		//il valore "vero" sarebbe decValue * 1000, ma CPU non accetta numeri maggiori di 0xffff quindi lo vuole
		//indicato come decValue * 100
		decValue*=100;
	}
	
	//invio il comando di set alla SMU
	pleaseWait_show();
	rhea.ajax ("setDecounter", { "d":iDecounter, "v":decValue}).then( function(result)
	{
		//chiedo i decontatori alla SMU
		pageMaintenance_getDecountersValues();
	})
	.catch( function(result)
	{
		pleaseWait_hide();
	});
}


function pageMaintenance_getDecountersValues()
{
	//recupera il valore attuale dei decounter
	rhea.ajax ("getAllDecounters", "").then( function(result)
	{
		pageMaintenance_updateDecounterCurrentValueFromString(result);
		pleaseWait_hide();
	})
	.catch( function(result)
	{
		pleaseWait_hide();
	});		
}

function pageMaintenance_updateDecounterCurrentValueFromString(s)
{
	//la stringa s include 10 decounter prodotti, decounter water filter, decounter coffee brewer, decounter coffee ground, blocking_counter
	//A partire da 2021-05-10 include anche il decounter maintenance
	var e = s.split(",");
	for (var i=10; i<13; i++)
	{
		var iDecounter = i+1;
		var currentValueID = "pageMaintenance_" +iDecounter;
		var v = e[i];
		
		var len = 4;
		if (i == 10)
			len = 5;
		while (v.length < len)
			v = "0" +v;
		rheaSetDivHTMLByName(currentValueID, v);
	}
	
	//se esiste il dec maintenace...
	if (e.length >= 14)
	{
		var v = e[14];
		var len = 3;
		while (v.length < len)
			v = "0" +v;
		rheaSetDivHTMLByName("pageMaintenance_15", v);
	}
}

function pageMaintenance_disinstall()
{
	pleaseWait_show();
	currentTask = new TaskDisintall();
}

function pageMaintenance_disinstall_onAbort()
{
	currentTask = voidTask;
}

/***************************************************************************
 *
 * pageCleaning
 *
 */
function pageCleaning_show()
{
	var w = ui.getWindowByID("pageCleaning");

	if (showPage("pageCleaning", "クリーニング/ <br>リンス", 1 ,1))
	{
		//è la prima volta che visualizziamo la pagina
		if (!da3.doesSupportExtModule())			//#4660
		{
			w.getChildByID("pageCleaning_btnCleaningSyrup").hide();
		}
		
		if (da3.isInstant())
		{
			w.getChildByID("pageCleaning_btnCleanHC").hide();
			w.getChildByID("pageCleaning_btnCleanGrinder").hide();
			w.getChildByID("pageCleaning_btnDescaling").hide();
			w.getChildByID("pageCleaning_btnCleanMilker").hide();
			w.getChildByID("pageCleaning_btnDescalingMilker").hide();


			if (da3.doesSupportExtModule())
			{
				w.getChildByID("pageCleaning_btnClean1_ext").setCaption("リンス<br>(MIXER 1)");
				w.getChildByID("pageCleaning_btnClean2_ext").setCaption("リンス<br>(MIXER 2)");
				w.getChildByID("pageCleaning_btnClean3_ext").setCaption("リンス<br>(MIXER 3)");
				w.getChildByID("pageCleaning_btnClean4_ext").setCaption("リンス<br>(MIXER 4)");
				w.getChildByID("pageCleaning_btnClean5_ext").setCaption("リンス<br>(MIXER 5)");
				w.getChildByID("pageCleaning_btnClean6_ext").setCaption("リンス<br>(MIXER 6)");
			}
			else
			{
				w.getChildByID("pageCleaning_btnClean1").setCaption("リンス<br>(MIXER 1)");
				w.getChildByID("pageCleaning_btnClean2").setCaption("リンス<br>(MIXER 2)");
				w.getChildByID("pageCleaning_btnClean3").setCaption("リンス<br>(MIXER 3)");
				w.getChildByID("pageCleaning_btnClean4").setCaption("リンス<br>(MIXER 4)");
			}
		}
		else
		{
			//macchine espresso
			if (!da3.isGruppoVariflex())
				w.getChildByID("pageCleaning_btnDescaling").hide();

			
			if (da3.isMachine_Brewmatic4Macine())
			{
				rheaHideElem(rheaGetElemByID("externModuleNo"));
				rheaHideElem(rheaGetElemByID("externModuleSi"));
			}
			else
			{
				if (da3.doesSupportExtModule())
				{
					w.getChildByID("pageCleaning_btnClean1_ext").setCaption("リンス<br>(BREWER)");
					w.getChildByID("pageCleaning_btnClean2_ext").setCaption("リンス<br>(MIXER 1)");
					w.getChildByID("pageCleaning_btnClean3_ext").setCaption("リンス<br>(MIXER 2)");
					w.getChildByID("pageCleaning_btnClean4_ext").setCaption("リンス<br>(MIXER 3)");
					w.getChildByID("pageCleaning_btnClean5_ext").setCaption("リンス<br>(MIXER 5)");
					w.getChildByID("pageCleaning_btnClean6_ext").setCaption("リンス<br>(MIXER 6)");
				}
				else
				{
					w.getChildByID("pageCleaning_btnClean1").setCaption("リンス<br>(BREWER)");
					w.getChildByID("pageCleaning_btnClean2").setCaption("リンス<br>(MIXER 1)");
					w.getChildByID("pageCleaning_btnClean3").setCaption("リンス<br>(MIXER 2)");
					w.getChildByID("pageCleaning_btnClean4").setCaption("リンス<br>(MIXER 3)");
				}
			}
		}
		
		//grinder cleaning e descaling, solo per NST o RVI senza TMON (FUJI), mentre
		//c'e' sempre in caso di STM32
		var bShowDescalingAndGrinderCleaning = 0;
		if (da3.isCPUArch_STM32() || da3.isCustomer_NESTLE())
			bShowDescalingAndGrinderCleaning = 1;
		else if (da3.isCustomer_RHEA() && !da3.hasCapab_TMON())
			bShowDescalingAndGrinderCleaning = 1;
			
		if (!bShowDescalingAndGrinderCleaning)
		{
			rheaHideElem(rheaGetElemByID("pageCleaning_btnCleanGrinder"));
			rheaHideElem(rheaGetElemByID("pageCleaning_btnDescaling"));
			rheaHideElem(rheaGetElemByID("pageCleaning_btnDescalingMilker"));
		}		
		
		//2022-08-01: tablet dissolve: nestle non la vuole vedere ma stiamo per compilare
		//una rhTT1 in versione NST che deve far vedere sta cosa.
		//E' soluzione temporanea
		if (da3.isMotherboardVariscite())
		{
			if (da3.isCustomer_NESTLE())
				rheaHideElem(rheaGetElemByID("pageCleaning_tabDissolveTable"));
		}
	}
	
	if (!da3.isMachine_Brewmatic4Macine())
	{
		if (da3.doesSupportExtModule()) 
		{
		    rheaShowElem(rheaGetElemByID("externModuleNo"));
			rheaHideElem(rheaGetElemByID("externModuleSi"));
		}
		else
		{
			rheaHideElem(rheaGetElemByID("externModuleNo"));
			rheaShowElem(rheaGetElemByID("externModuleSi"));
		}
	}
				
	if (!da3.isInstant())
	{
		if (da3.isCappuccinatoreInduzione())
			w.getChildByID("pageCleaning_btnDescalingMilker").show();	
		else
			w.getChildByID("pageCleaning_btnDescalingMilker").hide();	
	}		
	//data e ora dell'ultimo lavaggio
	pageCleaning_updateMilkerInduxCleaningLastDate();
	

	if (bGotoHMIAfterBackOrSave==1)
		btnBack_setCallback ("gotoHMI()");	
}

function pageCleaning_updateMilkerInduxCleaningLastDate()
{
console.log ("pageCleaning_updateMilkerInduxCleaningLastDate");
	if (isMilkerAlive)
	{
		rhea.ajax ("getMilkerInfo", "").then( function(result)
		{
			var data = JSON.parse(result);
			var msg = "ミルククリーニング　：前回{0}　次回{1}".translateLang ("<b>"+data.last+"</b>", "<b>"+data.next+"</b>");
			var o = rheaGetElemByID("pageCleaning_milkerInfo");
			rheaSetElemHTML(o, msg);
			rheaShowElem(o);
		})
		.catch( function(result)
		{
			rheaHideElem(rheaGetElemByID("pageCleaning_milkerInfo"));
		});		
	}
	else
	{
		rheaHideElem(rheaGetElemByID("pageCleaning_milkerInfo"));
	}
}

function pageCleaning_startLavaggioCappIndux(what)
{
	//caso speciale di capp indux. Devo presentare una prima schermata che chiede
	//se si vuole procedere con il detergente liquido o la pastiglia.
	//In base alla decisione, il lavaggio poi assume un comportamente differente
	lavSanitarioMilkerIndux(
		function onBtnPressed(whichBtn)
		{
			var lavaggioConLiquidoDetergente = 0;
			switch (parseInt(whichBtn))
			{
			default:
				if (bGotoHMIAfterLavaggio)
					gotoHMI();
				return;
				
			case 1:	//con pastiglia
				lavaggioConLiquidoDetergente = 0;
				break;
				
			case 2:	//con detergente liquido
				lavaggioConLiquidoDetergente = 1;
				break;
			}

			pleaseWait_show();
			rhea.requestGPUEvent(RHEA_EVENT_CPU_MESSAGE);
			currentTask = new TaskCleaning(what, da3.isEspresso());
			currentTask.lavaggioConLiquidoDetergente = lavaggioConLiquidoDetergente;
			rhea.requestGPUCleaning(parseInt(what));
		}
	);
}

function pageCleaning_action (what)
{
	if (163 == what)
	{
		//capp indux, lav san di test senza sensore conduc
		pagePinCode_maxNumTry = 3;
		rheaShowElem (rheaGetElemByID("pagePinCode_alert1"));
		pagePinCode_doShowAndTrapOnEnd (pageCleaning_action_pincode163_onFinish);
	}
	else
	{
		if (5 == what && da3.isCappuccinatoreInduzione())
		{
			pageCleaning_startLavaggioCappIndux(5);
		}
		else
		{
			areYouSureYouWishToLaunchTheChosenOperation(
				function YES()
				{
					pleaseWait_show();
					
					if (what == 8) //cleaning HC
						save( function(){ pageCleaning_startLavSanitario(8,1); } );
					else if (what==5) // milker
						pageCleaning_startLavSanitario(what,1);
					else
					{
						currentTask = new TaskCleaning(what, da3.isEspresso());
						rhea.requestGPUCleaning(parseInt(what));
					}
				}
			);
		}
	}
}

function pageCleaning_action_pincode163_onFinish(userEnteredPIN)
{
	if (PIN_CODE_FUSION3 == userEnteredPIN)
	{
		pagePinCode_hide();
		//pageCleaning_startLavSanitario(163,1);
		pageCleaning_startLavaggioCappIndux(163);
	}
	else
	{
		pagePinCode_maxNumTry--;
		if (pagePinCode_maxNumTry <= 0)
			pagePinCode_hide();
		else
			pagePinCode_doShowAndTrapOnEnd (pageCleaning_action_pincode163_onFinish);
	}
}

function pageCleaning_startLavSanitario (what, bSendRequestToGPU)
{
	pleaseWait_show();
	rhea.requestGPUEvent(RHEA_EVENT_CPU_MESSAGE);
	currentTask = new TaskCleaning(what, da3.isEspresso());
	if (bSendRequestToGPU)
		rhea.requestGPUCleaning(parseInt(what));
}

function pageCleaning_onFinished()
{
	if (currentTask.whichWash == 5)
	{
		//se ho terminato il lav san del cappuccinatore, chiedo alla CPU
		//il nuovo orario del prossimo lavaggio
		pageCleaning_updateMilkerInduxCleaningLastDate(); 
	}

	currentTask = voidTask;
	
	if (bGotoHMIAfterLavaggio)
	{
		gotoHMI();
		return;
	}
		
	pleaseWait_hide();
}

	
	
/***************************************************************************
 *
 * pageMiscellaneous
 *
 */
var pageMiscellaneous_fvhBefore = 0;
var pageMiscellaneous_numClickOnLabCPULang = 0;
function pageMiscellaneous_show()
{
	pageMiscellaneous_numClickOnLabCPULang = 0;
	var win = ui.getWindowByID("pageMiscellaneous");
	if (showPage("pageMiscellaneous", "その他", 1, 1))
	{
		//è la prima volta che visualizziamo la pagina
		var selOptions = "0|ゼネラルオプション|1|マシンID";
		if (!da3.isMachine_Brewmatic4Macine())
			selOptions += "|2|ミルク　ラテマキアート";
			
		if (da3.hasCapab_NO_PAYMENT_SYSTEM())
			rheaHideElem(rheaGetElemByID("pageMiscellaneous_r4"));
		else
			selOptions += "|3|FREEVEND";
			
		selOptions += "|4|ブロッキングカウンター";
		if (da3.isMachine_Brewmatic4Macine())
			selOptions +="|5|VIBRATION";
		var uiSelector = win.getChildByID("pageMiscellaneous_selector");
		uiSelector.changeOptions (selOptions);
		uiSelector.selectOptionByIndex(0);

		var opt = win.getChildByID("pageMiscellaneous_cpuLang");
		if (da3.hasCapab_MULTILANGUAGE())
			opt.changeOptions ("0|" +cpuLangName1 +"|1|MULTILANG");
		else
			opt.changeOptions ("0|" +cpuLangName1 +"|1|" +cpuLangName2);
		
		if (da3.isEspresso())
		{
			rheaHideElem (rheaGetElemByID("pageMiscellaneous_r1"));
			rheaHideElem (rheaGetElemByID("pageMiscellaneous_r2"));
		}
		else
		{
			rheaHideElem (rheaGetElemByID("pageMiscellaneous_fmilkTopping"));
		}
		if (da3.isGruppoMicro() || da3.isMachine_Brewmatic4Macine())
			rheaHideElem (rheaGetElemByID("pageMiscellaneous_fmilkTopping"));
		
		if (da3.isMachine_MultibonaInstant() || da3.isMachine_MinibonaInstant())
			rheaHideElem (rheaGetElemByID("pageMiscellaneous_r1"));
		
		if (da3.isMachine_BaristaSuprema())
			rheaHideElem (rheaGetElemByID("pageMiscellaneous_fv_r0"));
		
		
		var objDataAuditBefore = win.getChildByID("pageMiscellaneous_gs_auditBefore");
		var objFvHWKey = win.getChildByID("pageMiscellaneous_fvHwKey");
		if (da3.isInduzione())
		{
			//versione induzione
			objDataAuditBefore.da3Pos=7106;
			objFvHWKey.da3Pos=7104;
		}
		else
		{
			//versione bollitore
			objDataAuditBefore.da3Pos=7088
			objFvHWKey.da3Pos=7106;
		}

		objDataAuditBefore.loadFromDA3(da3);
		objFvHWKey.loadFromDA3(da3);
		
		win.showHideScrollBar();
	}
	btnSave_setCallback ("pageMiscellaneous_onBtnSave()");
	if (bGotoHMIAfterLavaggio==1)
		btnBack_setCallback ("gotoHMI()");	
	
	
	pageMiscellaneous_fv_refresh();
	pageMiscellaneous_blockingCounter_refresh();
	pageMiscellaneous_onSelector();
	pageMiscellaneous_setPINCode (da3.read16(7060));
	pageMiscellaneous_setQuickPINCode (da3.read16(8378));
	
	pageMiscellaneous_cpuLang_onChange();
}

function pageMiscellaneous_cpuLang_onChange()
{
	var win = ui.getWindowByID("pageMiscellaneous");

	if (da3.hasCapab_MULTILANGUAGE())
	{
		var langOpt = win.getChildByID("pageMiscellaneous_cpuLang");
		if (parseInt(langOpt.getSelectedOptionValue()) == 0)
			rheaHideElem(rheaGetElemByID("pageMiscellaneous_cpuLangML"));
		else
			rheaShowElem(rheaGetElemByID("pageMiscellaneous_cpuLangML"));
	}
	else
		rheaHideElem(rheaGetElemByID("pageMiscellaneous_cpuLangML"));
}

function pageMiscellaneous_onBtnSave()
{
	var menuProgPIN = document.getElementById("pageMiscellaneous_curPIN").innerHTML;
	da3.write16(7060, parseInt(menuProgPIN));
	
	var menuQuickPIN = document.getElementById("pageMiscellaneous_curQuickPIN").innerHTML;
	da3.write16(8378, parseInt(menuQuickPIN));

	btnSave_defaultCallback();
}

function  pageMiscellaneous_setPINCode(pin)
{
	pin = pin.toString();
	while (pin.length < 3)
		pin = "0" + pin;
	rheaSetElemHTML(rheaGetElemByID("pageMiscellaneous_curPIN"), pin);
}
function pageMiscellaneous_askForNewPINCode()							{ pagePinCode_doShowAndTrapOnEnd (pageMiscellaneous_askForNewPINCode_onEnd); }
function pageMiscellaneous_askForNewPINCode_onEnd(userEnteredPIN)		{ pageMiscellaneous_setPINCode (userEnteredPIN); pagePinCode_hide(); }

function  pageMiscellaneous_setQuickPINCode(pin)
{
	pin = pin.toString();
	while (pin.length < 3)
		pin = "0" + pin;
	rheaSetElemHTML(rheaGetElemByID("pageMiscellaneous_curQuickPIN"), pin);
}
function pageMiscellaneous_askForNewQuickPINCode()							{ pagePinCode_doShowAndTrapOnEnd (pageMiscellaneous_askForNewQuickPINCode_onEnd); }
function pageMiscellaneous_askForNewQuickPINCode_onEnd(userEnteredPIN)		{ pageMiscellaneous_setQuickPINCode (userEnteredPIN); pagePinCode_hide(); }



function pageMiscellaneous_blockingCounter_refresh()
{
	//valore attuale del blocking counter
	pleaseWait_show();
	rhea.ajax ("getAllDecounters", "").then( function(result)
	{
		var e = result.split(",");
		var v = e[13];
		while (v.length < 5)
			v = "0" +v;
		rheaSetDivHTMLByName("pageMiscellaneous_blockingCt_unblocked_curct", v);
		pleaseWait_hide();
	})
	.catch( function(result)
	{
		rheaSetDivHTMLByName("pageMiscellaneous_blockingCt_unblocked_curct", "?????");
		pleaseWait_hide();
	});	
}

function pageMiscellaneous_blockingCounter_set()
{
	//per prima cosa devo salvare eventuali modifiche
	save( function(){ pageMiscellaneous_blockingCounter_set_afterSave(); } );
}
function pageMiscellaneous_blockingCounter_set_afterSave()
{
	var counter = parseInt(ui.getWindowByID("pageMiscellaneous").getChildByID("pageMiscellaneous_blockingCt_newValue").getValue());
		
	//invio il comando di set alla SMU
	pleaseWait_show();
	rhea.ajax ("setDecounter", { "d":14, "v":counter}).then( function(result)
	{
		pageMiscellaneous_blockingCounter_refresh();
		
	})
	.catch( function(result)
	{
		console.log ("ERR: pageMiscellaneous_blockingCounter_set_afterSave()");
		pleaseWait_hide();
	});
}

function pageMiscellaneous_fv_refresh()
{
	var win = ui.getWindowByID("pageMiscellaneous");

	//data e ora di fine freevend
	var enddate_minute = da3.read8(8435);
	var enddate_hh = da3.read8(8436);
	var enddate_gg = da3.read8(8437);
	var enddate_mm = da3.read8(8438);
	var enddate_yy = 2000 + da3.read8(8439);
	var dataScadenza = new Date(enddate_yy, enddate_mm-1, enddate_gg, enddate_hh, enddate_minute, 0, 0);

	var dataNow = new Date(dataora_yy, dataora_mm-1, dataora_dd, dataora_hh, dataora_min, 0, 0);
	var minuteLeft = Math.floor ((dataScadenza - dataNow) / 60000);
	if (minuteLeft < 0 || minuteLeft >= 255*60)
	{
		//freevend non in corso
		rheaSetDisplayMode(rheaGetElemByID("pageMiscellaneous_fv_r1"), "table-row");
		rheaHideElem(rheaGetElemByID("pageMiscellaneous_fv_r2"));
		da3.freevendFasciaOraria_stopItNow();
	}
	else
	{
		//freevend in corso
		rheaHideElem(rheaGetElemByID("pageMiscellaneous_fv_r1"));
		rheaSetDisplayMode(rheaGetElemByID("pageMiscellaneous_fv_r2"), "table-row");

		if (enddate_mm <10) enddate_mm = "0" +enddate_mm;
		if (enddate_gg <10) enddate_gg = "0" +enddate_gg;
		if (enddate_hh <10) enddate_hh = "0" +enddate_hh;
		if (enddate_minute <10) enddate_minute = "0" +enddate_minute;
		rheaSetDivHTMLByName("pageMiscellaneous_fvDateEnd", "<i>Freevendはオンになります<br>" + enddate_yy +"/" +enddate_mm +"/" +enddate_gg +" " +enddate_hh +":" +enddate_minute);
	}
}

function pageMiscellaneous_startFVNow()
{
	var win = ui.getWindowByID("pageMiscellaneous");
	var h = parseInt(win.getChildByID("pageMiscellaneous_fvH").getValue());
	if (h < 1)
		return;
	
	pleaseWait_show();
	var dataNow = new Date(dataora_yy, dataora_mm-1, dataora_dd, dataora_hh, dataora_min, 0, 0);
	da3.freevendFasciaOraria_startNowAndLastForNHours(dataNow, h);
	save( function(){ pageMiscellaneous_stopFVNow_onFinish(); } );
}


function pageMiscellaneous_stopFVNow()
{
	pleaseWait_show();
	da3.freevendFasciaOraria_stopItNow();
	save( function(){ pageMiscellaneous_stopFVNow_onFinish(); } );
}

function pageMiscellaneous_stopFVNow_onFinish()
{
	//notifica la CPU di aggiornare il suo stato di freevend
	setTimeout ( function() { pageMiscellaneous_sendP15(); }, 1000);
}

function pageMiscellaneous_sendP15()
{
	var buffer = new Uint8Array(1);
	buffer[0] = 66;
	rhea.sendGPUCommand ("E", buffer, 0, 0);
	pageMiscellaneous_fv_refresh();
	pleaseWait_hide();
}

function pageMiscellaneous_oldProgMenu()		
{ 
	//window.location = "gotoLegacyMenu.html"; 
	gotoSpecialURL ("gotoLegacyMenu.html"); 
}

function  pageMiscellaneous_showPageFV()
{
	var win = ui.getWindowByID("pageMiscellaneous");
	var selector = win.getChildByID("pageMiscellaneous_selector");
	selector.selectOptionByValue(3);
	pageMiscellaneous_onSelector();
	rheaHideElem(rheaGetElemByID("pageMiscellaneous_selector"));
}

function  pageMiscellaneous_onSelector()
{
	var elemGS = rheaGetElemByID("pageMiscellaneous_gs");
	var elemMID = rheaGetElemByID("pageMiscellaneous_mid");
	var elemLM = rheaGetElemByID("pageMiscellaneous_lm");
	var elemFV = rheaGetElemByID("pageMiscellaneous_fv");
	var elemBCT = rheaGetElemByID("pageMiscellaneous_blockingCt");
	var elemAdvGrinder = rheaGetElemByID("pageMiscellaneous_advGrinder");
	
	rheaHideElem(elemGS);
	rheaHideElem(elemMID);
	rheaHideElem(elemLM);
	rheaHideElem(elemFV);
	rheaHideElem(elemBCT);
	rheaHideElem(elemAdvGrinder);
	
	var win = ui.getWindowByID("pageMiscellaneous");
	switch (parseInt(win.getChildByID("pageMiscellaneous_selector").getSelectedOptionValue()))
	{
		case 0: rheaShowElem(elemGS); break;
		case 1: rheaShowElem(elemMID); break;
		case 2: rheaShowElem(elemLM); break;
		case 3: rheaShowElem(elemFV); break;
		case 4: rheaShowElem(elemBCT); break;
		case 5: rheaShowElem(elemAdvGrinder); break;
	}
	win.showHideScrollBar();
}

function pageMiscellaneous_onPINCodeInserted()
{
	var win = ui.getWindowByID("pageMiscellaneous");

	var pinCode = parseInt(da3.read16(7404));
	if (pinCode==0)	
	{
		//la CPU impone il codice "123" nel caso in cui nel da3 sia memorizzato "000"
		pinCode=123;
		win.getChildByID("pageMiscellaneous_newpincode").setValue("123");
	}
		
		
	var pinCodeObj = win.getChildByID("pageMiscellaneous_pincode");
	if (parseInt(pinCodeObj.getValue()) != pinCode)
	{
		pinCodeObj.setValue("000");
		return;
	}


	rheaHideElem (rheaGetElemByID("pageMiscellaneous_blockingCt_pwd"));
	rheaShowElem (rheaGetElemByID("pageMiscellaneous_blockingCt_unblocked"));
	win.showHideScrollBar();
}


function pageMiscellaneous_onLabCPULangClicked()
{
	pageMiscellaneous_numClickOnLabCPULang++;
	if (pageMiscellaneous_numClickOnLabCPULang > 10)
	{
		pageMiscellaneous_numClickOnLabCPULang = 0;
		pageDebugLang_show();
	}	
}


/***************************************************************************
 *
 * pageProductQty
 *
 */
function pageProductQty_show()
{
	if (showPage("pageProductQty", "製品数量設定", 1,1))
	{
		//è la prima volta che visualizziamo la pagina
		pageProductQty_getDecounterValues();
	}
	pageProductQty_showDecounter();
	
	//aggiorno le unità di misura
	var win = ui.getWindowByID("pageProductQty");
	for (var i=0; i<da3.getNumProdotti(); i++)
	{
		var um = "sec";
		if (da3.isMotorCalibrated(i+1)) 
			um = "gr"; 

		win.getChildByID("pageProductQty_decCurCap_" +(i+1)).changeUM(um);
		win.getChildByID("pageProductQty_decCurWarn_" +(i+1)).changeUM(um);
	}	
	
	
	if (bGotoHMIAfterLavaggio==1)
		btnBack_setCallback ("gotoHMI()");
	
	//chiedo il valore attuale dei decontatori alla SMU
	pleaseWait_show();
	rhea.ajax ("getAllDecounters", "").then( function(result)
	{
		pageProductQty_updateDecounterCurrentValueFromString(result);
		pleaseWait_hide();
	})
	.catch( function(result)
	{
		pleaseWait_hide();
	});	
}

function pageProductQty_build()
{
	var nProdotti = da3.getNumProdotti();
	var da3Loc_decounter = 7334;
	var da3Loc_warning = da3Loc_decounter +2*nProdotti;
	var da3Loc_enable = da3Loc_warning +2*nProdotti;
	var html = "";
	
	var dataOption = "1|1";
	for (var i=2; i<=nProdotti; i++)
		dataOption += "|" +i +"|" +i;
		
	html = 	"<table border='0' width='100%'><tr valign='middle'>"
			+"	<td style='width:160px'><b>原料カウンター　容量設定</b></td>"
			+"	<td><div class='UIOptionSmall' id='pageProductQty_decSelector' data-option='" +dataOption +"' data-onclick='pageProductQty_showDecounter()'></div></td>"
			+"</tr></table><br>";
	
	for (var i=0; i<nProdotti; i++)
	{
		var num = (i+1);
		if (i<9) num = "0" +num;
		num = "#" +num;
		
		var pageID = "pageProductQty_page_" +(i+1);
		var currentValueID = "pageProductQty_decCurVal_" +(i+1);
		var currentCapacityID = "pageProductQty_decCurCap_" +(i+1);
		var currentWarningID = "pageProductQty_decCurWarn_" +(i+1);
		
		var currentDecountValue = "00000";
		
		html +=  "<div id='" +pageID +"' style='display:none'>"
				+"<table border='0' class='elenco'>"
				+"	<tr style='height:70px'>"
				+"		<td style='width:300px'>デカウンター #" +(i+1) +"<br>現在の値</td>"
				+"		<td style='width:400px'><span id='" +currentValueID +"' class='bigCaption25'>" +currentDecountValue +"</span></td>"
				+"		<td align='center'><div class='UIButton bigButton60 actionButton' data-caption='リセット' data-onclick='pageProductQty_reset(" +(i+1) +")'></div></td>"
				+"	</tr>"
				+"	<tr><td>キャニスター容量 注意域</td><td colspan='2'><div id='" +currentCapacityID +"' class='UINumber' data-numfigures='5' data-decimal='1' data-da3='" +da3Loc_decounter +"' data-max='60000' data-um='sec'></div></td></tr>"
				+"	<tr><td>警告</td><td colspan='2'><div id='" +currentWarningID +"' class='UINumber' data-numfigures='5' data-decimal='1' data-da3='" +da3Loc_warning +"' data-max='60000' data-um='sec'></div></td></tr>"
				+"	<tr style='border:0'><td>プロダクト停止の有効</td><td colspan='2'><div class='UIOption' data-option='1|はい|0|いいえ' data-da3='" +da3Loc_enable +"'></div></td></tr>"
				+"</table></div>";
		da3Loc_decounter+=2;
		da3Loc_warning+=2;
		da3Loc_enable+=2;
	}
	
	rheaSetDivHTMLByName("pageProductQty_content", html);
}

function pageProductQty_showDecounter()
{
	var opt = ui.getWindowByID("pageProductQty").getChildByID("pageProductQty_decSelector");
	var decSelected = opt.getSelectedOptionValue();
	
	var nProdotti = da3.getNumProdotti();
	for (var i=1; i<=nProdotti; i++)
	{
		var pageID = "pageProductQty_page_" +i;
		if (i == decSelected)
			rheaShowElem(rheaGetElemByID(pageID));
		else
			rheaHideElem(rheaGetElemByID(pageID));
	}
}

function pageProductQty_updateDecounterCurrentValueFromString(s)
{
	var e = s.split(",");
	for (var i=0; i<e.length; i++)
	{
		var iDecounter_1_10 = i+1;
		var currentValueID = "pageProductQty_decCurVal_" +iDecounter_1_10;
		
		var um = "sec";
		if (da3.isMotorCalibrated(iDecounter_1_10)) 
			um = "gr"; 		
		
		var v = e[i];
		while (v.length < 5)
			v = "0" +v;
		var s = v.substr(0,4) +"." +v.substr(4) +"<span style='font-size:0.4em'> " +um +"</span>";
		
		rheaSetDivHTMLByName(currentValueID, s);
	}
}

function pageProductQty_reset (iDecounter_1_10)
{
	//per prima cosa devo salvare eventuali modifiche
	save( function(){ pageProductQty_reset_afterSave(iDecounter_1_10); } );
}
function pageProductQty_reset_afterSave(iDecounter_1_10)
{
	var currentCapacityID = "pageProductQty_decCurCap_" +iDecounter_1_10;
	var decValue = parseInt(ui.getWindowByID("pageProductQty").getChildByID(currentCapacityID).getValue());
		
	//invio il comando di set alla SMU
	pleaseWait_show();
	rhea.ajax ("setDecounter", { "d":iDecounter_1_10, "v":decValue}).then( function(result)
	{
		//chiedo i decontatori alla SMU
		pageProductQty_getDecounterValues();
	})
	.catch( function(result)
	{
		pleaseWait_hide();
	});
}

function pageProductQty_getDecounterValues()
{
	rhea.ajax ("getAllDecounters", "").then( function(result)
	{
		pageProductQty_updateDecounterCurrentValueFromString(result);
		pleaseWait_hide();
	})
	.catch( function(result)
	{
		pleaseWait_hide();
	});		
}



/***************************************************************************
 *
 * pageMilker
 *
 */
var pageMilker_isPswTplBaristaInserita = 0;
function pageMilker_show()
{
	var win = ui.getWindowByID("pageMilker");
	if (showPage("pageMilker", "ミルカー", 1,1))
	{
		//è la prima volta che visualizziamo la pagina.
		rheaHideElem (rheaGetElemByID("pageMilker_row_tplBarista"));
		rheaHideElem (rheaGetElemByID("pageMilker_row_tplBaristaCold"));
		
		var uiSelModel = win.getChildByID("pageMilker_model");
		var options = "0|なし|1|負圧";
		if (da3.isInduzione())
			options += "|2|索引";
		uiSelModel.changeOptions (options);
		uiSelModel.selectOptionByValue (da3.read8(69));
	}
	
	btnSave_setCallback ("pageMilker_onBtnSave()");
	
	//se la temperatura del milker riportata nel DA3 è zero, allora il milker è disabled
	var yesNo = win.getChildByID("pageMilker_enabled");
	
	var temperatureOnDA3 = da3.read8(7618);
	console.log ("milker temperatura on DA3=[" +temperatureOnDA3 +"]");
	if (temperatureOnDA3 == 0)
		yesNo.selectOptionByValue(0);
	else
		yesNo.selectOptionByValue(1);
		
	pageMilker_onMilkerTypeChange();
	
	var msg = "AIR: " +win.getChildByID("pageMilker_row_tplBarista_air").getValue() +"% &nbsp;&nbsp;&nbsp; PUMP: " +win.getChildByID("pageMilker_row_tplBarista_pump").getValue() +"%";
	rheaSetElemHTML (rheaGetElemByID("pageMilker_row_tplBarista_readonly_values"), msg);
	
	msg = "AIR: " +win.getChildByID("pageMilker_row_tplBaristaCold_air").getValue() +"% &nbsp;&nbsp;&nbsp; PUMP: " +win.getChildByID("pageMilker_row_tplBaristaCold_pump").getValue() +"%";
	rheaSetElemHTML (rheaGetElemByID("pageMilker_row_tplBaristaCold_readonly_values"), msg);	
	
	pageMilker_onAutorinsingMode_changed();
}

function pageMilker_onEditBtn()
{
	pagePinCode_doShowAndTrapOnEnd (pageMilker_askPinCodeForTplBarista_onEnd);
}

function pageMilker_askPinCodeForTplBarista_onEnd(userEnteredPIN)
{
	if (userEnteredPIN=="333")
	{
		pageMilker_isPswTplBaristaInserita = 1;
		rheaHideElem (rheaGetElemByID("pageMilker_row_tplBarista_readonly"));
		rheaHideElem (rheaGetElemByID("pageMilker_row_tplBaristaCold_readonly"));
		rheaShowElem_TR(rheaGetElemByID("pageMilker_row_tplBarista"));
		rheaShowElem_TR(rheaGetElemByID("pageMilker_row_tplBaristaCold"));
		
	}
	pagePinCode_hide();
}

function pageMilker_onMilkerTypeChange()
{
	var NUM_PARAM_CAPP_VENTURI=4;
	var NUM_PARAM_CAPP_INDUX = 9;

	var win = ui.getWindowByID("pageMilker");
	var milkerModule = win.getChildByID("pageMilker_model");
	var yesNo = win.getChildByID("pageMilker_enabled");

	switch (parseInt(milkerModule.getSelectedOptionValue()))
	{
	case 0: //se milkerType==none, allora metto yesNo==no
		yesNo.selectOptionByValue(0);
		break;
		
	case 1: //milkerType==venturi
		rheaShowElem(rheaGetElemByID("pageMilker_capp_venturi"));
		rheaHideElem(rheaGetElemByID("pageMilker_capp_induzione"));
		rheaShowElem_TR(rheaGetElemByID("pageMilkerV_cleaning_period"));
		for (var i=1; i<=NUM_PARAM_CAPP_VENTURI; i++)
			win.getChildByID("pageMilker_capp_venturi_" +i).allowSaveToDa3();
		for (var i=1; i<=NUM_PARAM_CAPP_INDUX; i++)
		{
			var o = win.getChildByID("pageMilker_capp_indux_" +i);
			if (o !== null)
				o.dontSaveToDa3();
		}
		break;

	case 2: //milkerType==indux
		rheaShowElem(rheaGetElemByID("pageMilker_capp_induzione"));
		rheaHideElem(rheaGetElemByID("pageMilker_capp_venturi"));
		rheaHideElem(rheaGetElemByID("pageMilkerV_cleaning_period"));
		pageMilker_refreshTuningSpeedPump();
		for (var i=1; i<=NUM_PARAM_CAPP_INDUX; i++)
		{
			var o = win.getChildByID("pageMilker_capp_indux_" +i);
			if (o !== null)
				o.allowSaveToDa3();
		}		
		for (var i=1; i<=NUM_PARAM_CAPP_VENTURI; i++)
			win.getChildByID("pageMilker_capp_venturi_" +i).dontSaveToDa3();
		break;
	}

	pageMilker_onEnabledYesNo();
	win.showHideScrollBar();
}

function pageMilker_onAutorinsingMode_changed()
{
	var win = ui.getWindowByID("pageMilker");

	switch (parseInt(win.getChildByID("pageMilker_capp_indux_1").getSelectedOptionValue()))
	{
	default: // default
		rheaHideElem (rheaGetElemByID("pageMilker_autorinsing_period"));
		win.getChildByID("pageMilker_capp_indux_2").setValue(10);
		break;
		
	case 1: //HDE
		rheaShowElem_TR (rheaGetElemByID("pageMilker_autorinsing_period"));
		break;
	}

}

function pageMilker_onMilkerTypeChange_fromUser()
{
	//utente ha selezionato un nuovo tipo di capp.
	//Se attualmente ero "enabled == NO", sposto a "enabled==YES"
	var win = ui.getWindowByID("pageMilker");
	var milkerModule = win.getChildByID("pageMilker_model");
	var yesNo = win.getChildByID("pageMilker_enabled");

	switch (parseInt(milkerModule.getSelectedOptionValue()))
	{
	case 0: //se milkerType==none, allora metto yesNo==no
		yesNo.selectOptionByValue(0);
		break;
		
	case 1: //milkerType==venturi
	case 2: //milkerType==indux
		yesNo.selectOptionByValue(1);
		break;
	}
	pageMilker_onMilkerTypeChange();
}

function pageMilker_onEnabledYesNo()
{
	var win = ui.getWindowByID("pageMilker");
	var yesNo = win.getChildByID("pageMilker_enabled");
	var temperature = win.getChildByID("pageMilker_temperature");
	
	if (yesNo.getSelectedOptionValue() == 0)
	{
		rheaHideElem(rheaGetElemByID("pageMilker_params"));
	}
	else
	{
		if (da3.read8(7618) == 0)
			temperature.setValue("125");
		rheaShowElem(rheaGetElemByID("pageMilker_params"));
		
	}
	
	if (da3.isCustomer_NESTLE())
	{	
		rheaHideElem(rheaGetElemByID("pageMilker_Show_cleaning_period"));
	}
	win.showHideScrollBar();
}

function pageMilker_onBtnSave()
{
	var win = ui.getWindowByID("pageMilker");
	var yesNo = win.getChildByID("pageMilker_enabled");
	var temperature = win.getChildByID("pageMilker_temperature");

	if (yesNo.getSelectedOptionValue() == 0)
		temperature.setValue("000");
	
	//tuning della velocita' pompa latte con valori memorizzati su da3 da 70 a 130 che indicano da -30% a +30%
	var com_indirizzo=8366;		
    var Valoreobj = win.getChildByID("pageMilker_tSpeedV");  
	var val_impostato = (parseInt(Valoreobj.getValue()));			
	if (operTuningSpeedMilkPump == "+")  //indica se il valore é positivo o negativo	
		val_impostato=val_impostato+100;
	else
		val_impostato=100 + (val_impostato* (-1));

	if ((val_impostato < 70) || (val_impostato > 130)) val_impostato=100;
	da3.write16(com_indirizzo, parseInt(val_impostato));
	
	btnSave_defaultCallback();
}


/***************************************************************************
 *
 * pageSelections
 *
 */
var SEL_NUM_PAGES = 4;

function pageSelections_show()
{
	if (showPage("pageSelections", "メニューボタン設定", 1,0))
	{
		//è la prima volta che visualizziamo la pagina
		if (da3.hasCapab_60_SELEZIONI())
		{
			var o = ui.getWindowByID("pageSelections").getChildByID("pageSelections_selector");
			o.changeOptions ("1|1-12|2|13-24|3|25-36|4|37-48|5|49-60");
			o.selectOptionByValue("1");
		}
	}
	btnTestSelection_hide();
	pageSelections_onSelector();
}

function pageSelections_build()
{
	var html = "";
	if (da3.hasCapab_60_SELEZIONI())
		SEL_NUM_PAGES = 5;
	
	var iSel = 1;
	for (var page=1; page<=SEL_NUM_PAGES; page++)
	{
		html += "<div id='pageSelections_page" +page +"' style='display:none'><table border='0'><tr>";
		for (var r=0; r<4; r++)
		{
			for (var c=0; c<3; c++)
			{
				var caption = "セレクション " +rheaLeftPad(iSel,2,'0');
				html += "<td width='33%' align='center'><div class='UIButtonSel' "
						+"data-caption='" +caption +"' "
						+"data-caption2='" +guiInfo.selInfo[iSel].name +"' "
						+"data-caption3='" +guiInfo.selInfo[iSel].short +"' "
						+"data-onclick='pageSelections_onClick(" +iSel +")'></div></td>";
				iSel++;
			}
			html += "</tr>";
		}
		html += "</table></div>";
	}
	rheaSetDivHTMLByName("pageSelections_c2", html);
}


function pageSelections_onSelector()
{
	var win = ui.getWindowByID("pageSelections");
	var option = parseInt(win.getChildByID("pageSelections_selector").getSelectedOptionValue());
	for (var page=1; page<=SEL_NUM_PAGES; page++)
	{
		var elem = rheaGetElemByID("pageSelections_page" +page);
		if (option == page)
			rheaShowElem(elem);
		else
			rheaHideElem(elem);
	}
}

function pageSelections_onClick(iSel)
{
	pleaseWait_show();
	setTimeout (function(){ pageSingleSelection_show(iSel); }, 100);
}

/***************************************************************************
 *
 * pageSingleSelection
 *
 */
var pageSingleSelection_curSel = 0;
function pageSingleSelection_show(iSel)
{
	pageSingleSelection_curSel = iSel;

	var win = ui.getWindowByID("pageSingleSelection");

	var title = "セレクション " +rheaLeftPad(iSel,2,'0') +"&nbsp;-&nbsp;" +guiInfo.selInfo[iSel].name +"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='font-size:0.7em;color:#888'>" +UIUtils_arrangeSelectionOptionDescription2021(guiInfo.selInfo[iSel].short) +"</span>";
	if (showPageEx("pageSingleSelection", title, 1, 1, 100 * (iSel-1)))
	{
		//è la prima volta che visualizziamo la pagina
		if (da3.isGruppoMicro())
			rheaHideElem(rheaGetElemByID("pageSingleSelection_pageSel_rowJug"));
			
		//cup-size vale solo per brewmatic
		if (da3.isMachine_Brewmatic4Macine())
		{
			rheaShowElem_TR(rheaGetElemByID("pageSingleSelection_pageSel_rowCupSizeBrewmatic"));
			rheaHideElem(rheaGetElemByID("pageSingleSelection_pageSel_scalingF"));
		}
		else
		{
			rheaHideElem(rheaGetElemByID("pageSingleSelection_pageSel_rowCupSizeBrewmatic"));
			rheaShowElem_TR(rheaGetElemByID("pageSingleSelection_pageSel_scalingF"));
		}
		
		//non è vero, cup-size vale anche nel caso in cui ci sia il sensore Wenglor
		if (da3.hasCapab_SENSORE_WENGLOR_CUP_PRESENCE())
		{
			rheaShowElem_TR(rheaGetElemByID("pageSingleSelection_pageSel_rowCupSizeBrewmatic"));
			var selectorCupSize = win.getChildByID("pageSingleSelection_selCupSize");
			selectorCupSize.changeOptions("0|許容|1|スモールカップのみ(下限)|2|スモールカップのみ(上限）|3|スモールカップ(上下)|4|ビックカップのみ|5|様々なカップ");
			selectorCupSize.loadFromDA3(da3);
		}
		
		if (da3.hasCapab_NO_PAYMENT_SYSTEM())
		{
			rheaHideElem(rheaGetElemByID("pageSingleSelection_pageSel_prc1"));
			rheaHideElem(rheaGetElemByID("pageSingleSelection_pageSel_prc2"));
		}

		if (da3.hasCapab_CPU_FUSION_NEXT())
		{
			if (!da3.isInstant())
			{
				var selector = win.getChildByID("pageSingleSelection_pwmPump");
				selector.changeOptions ("0|100%|1|95%|2|90%|3|85%|4|80%|5|75%|6|70%|7|65%|8|60%|9|55%|10|50%|11|45%|12|40%|13|35%|14|30%|15|25%|16|20%|17|15%|18|10%|19|5%");
				selector.loadFromDA3(da3);
			}
		}	
		
		var selOptions = "0|セレクション|1|ノンアクティブ|2|プレセレクション";
		if (da3.hasCapab_CICLO_DRIPFILTER())
			selOptions += "|3|LOW PRESSURE";
		if (da3.hasCapab_FOUNTAIN())
			selOptions += "|4|WATER ON DEMAND";
		var selector = win.getChildByID("pageSingleSelection_status");
		selector.changeOptions (selOptions);
		selector.loadFromDA3(da3);
	}
	btnBack_setCallback("pageSelections_show()");
	btnTestSelection_show();
	
	
	//lo scaling factor delle selezioni potrebbe valere 0 nel qual caso significa 100%
	var da3Loc = 180 + 100 * (iSel-1);
	if (da3.read8(da3Loc) == 0)
		win.getChildByID("pageSingleSelection_sfactor").setValue(100);
	
	//Setto i prezzi
	var obj = win.getChildByID("pageSingleSelection_prc1");
	obj.setDecimals(da3.getDecimalsForPrices());
	obj.da3offset = 0;
	obj.da3Pos = da3.getPriceLocation(1,iSel);
	obj.loadFromDA3(da3);
	
	obj = win.getChildByID("pageSingleSelection_prc2");
	obj.setDecimals(da3.getDecimalsForPrices());
	obj.da3offset = 0;
	obj.da3Pos = da3.getPriceLocation(2,iSel);
	obj.loadFromDA3(da3);	
	
	//unita misura prodotti
	for (var i=0; i<SINGLESEL_NUM_PRODOTTI; i++)
	{
		if (da3.isMotorCalibrated(i+1)) 
			um = "gr"; 
		else
			um = "sec";
		win.getChildByID("pageSingleSelection_P_d"+i).changeUM(um);
	}
	
	if (da3.doesSupportExtModule())
	{
		for (var i=21; i<=22; i++)
		{
			if (da3.isMotorCalibrated(i)) 
				um = "gr"; 
			else
				um = "sec";
			win.getChildByID("pageSingleSelection_P_d"+i).changeUM(um);
		}
	}
	
	//unita' misura macina
	pageSingleSelection_onChangeGrinder();


	rheaSetElemTop(rheaGetElemByID("pageSingleSelection_content"), 0);
	rheaHideElem(rheaGetElemByID("pageSingleSelection_arrowUp"));
	
	
	if (da3.isGruppoVariflex())
	{
		if (!da3.isMachine_rhTT1Plus())
		{
			if (da3.isCappuccinatoreInduzione())
				rheaShowElem_TR(rheaGetElemByID("pageSingleSelection_trCappInduxFoamType"));
			else
				rheaHideElem(rheaGetElemByID("pageSingleSelection_trCappInduxFoamType"));
		}
	}	

	
	//seleziono "general option"
	win.getChildByID("pageSingleSelection_selector").selectOptionByValue(0);
	pageSingleSelection_showPartialFull (win, 0);
	pageSingleSelection_onStatus();
	pageSingleSelection_adjustTemperatureWarns();
	pageSingleSelection_onPreinfusionQtyChange();
	pleaseWait_hide();

	//il valore di A6 va moltiplicato per 2
	if (da3.isGruppoVariflex())
	{
		obj = win.getChildByID("pageSingleSelection_A6");
		obj.loadFromDA3(da3);
		obj.dontSaveToDa3();
		var a6 = parseInt (parseInt(obj.getValue()) * 2 );
		obj.setValue(a6);
	}
	
	

	//unita' misura acque
	for (var i=0; i<SINGLESEL_NUM_ACQUE; i++)
		pageSingleSelection_onEVSpeedChanged(i+1);

	btnSave_setCallback ("pageSingleSelection_onBtnSave()");
}

function pageSingleSelection_onPreinfusionQtyChange()
{
	if (da3.hasCapab_CPU_FUSION_NEXT())
	{
		if (!da3.isInstant())
		{
			var win = ui.getWindowByID("pageSingleSelection");
			if (0 === parseInt(win.getChildByID("pageSingleSelection_preinfusion_cc").getValue(0)))
			{
				rheaHideElem(rheaGetElemByID("preinfusion_row1"));
				rheaHideElem(rheaGetElemByID("preinfusion_row2"));
			}
			else
			{
				rheaShowElem_TR(rheaGetElemByID("preinfusion_row1"));
				rheaShowElem_TR(rheaGetElemByID("preinfusion_row2"));
			}
		}
	}
	
}

function pageSingleSelection_resetConfirm()
{
	areYouSureYouWishToLaunchTheChosenOperation(
		function YES()
		{
			pageSingleSelection_reset(pageSingleSelection_curSel,window.location.href.split("?")[0]);
		}
	);
}

function pageSingleSelection_reset(iSel,url)
{
	pleaseWait_show();
	//var url = window.location;
	//var iSel = pageSingleSelection_curSel;
	
	

	rhea.ajax ("ResetSelection", {"iSel":iSel}).then( function(result)
	{
		if (result)
		{	
			//CPU ha risposto ok, aspetto 2 sec e ricarico la pagina
			setTimeout (function() { pleaseWait_hide(); window.location = url+"?page=pageSingleSel&selNum="+iSel;}, 2000);
		}
		else
		{
			//CPU ha risposta "KO", informiamo della cosa l'utente e terminiano
		}
	})
	.catch( function(result)
	{
		pleaseWait_hide();;
		console.log("Reset Selection Timeout")
	});
	
}


function pageSingleSelection_onBtnSave()
{
	var win = ui.getWindowByID("pageSingleSelection");
	var obj;

	if (da3.isGruppoVariflex())
	{
		obj = win.getChildByID("pageSingleSelection_A6");
		obj.dontSaveToDa3();

		var a6 = parseInt (Math.floor( parseInt(obj.getValue()) / 2 ));
		var da3Loc = obj.da3Pos + obj.da3offset; 
		da3.write8(da3Loc, a6);
	}
	
	var selStatus = parseInt(win.getChildByID("pageSingleSelection_status").getSelectedOptionValue());
	if (selStatus == 4)
	{
		//siamo nel caso di selezioni di tipo fontana. Voglio accertarmi di mettere a 0 tutti i parametri di ricetta di espresso, mixer e prodotto
		if (da3.isEspresso())
		{
			win.getChildByID("pageSingleSelection_coffeeWater").setValue(0);
			win.getChildByID("pageSingleSelection_coffeeGrinder").setValue(0);
			if (da3.hasCapab_CPU_FUSION_NEXT())
				win.getChildByID("pageSingleSelection_coffeeGrinder2").setValue(0);
			win.getChildByID("pageSingleSelection_preinfusion").setValue(0);
			win.getChildByID("pageSingleSelection_LMStartBrewer").setValue(0);
			
			if (da3.isGruppoVariflex())
			{
				if (!da3.isMachine_rhTT1Plus())
				{
					win.getChildByID("pageSingleSelection_EVFMQty").setValue(0);
					win.getChildByID("pageSingleSelection_EVFMDly").setValue(0);
					win.getChildByID("pageSingleSelection_EVAirQty").setValue(0);
					win.getChildByID("pageSingleSelection_EVAirDly").setValue(0);
				}
				win.getChildByID("pageSingleSelection_brewerPressure").setValue(0);
				var obj = win.getChildByID("pageSingleSelection_snackNum");
				if (obj)
					obj.setValue(0);
			}
			win.getChildByID("pageSingleSelection_coffeeRepeat").selectOptionByValue(0);
			win.getChildByID("pageSingleSelection_jug").setValue(0);
			win.getChildByID("pageSingleSelection_selRepeat").setValue(0);
		}
		
		for (var i=0; i<SINGLESEL_NUM_PRODOTTI; i++)
		{
			win.getChildByID("pageSingleSelection_P_d" +i).setValue(0);
			win.getChildByID("pageSingleSelection_P_q" +i).setValue(0);
		}
		win.getChildByID("pageSingleSelection_P_dLM").setValue(0);
		win.getChildByID("pageSingleSelection_P_qLM").setValue(0);
		
		if (da3.doesSupportExtModule())
		{
			for (var i=21; i<=22; i++)
			{
				win.getChildByID("pageSingleSelection_P_d" +i).setValue(0);
				win.getChildByID("pageSingleSelection_P_q" +i).setValue(0);
			}		
		}
		
		var bFoundAGoodEV = 0;
		for (var i=0; i<SINGLESEL_NUM_ACQUE; i++)
		{
			win.getChildByID("pageSingleSelection_M_t" +i).setValue(0);
			win.getChildByID("pageSingleSelection_M_q" +i).setValue(0);
			
			win.getChildByID("pageSingleSelection_W_d" +i).setValue(0);
			var objWaterQty = win.getChildByID("pageSingleSelection_W_t" +i)
			if (bFoundAGoodEV)
				objWaterQty.setValue(0);
			else
			{
				if (objWaterQty.getValue() > 0)
				{
					bFoundAGoodEV = 1;
					objWaterQty.setValue(500);
				}
			}
		}
	}
	
	btnSave_defaultCallback();
}


function pageSingleSelection_onChangeGrinder()
{
	var win = ui.getWindowByID("pageSingleSelection");	
	if (da3.hasCapab_CPU_FUSION_NEXT())
	{
		if (!da3.isInstant())
		{
			var um="sec";
			if (da3.isMotorCalibrated(11))
				um = "gr"; 
			win.getChildByID("pageSingleSelection_coffeeGrinder").changeUM(um);		
			
			um="sec";
			if (da3.isMotorCalibrated(12))
				um = "gr"; 
			win.getChildByID("pageSingleSelection_coffeeGrinder2").changeUM(um);
		}
	}
	else
	{
		if (da3.isEspresso())
		{
			var macina = 11;
			if (da3.isGruppoVariflex())
				macina = 11 + parseInt(win.getChildByID("pageSingleSelection_cofGrnderChoice").getSelectedOptionValue());

			var um="sec";
			if (da3.isMotorCalibrated(macina))
				um = "gr"; 
			win.getChildByID("pageSingleSelection_coffeeGrinder").changeUM(um);		
		}
	}
}

function buildRow_product (label_prodName, rowID, dosageID, delayID, da3LocProd, da3Loc_PWMProdotto, trapOnTestItBtn)	
{
	var htmlP = "<tr id='" +rowID +"'>"
			+"<td>" +label_prodName +"<br><div class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='" +trapOnTestItBtn +"'></div></td>"
			+"<td align='left'><div id='" +dosageID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +da3LocProd +"' data-da3bit='9' data-da3bit9='2,4' data-max='500' data-um='sec'></div></td>"
			+"<td align='left'><div id='" +delayID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +(da3LocProd+1) +"' data-da3bit='9' data-da3bit9='1,5' data-max='500' data-um='sec'></div></td>";
			
	//if (da3.isMachine_rhTT1Plus())
	if (da3.productsPWM_insteadOfBreaks())
	{
		//al posto dei breaks, ho il PWM
		htmlP += "<td align='right'><div class='UINumber' data-numfigures='3' data-da3='" +da3Loc_PWMProdotto +"' data-da3bit='8' data-min='1' data-max='100' data-um='%'></div></td>";
	}
	else if (da3.hasCapab_CPU_FUSION_NEXT() || da3.isCustomer_NESTLE())
		htmlP += "<td align='center'><div class='UIOption' data-option='0|0|1|1|2|2|15|MAX' data-da3='" +(da3LocProd+2) +"' data-da3bit='4'></div></td>";
	else
	{
		if (da3.hasCapab_15_TOP_STOP())
			htmlP += "<td align='right'><div class='UINumber' data-numfigures='2' data-decimal='0' data-da3='" +(da3LocProd+2) +"' data-da3bit='4' data-max='15'></div></td>"
		else
			htmlP += "<td align='center'><div class='UIOption' data-option='0|0|1|1|2|2' data-da3='" +(da3LocProd+2) +"' data-da3bit='4'></div></td>";
	}
	htmlP += "</tr>";
	return htmlP;
}

var SINGLESEL_NUM_PRODOTTI = 0;
var SINGLESEL_NUM_PRODOTTI_MAX = 9;
var SINGLESEL_NUM_ACQUE = 0;
var WATER_COLONNA_FLOW_TYPE = 0;
function pageSingleSelection_build()
{
	var da3LocProd;
	var da3LocWater;
	var da3LocEVTemperature = 0;
	var WATER_COLONNA_FLOW_TITLE = "";
	WATER_COLONNA_FLOW_TYPE = 0;
	if (da3.isInstant())
	{
		SINGLESEL_NUM_PRODOTTI = 9;
		SINGLESEL_NUM_ACQUE = 5;
		da3LocProd = 102;
		da3ProductLM = da3LocProd +3*SINGLESEL_NUM_PRODOTTI;
		da3LocWater = da3ProductLM +3;
		
		WATER_COLONNA_FLOW_TYPE = 1;
		WATER_COLONNA_FLOW_TITLE = "フロー";
	}
	else
	{
		SINGLESEL_NUM_PRODOTTI = 7;
		SINGLESEL_NUM_ACQUE = 5;
		da3LocProd = 105;
		da3ProductLM = 129;
		da3LocWater = da3ProductLM +3;

		if (da3.isInduzione())
		{
			WATER_COLONNA_FLOW_TYPE=2;
			//WATER_COLONNA_FLOW_TITLE = "EV温度";
			WATER_COLONNA_FLOW_TITLE = "EV TEMP<br>&deg;C";
			da3LocEVTemperature = 169;
		}
		else
			WATER_COLONNA_FLOW_TITLE = "";
	}

	var s = "";
	if (da3.isInstant())
		s = "0|概要|2|プロダクツ|3|ウオーター|4|MIXERS";
	else
	{
		var menuMilker = "|5|ミルカー";
		if (da3.isGruppoMicro())
			menuMilker = "";
		
		//Nelle macchine senza solubili, elimino i menu prodotti e mixer
		if (da3.hasAnyInstant())
			s = "0|概要|1|ESPRESSO" +menuMilker +"|2|プロダクツ|3|ウオーター|4|MIXERS";
		else
			s = "0|概要|1|ESPRESSO" +menuMilker +"|3|ウオーター";
			
	}
	
	//moduli esterni
	if (da3.doesSupportExtModule())
	{
		s += "|10|EXT_MODULE";
	}
	
	rheaSetDivHTMLByName("pageSingleSelection_selectorAtTop", "<div class='UIOptionSmall' id='pageSingleSelection_selector' data-option='" +s +"' data-onclick='pageSingleSelection_onSelector()'></div>");
	
	
	var htmlE="";
	var htmlMilker = "";
	if (da3.isEspresso())
	{
		//minimo 2 macine, ma potrebbero essercene di +
		var optionsForGrinder = "0|1|1|2";
		for (var i=2; i<da3.getNumMacine(); i++)
			optionsForGrinder += "|" +i +"|" +(i+1);


		htmlE = "<table border='0' class='elenco'>"
				+"<tr><td style='width:350px'>コーヒー順序</td><td><div class='UIOption' data-option='0|後|1|前' data-da3='103' data-da3bit='8'></div></td></tr>"
				+"<tr><td>コーヒー湯量<br><div class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='pageSingleSelection_test(11)'></div></td><td><div id='pageSingleSelection_coffeeWater' class='UINumber' data-numfigures='3' data-da3='102' data-da3bit='9' data-da3bit9='2,4' data-max='500' data-um='cc'></div></td></tr>";
				
		if (da3.hasCapab_CPU_FUSION_NEXT())
		{
			htmlE += "<tr><td>グラインド時間 1<br><div class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='pageSingleSelection_test(13)'></div></td><td><div class='UINumber' id='pageSingleSelection_coffeeGrinder' data-numfigures='3' data-decimal='1' data-da3='126' data-da3bit='8' data-max='200' data-um='sec'></div></td></tr>";
			htmlE += "<tr><td>グラインド時間 2<br><div class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='pageSingleSelection_test(14)'></div></td><td><div class='UINumber' id='pageSingleSelection_coffeeGrinder2' data-numfigures='3' data-decimal='1' data-da3='193' data-da3bit='8' data-max='200' data-um='sec'></div></td></tr>";
			htmlE += "<tr><td>START WITH GRINDER</td><td><div id='pageSingleSelection_cofGrnderChoice' class='UIOption' data-option='" +optionsForGrinder +"' data-da3='179' data-da3bit='8' data-onclick='pageSingleSelection_onChangeGrinder()'></div></td></tr>";

			htmlE += "<tr class='noBorder'><td>蒸らし QTY</td><td><div class='UINumber' id='pageSingleSelection_preinfusion_cc' data-da3='" +(DA3_SELECTION_EPROM2_START+40) +"' data-da3bit='8' data-numfigures='2' data-min='0' data-forbidden='1,2,3,4' data-max='30' data-um='cc' data-onChange='pageSingleSelection_onPreinfusionQtyChange()'></div></td></tr>";
			htmlE += "<tr id='preinfusion_row1' class='noBorder'><td>蒸らし PWM</td><td><div class='UISelect' data-da3='194' data-da3bit='8' data-option='0|100%|1|95%|2|90%|3|85%|4|80%|5|75%|6|70%|7|65%|8|60%|9|55%|10|50%|11|45%|12|40%|13|35%|14|30%|15|25%|16|20%|17|15%|18|10%|19|5%'></div></td></tr>";
			htmlE += "<tr id='preinfusion_row2' class='noBorder'><td>蒸らし REST TIME</td><td><div class='UINumber' id='pageSingleSelection_preinfusion' data-numfigures='2' data-da3='128' data-da3bit='4' data-max='15' data-um='sec'></div></td></tr>";
			htmlE += "<tr style='height:auto'><td colspan='2'></td></tr>";
		}
		else
		{
			htmlE += "<tr><td>グラインド時間<br><div class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='pageSingleSelection_test(12)'></div></td><td><div class='UINumber' id='pageSingleSelection_coffeeGrinder' data-numfigures='3' data-decimal='1' data-da3='126' data-da3bit='8' data-max='200' data-um='sec'></div></td></tr>";
			htmlE += "<tr><td>グラインダー</td><td><div id='pageSingleSelection_cofGrnderChoice' class='UIOption' data-option='" +optionsForGrinder +"' data-da3='179' data-da3bit='8' data-onclick='pageSingleSelection_onChangeGrinder()'></div></td></tr>";
			htmlE += "<tr><td>蒸らし REST TIME</td><td><div class='UINumber' id='pageSingleSelection_preinfusion' data-numfigures='2' data-da3='128' data-da3bit='4' data-max='15' data-um='sec'></div></td></tr>";
		}


		

		if (da3.isGruppoVariflex())
				htmlE += "<tr><td>タンピング圧</td><td><div class='UINumber' id='pageSingleSelection_brewerPressure' data-numfigures='2' data-da3='104' data-da3bit='4' data-max='10'></div></td></tr>";
		
		if (da3.isInduzione())
			htmlE += "<tr><td>コーヒー抽出温度<div id='pageSingleSelection_warnTemp1' class='warn'>Rheavendorsは最低温度75℃以上を推奨しています</div></td>"
					+"<td><div id='pageSingleSelection_temp1' class='UINumber' data-numfigures='3' data-da3='168' data-da3bit='8' data-min='" +LIMITE_MIN_TEMPERATURA +"' data-max='110' data-um='&deg;C' data-onChange='pageSingleSelection_adjustTemperatureWarns()'></div></td></tr>";
			
		//espresso pump PWM
		if (!da3.isInstant())
		{
			if (da3.isMachine_rhTT1Plus() || da3.isCustomer_NESTLE())
			{
				htmlE += "<tr><td>ESPRESSO ポンプ回転数</td>"
						+"<td><div class='UISelect' id='pageSingleSelection_pwmPump' data-da3='185' data-da3bit='8' data-option='0|100%|1|95%|2|90%|3|87%|4|85%|5|83%|6|80%|7|75%|8|66%|9|50%'></div></td></tr>";
			}
		}
			
		if (da3.isGruppoVariflex())
			htmlE  +="<tr><td>粒度設定</td><td><div class='UIOption' style='font-size:0.9em' data-option='0|無効|1|細かい|2|通常|3|粗い' data-da3='175' data-da3bit='8'></div></td></tr>";
			
		htmlE  +="<tr><td>ラテ・マキアート</td><td><div class='UINumber' id='pageSingleSelection_LMStartBrewer' data-numfigures='3' data-decimal='1' data-da3='127' data-da3bit='9' data-da3bit9='1,5' data-max='500' data-um=''></div></td></tr>";
		
		if (da3.isGruppoVariflex())
		{
			if (da3.isMachine_rhTT1Plus())
			{
				htmlMilker =  "<table border='0' class='elenco'>"
							 +"<tr><td>MILK SEQUENCE</td><td><div class='UIOption' data-option='0|AFTER|1|BEFORE' 			   data-da3='" +(DA3_SELECTION_EPROM2_START+33) +"' data-da3bit='8'></div></td></tr>"
							 +"<tr><td>tPreAir</td><td><div class='UINumber' data-numfigures='5' data-decimal='1'              data-da3='" +(DA3_SELECTION_EPROM2_START+20) +"' data-da3bit='16' data-max='65500' data-um='sec'></div></td></tr>"
							 +"<tr><td>tMilkPump</td><td><div class='UINumber' data-numfigures='5' data-decimal='1'            data-da3='" +(DA3_SELECTION_EPROM2_START+22) +"' data-da3bit='16' data-max='65500' data-um='sec'></div></td></tr>"
							 +"<tr><td>tAirValve</td><td><div class='UINumber' data-numfigures='5' data-decimal='1'            data-da3='" +(DA3_SELECTION_EPROM2_START+24) +"' data-da3bit='16' data-max='65500' data-um='sec'></div></td></tr>"
							 +"<tr><td>pMilkPump</td><td><div class='UINumber' data-numfigures='3' data-decimal='0'            data-da3='" +(DA3_SELECTION_EPROM2_START+26) +"' data-da3bit='8' data-max='100' data-um='%'></div></td></tr>"
							 +"<tr><td>pAirValve</td><td><div class='UINumber' data-numfigures='3' data-decimal='0'            data-da3='" +(DA3_SELECTION_EPROM2_START+27) +"' data-da3bit='8' data-max='100' data-um='%'></div></td></tr>"
							 +"<tr><td>tPulsedAir</td><td><div class='UINumber' data-numfigures='3' data-decimal='1'           data-da3='" +(DA3_SELECTION_EPROM2_START+28) +"' data-da3bit='8' data-max='255' data-um='sec'></div></td></tr>"
							 +"<tr><td>pPulsedAir</td><td><div class='UINumber' data-numfigures='3' data-decimal='1'           data-da3='" +(DA3_SELECTION_EPROM2_START+29) +"' data-da3bit='8' data-max='255' data-um='sec'></div></td></tr>"
							 +"<tr><td>beverageTemp</td><td><div class='UINumber' data-numfigures='3' data-decimal='0'         data-da3='" +(DA3_SELECTION_EPROM2_START+30) +"' data-da3bit='8' data-max='100' data-um='&deg;C'></div></td></tr>"
							 +"<tr><td>tSwitchOffPreEmption</td><td><div class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +(DA3_SELECTION_EPROM2_START+31) +"' data-da3bit='8' data-max='255' data-um='sec'></div></td></tr>"
							 +"<tr><td>condCheckEn</td><td><div class='UINumber' data-numfigures='1' data-decimal='0'          data-da3='" +(DA3_SELECTION_EPROM2_START+32) +"' data-da3bit='8' data-max='1' data-um='on/off'></div></td></tr>"
							 +"</table>";
			}
			else
			{
				htmlMilker =  "<table border='0' class='elenco'>"
							 +"<tr id='pageSingleSelection_trCappInduxFoamType'><td>ミルク<br>フォームタイプ</td><td><div id='pageSingleSelection_cappInduxFoamType' class='UISelect' data-option='0|HOT, NO FOAM|1|ホットミルク　クラシックフォーム|2|ホットミルク　ふわふわフォーム|3|ホットミルク　バリスタフォーム|4|COLD, NO FOAM|5|コールドミルク　クラシックフォーム|6|コールドミルク　ふわふわフォーム|7|コールドミルク　バリスタフォーム' data-da3='164' data-da3bit='4'></div></td></tr>"
							 +"<tr><td>ミルク<br>抽出時間</td><td><div class='UINumber' id='pageSingleSelection_EVFMQty' data-numfigures='3' data-decimal='1' data-da3='162' data-da3bit='9' data-da3bit9='2,4' data-max='500'  data-um='sec' data-forbidden='1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29'></div></td></tr>"
							 +"<tr><td>ミルク<br>抽出遅延</td><td><div class='UINumber' id='pageSingleSelection_EVFMDly' data-numfigures='3' data-decimal='1' data-da3='163' data-da3bit='9' data-da3bit9='1,5' data-max='500' data-um='sec'></div></td></tr>"
							 +"<tr><td>ミルク<br>エアー時間</td><td><div class='UINumber' id='pageSingleSelection_EVAirQty' data-numfigures='3' data-decimal='1' data-da3='165' data-da3bit='9' data-da3bit9='2,4' data-max='500' data-um='sec'></div></td></tr>"
							 +"<tr><td>ミルク<br>エアー遅延</td><td><div class='UINumber' id='pageSingleSelection_EVAirDly' data-numfigures='3' data-decimal='1' data-da3='166' data-da3bit='9' data-da3bit9='1,5' data-max='500' data-um='sec'></div></td></tr>"
							 +"</table>";
			}		
			//se macchina Brewmatic, allora ci sono le opzioni di time/speed per la macina
			if (da3.isMachine_Brewmatic4Macine())
			{
				htmlE += 	 "<tr><td>VIBRATION TIME</td><td><div class='UINumber'  data-da3bit='8' data-numfigures='3'  data-da3='182' data-max='255' data-um='sec' data-decimal='1'></div></td></tr>"
							+"<tr><td>VIBRATION SPEED</td><td><div class='UINumber' data-da3bit='8' data-numfigures='3' data-da3='183' data-max='100' data-um='%'></div></td></tr>"
			}
		}

		htmlE += "<tr><td>コーヒーのみ繰り返し</td><td><div class='UIOption' id='pageSingleSelection_coffeeRepeat' data-option='0|0|1|1|2|2' data-da3='181' data-da3bit='8'></div></td></tr>"
				+"</table>";
				
        htmlE += "<div id='pageSingleSelection_dripFilterOption'>"
				+"<br><b>LOW PRESSURE PARAMETERS</b><br><table border='0' class='elenco'>"
				//+"<tr><td>A1 PWM Varilfex move</td><td><div class='UISelect' id='pageSingleSelection_A1' data-readonly='1' data-da3='186' data-da3bit='8' data-option='60|60%|65|65%|70|70%|75|75%|80|80%|85|85%|90|90%|95|95%|100|100%'></div></td></tr>"
				+"<tr><td>A1 PWM Varilfex move</td><td>60%</td></tr>"
                +"<tr><td>A2 Pump-ON time</td><td><div class='UINumber' id='pageSingleSelection_A2' data-numfigures='3' data-decimal='1' data-da3='187' data-da3bit='8' data-max='250' data-um='sec.'></div></td></tr>"
                +"<tr><td>A3 Pump-OFF time</td><td><div class='UINumber' id='pageSingleSelection_A3' data-numfigures='3' data-decimal='1' data-da3='188' data-da3bit='8' data-max='250' data-um='sec.'></div></td></tr>"
                +"<tr><td>A5 Num press</td><td><div class='UINumber' id='pageSingleSelection_A5' data-numfigures='2'     data-da3='189' data-da3bit='8' data-min='3' data-max='5'></div></td></tr>"
                +"<tr><td>A6 Water after coffee</td><td><div class='UINumber' id='pageSingleSelection_A6' data-soloPari='1' data-numfigures='3' data-da3='190' data-da3bit='8' data-min='0' data-max='500' data-um='ml'></div></td></tr>"
                +"<tr><td>A7 Chamber Aperture</td><td><div class='UINumber' id='pageSingleSelection_A7' data-numfigures='3' data-da3='191' data-da3bit='8' data-min='1' data-max='95' data-um='%'></div></td></tr>"
				+"</table></div>";			
	}
	
	

	var htmlP = "<table border='0' class='elenco'>"
				+"<tr>"
				+"	<th style='width:184px; text-align:left;'>プロダクト #</th>"
				+"	<th style='width:290px; text-align:left;'>投与量</th>"
				+"	<th style='width:290px; text-align:left;'>スタートディレイ</th>";
				
	//if (da3.isMachine_rhTT1Plus())
	if (da3.productsPWM_insteadOfBreaks())
		htmlP += "	<th style='width:260px; text-align:center;'>PWM</th>";
	else
		htmlP += "	<th style='width:260px; text-align:center;'>区切り</th>";
	htmlP += "</tr>";
	
	var da3Loc_PWMProdotto = DA3_SELECTION_EPROM2_START;
	for (var i=0; i<SINGLESEL_NUM_PRODOTTI; i++)
	{
		var prodNum;
		prodNum = rheaLeftPad(i+1, 2, '0');
			
		var rowID = "pageSingleSelection_P_" +i;
		var dosageID = "pageSingleSelection_P_d" +i;
		var delayID = "pageSingleSelection_P_q" +i;
		
		var label_prodNum = "#" + prodNum;
		var label_prodName = da3.readASCIIString (9483 + i*16, 16);
		if (label_prodName == "" || label_prodName.toUpperCase() == "NOT USED")
			label_prodName = label_prodNum;
			
		htmlP += buildRow_product (label_prodName, rowID, dosageID, delayID, da3LocProd, da3Loc_PWMProdotto, "pageSingleSelection_test(" +(i+1) +")");
		da3Loc_PWMProdotto++;
		da3LocProd+= 3;
	}
	
	//product LM
	var rowID = "pageSingleSelection_P_LM";
	var dosageID = "pageSingleSelection_P_dLM";
	var delayID = "pageSingleSelection_P_qLM";
	
	htmlP += buildRow_product ("#プロダクト LM", rowID, dosageID, delayID, da3ProductLM, da3Loc_PWMProdotto, "pageSingleSelection_test(" +(i+1) +")");
	da3Loc_PWMProdotto++;

	if (da3.isGruppoVariflex() || da3.isInstant())
	{
		//htmlP += "<tr><td>ティーバッグ</td><td colspan='3'><div class='UIOption' data-option='0|0|1|1|2|2|3|3' data-da3='176' data-da3bit='8'></div></td></tr>"
		var numMaxSel = 48;
		if (da3.isCPUArch_STM32())
			numMaxSel = 60;
		htmlP += "<tr><td>SNACK</td><td colspan='3'><div id='pageSingleSelection_snackNum' class='UINumber' data-numfigures='2' data-max='" +numMaxSel +"' data-da3='176' data-da3bit='8' data-um='sel num'></div></td></tr>"
	}
	htmlP += "</table>";

	//waters & mixers
	var htmlW = "<table border='0' class='elenco'>"
				+"<tr>"
				+"	<th style='width:184px; text-align:left;'>ウオーター #</th>"
				+"	<th style='width:270px; text-align:left;'>時間</th>"
				+"	<th style='width:270px; text-align:left;'>スタートディレイ</th>";
				
				switch (WATER_COLONNA_FLOW_TYPE)
				{
				default:
					if (da3.hasWaterPWM())
						htmlW += "	<th style='text-align:left;'>PWM</th>";
					break;

				case 1: //questa e' una instant che potrebbe avere la colonna FLOW = LOW|MED|HIGH oppure, al suo posto, la colonna PWM
					if (da3.hasWaterPWM())
					{
						htmlW += "	<th style='text-align:left;'>PWM</th>";
					}
					else
					{
						htmlW += "	<th style='text-align:center;'>" +WATER_COLONNA_FLOW_TITLE +"</th>";
					}
					break;
					
				case 2:
					htmlW += "	<th style='width:155px; text-align:center;'>" +WATER_COLONNA_FLOW_TITLE +"</th>";
					if (da3.hasWaterPWM())
						htmlW += "	<th style='text-align:left;'>PWM</th>";
					break;
					
				}
			htmlW += "</tr>";
				
	var htmlM = "<table border='0' class='elenco'>"
				+"<tr>"
				+"	<th style='width:184px; text-align:left;'>MIXER #</th>"
				+"	<th style='width:290px; text-align:left;'>時間</th>"
				+"	<th style='width:290px; text-align:left;'>スタートディレイ</th>";
	if (da3.haveMixerPWM())
		htmlM +="	<th style='width:260px; text-align:center;'>PWM</th>";
	else
		htmlM +="	<th style='width:260px; text-align:center;'>速度</th>"
	htmlM += "</tr>";

				
	for (var i=0; i<SINGLESEL_NUM_ACQUE; i++)
	{
		var prodNum;
		var label_prodName;
		if (i==4)
		{
			prodNum = "LM";
			label_prodName = "#"+prodNum;
		}
		else 
		{
			prodNum = rheaLeftPad(i+1, 2, '0')
			label_prodName = "#"+prodNum;
		}
		var rowID = "pageSingleSelection_W_" +i;
		var timeID = "pageSingleSelection_W_t" +i;
		var delayID = "pageSingleSelection_W_d" +i;
		var btnTestWaterID = "pageSingleSelection_W_b" +i;
		var pwmID = "pageSingleSelection_W_pw" +i;

		var tempHtmlW ="<tr id='" +rowID +"'>"
				+"<td>" +label_prodName +"<br><div id='" +btnTestWaterID +"' class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='pageSingleSelection_test(" +(i+21) +")'></div></td>"
				+"<td align='left'><div id='" +timeID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +da3LocWater +"' data-da3bit='9' data-da3bit9='2,4' data-max='500' data-um='sec'></div></td>"
				+"<td align='left'><div id='" +delayID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +(da3LocWater+1) +"' data-da3bit='9' data-da3bit9='1,5' data-max='500' data-um='sec'></div></td>";

				
		//la colonna 3, può essere FLOW, EV-TEMP, PWM o vuota, seconda di induzione/bollitore, espresso/instant, da3.hasWaterPWM()
		var colonnaPWM = "<td align='left'><div id='" +pwmID +"' class='UISelect' data-da3='" +(da3LocWater+2) +"' data-da3bit='4' data-option='0|100%|1|95%|2|90%|3|85%|4|80%|5|75%|6|70%|7|65%|8|60%|9|55%|10|50%|11|45%|12|40%|13|35%|14|30%|15|25%'></div></td>";
		switch (WATER_COLONNA_FLOW_TYPE)
		{
		default:
			if (da3.hasWaterPWM())
				tempHtmlW += colonnaPWM;
			break;

		case 1:
			if (da3.hasWaterPWM())
			{
				tempHtmlW += colonnaPWM;
			}
			else
			{
				var waterSpeedSelector = "pageSingleSelection_W_speed" +i;
				tempHtmlW += "<td align='center'><div id='" +waterSpeedSelector +"' class='UIOption bigCaption10' data-option='0|低い|1|普通|2|高い' data-da3='" +(da3LocWater+2) +"' data-da3bit='4' data-onclick='pageSingleSelection_onEVSpeedChanged(" +(i+1) +")'></div></td>";
			}
			break;

		case 2:
			var um = "&deg;C";
			if (da3.hasWaterPWM())
				um = "";
			tempHtmlW += "<td align='center'>"
							+"<div style='float:left'>"
								+"<div id='pageSingleSelection_temp_H" +i +"' class='UINumber' data-numfigures='2' data-da3='" +da3LocEVTemperature +"' data-da3bit='8' data-min='" +LIMITE_MIN_TEMPERATURA +"' data-max='98' data-um='" +um +"' data-onChange='pageSingleSelection_adjustTemperatureWarns()'></div>"
							+"</div>"
							+"<div id='pageSingleSelection_warnTemp_H" +i +"' class='warn' style='float:right'><img src='img/alert-32.png'></div>"
							+"<div class='clear'></div>"
						+"</td>";
			da3LocEVTemperature++;
			
			if (da3.hasWaterPWM())
				tempHtmlW += colonnaPWM;
			break;
		}
		
		
		tempHtmlW += "</tr>";
		da3LocWater+= 3;	
		
		//nelle macchine Brewmatic, solo acqua 3
		if (da3.isMachine_Brewmatic4Macine())
		{
			if (i == 2)
				htmlW += tempHtmlW;
		}
		else
			htmlW += tempHtmlW;

		//mixer
		rowID = "pageSingleSelection_M_" +i;
		timeID = "pageSingleSelection_M_t" +i;
		qtyID = "pageSingleSelection_M_q" +i;
		htmlM +="<tr id='" +rowID +"'>"
				+"<td>#" +prodNum +"<br><div class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='pageSingleSelection_test(" +(i+31) +")'></div></td>"
				+"<td align='left'><div id='" +timeID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +da3LocWater +"' data-da3bit='9' data-da3bit9='2,4' data-max='500' data-um='sec'></div></td>"
				+"<td align='left'><div id='" +qtyID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +(da3LocWater+1) +"' data-da3bit='9' data-da3bit9='1,5' data-max='500' data-um='sec'></div></td>";
		if (da3.haveMixerPWM())
		{
			var da3Loc = DA3_SELECTION_EPROM2_START +10 +i;
			htmlM += "<td align='center'><div class='UINumber' data-numfigures='3' data-da3='" +da3Loc +"' data-da3bit='8' data-min='1' data-max='100' data-um='%'></div></td>";
		}
		else
			htmlM += "<td align='center'><div class='UIOption bigCaption10' data-option='1|低い|2|普通|3|高い' data-da3='" +(da3LocWater+2) +"' data-da3bit='4'></div></td>"
		htmlM +="</tr>";
		
		da3LocWater+= 3;
	}
	htmlW += "</table>";
	htmlM += "</table>";
	
	
	rheaSetDivHTMLByName("pageSingleSelection_pageE", htmlE);
	rheaSetDivHTMLByName("pageSingleSelection_pageMilker", htmlMilker);
	rheaSetDivHTMLByName("pageSingleSelection_pageP", htmlP);
	rheaSetDivHTMLByName("pageSingleSelection_pageW", htmlW);
	rheaSetDivHTMLByName("pageSingleSelection_pageM", htmlM);
	
	
	
	//moduli ext
	if (da3.doesSupportExtModule())
	{
		//modulo ext: sciroppi
		var htmlSY = "<table border='0' class='elenco'>"
					+"	<tr>"
					+"		<th style='width:184px; text-align:left;'>SYRUP #</th>"
					+"		<th style='width:290px; text-align:left;'>時間</th>"
					+"		<th style='width:290px; text-align:left;'>スタートディレイ</th>"
					+"		<th style='width:260px; text-align:center;'>PWM</th>"
					+"	</tr>";
			
		var da3Loc = DA3_SELECTION_EPROM2_START+61;
		for (var i=0; i<3; i++)
		{
			var prodNum = rheaLeftPad(i+1, 2, '0');
			var label_prodName = "#"+prodNum;
			var label_prodNameExt = da3.readASCIIString (9659 + (i*8), 8);
			if (label_prodNameExt != "" && label_prodNameExt.toUpperCase() != "NOT USED")
				label_prodName = label_prodNameExt;
			
			htmlSY += "<tr>"
					 +"<td>" +label_prodName +"<br><div class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='pageSingleSelection_test(" +(i+151) +")'></div></td>"
					 +"  <td align='left'><div id='' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +(da3Loc) +"' data-da3bit='9' data-da3bit9='2,4' data-max='500' data-um='sec'></div></td>"
					 +"  <td align='left'><div id='' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +(da3Loc+1) +"' data-da3bit='9' data-da3bit9='1,5' data-max='500' data-um='sec'></div></td>"
					 +"  <td align='left'><div id='' class='UISelect' data-da3='" +(da3Loc+2) +"' data-da3bit='4' data-option='0|100%|1|95%|2|90%|3|85%|4|80%|5|75%|6|70%|7|65%|8|60%|9|55%|10|50%|11|45%|12|40%|13|35%|14|30%|15|25%'></div></td>"
					 +"</tr>";
			da3Loc += 3;
		}
		htmlSY += "</table>";
		rheaSetDivHTMLByName("pageSingleSelection_pageExtMod_pag3", htmlSY);
		

		//modulo ext: solubili
		var htmlP = "<table border='0' class='elenco'>"
					+"<tr>"
					+"	<th style='width:184px; text-align:left;'>プロダクト #</th>"
					+"	<th style='width:290px; text-align:left;'>投与量</th>"
					+"	<th style='width:290px; text-align:left;'>スタートディレイ</th>";					
		if (da3.productsPWM_insteadOfBreaks())
			htmlP += "	<th style='width:260px; text-align:center;'>PWM</th>";
		else
			htmlP +"	<th style='width:260px; text-align:center;'>区切り</th>"
		htmlP += "</tr>";
		
		var htmlM = "<table border='0' class='elenco'>"
				+"<tr>"
				+"	<th style='width:184px; text-align:left;'>MIXER #</th>"
				+"	<th style='width:290px; text-align:left;'>時間</th>"
				+"	<th style='width:290px; text-align:left;'>スタートディレイ</th>";
		if (da3.haveMixerPWM())
			htmlM+="	<th style='width:260px; text-align:center;'>PWM</th>"
		else
			htmlM+="	<th style='width:260px; text-align:center;'>速度</th>"
		htmlM +="</tr>";
				
		var htmlW = "<table border='0' class='elenco'>"
				+"<tr>"
				+"	<th style='width:184px; text-align:left;'>ウオーター #</th>"
				+"	<th style='width:270px; text-align:left;'>時間</th>"
				+"	<th style='width:270px; text-align:left;'>スタートディレイ</th>";
				
				//macchine induzione hanno anche la colonna temperatura
				if (2 == WATER_COLONNA_FLOW_TYPE)
					htmlW += "	<th style='width:155px; text-align:center;'>" +WATER_COLONNA_FLOW_TITLE +"</th>";
				
				htmlW += "	<th style='text-align:left;'>PWM</th>";
				htmlW += "</tr>";
				
		var da3Loc_PWMProdotto = DA3_SELECTION_EPROM2_START+15; //usata solo se da3.productsPWM_insteadOfBreaks()
		var da3Loc_PWMMixer = DA3_SELECTION_EPROM2_START+17; //usata solo se da3.haveMixerPWM()
		var da3LocProd = DA3_SELECTION_EPROM2_START + 43;
		var da3LocMixer = DA3_SELECTION_EPROM2_START + 52;
		var da3LocWater = DA3_SELECTION_EPROM2_START + 49;
		var da3LocEVTemperature = DA3_SELECTION_EPROM2_START + 41;
		for (var i=21; i<23; i++)
		{
			var prodNum = rheaLeftPad(i, 2, '0'); //prod 21, 22
				
			//prodotto
			var rowID = "pageSingleSelection_P_" +i;
			var dosageID = "pageSingleSelection_P_d" +i;
			var delayID = "pageSingleSelection_P_q" +i;
			
			var label_prodNum = "#" +prodNum;
			var label_prodName = label_prodNum;

			var y = ((SINGLESEL_NUM_PRODOTTI_MAX-1)*16) + ((i-20)*16);
			var label_prodNameExt = da3.readASCIIString (9483 + y, 16);
			if (label_prodNameExt != "" && label_prodNameExt.toUpperCase() != "NOT USED")
				label_prodName = label_prodNameExt;

			htmlP += buildRow_product (label_prodName, rowID, dosageID, delayID, da3LocProd, da3Loc_PWMProdotto, "pageSingleSelection_test(" +(i+81) +")");
			da3Loc_PWMProdotto++;
			da3LocProd+= 3;		

			//mixer
			rowID = "pageSingleSelection_M_" +i;
			timeID = "pageSingleSelection_M_t" +i;
			qtyID = "pageSingleSelection_M_q" +i;
			htmlM +="<tr id='" +rowID +"'>"
					+"<td>#" +prodNum +"<br><div class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='pageSingleSelection_test(" +(i+111) +")'></div></td>"
					+"<td align='left'><div id='" +timeID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +da3LocMixer +"' data-da3bit='9' data-da3bit9='2,4' data-max='500' data-um='sec'></div></td>"
					+"<td align='left'><div id='" +qtyID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +(da3LocMixer+1) +"' data-da3bit='9' data-da3bit9='1,5' data-max='500' data-um='sec'></div></td>";
			if (da3.haveMixerPWM())
			{
				var da3Loc = da3Loc_PWMMixer + (i - 21);
				htmlM += "<td align='center'><div class='UINumber' data-numfigures='3' data-da3='" +da3Loc +"' data-da3bit='8' data-min='1' data-max='100' data-um='%'></div></td>";
			}
			else
				htmlM += "<td align='center'><div class='UIOption bigCaption10' data-option='1|低い|2|普通|3|高い' data-da3='" +(da3LocMixer+2) +"' data-da3bit='4'></div></td>"
			htmlM +="</tr>";		
			da3LocMixer+= 6;
			
			//water
			rowID = "pageSingleSelection_W_" +i;
			timeID = "pageSingleSelection_W_t" +i;
			delayID = "pageSingleSelection_W_d" +i;
			btnTestWaterID = "pageSingleSelection_W_b" +i;
			pwmID = "pageSingleSelection_W_pw" +i;
			
			htmlW +="<tr id='" +rowID +"'>"
					+"<td>#" +prodNum +"<br><div id='" +btnTestWaterID +"' class='UIButton actionButton' data-caption='&nbsp; テスト &nbsp;' data-onclick='pageSingleSelection_test(" +(i+101) +")'></div></td>"
					+"<td align='left'><div id='" +timeID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +da3LocWater +"' data-da3bit='9' data-da3bit9='2,4' data-max='500' data-um='sec'></div></td>"
					+"<td align='left'><div id='" +delayID +"' class='UINumber' data-numfigures='3' data-decimal='1' data-da3='" +(da3LocWater+1) +"' data-da3bit='9' data-da3bit9='1,5' data-max='500' data-um='sec'></div></td>";

					
			//la colonna 3, può essere FLOW, EV-TEMP, PWM o vuota, seconda di induzione/bollitore, espresso/instant, da3.hasWaterPWM()
			if (2 == WATER_COLONNA_FLOW_TYPE)
			{
				var um = "&deg;C";
				if (da3.hasWaterPWM())
					um = "";
				htmlW += "<td align='center'><div id='pageSingleSelection_temp_H" +i +"' class='UINumber' data-numfigures='2' data-da3='" +da3LocEVTemperature +"' data-da3bit='8' data-min='" +LIMITE_MIN_TEMPERATURA +"' data-max='98' data-um='" +um +"'></div></td>";
				da3LocEVTemperature++;
			}
			
			htmlW += "<td align='left'><div id='" +pwmID +"' class='UISelect' data-da3='" +(da3LocWater+2) +"' data-da3bit='4' data-option='0|100%|1|95%|2|90%|3|85%|4|80%|5|75%|6|70%|7|65%|8|60%|9|55%|10|50%|11|45%|12|40%|13|35%|14|30%|15|25%'></div></td>";
			htmlW += "</tr>";
			da3LocWater+= 6;				
		}
		
		htmlP += "</table>";
		htmlM += "</table>";
		htmlW += "</table>";

		rheaSetDivHTMLByName("pageSingleSelection_pageExtMod_pag0", htmlP);
		rheaSetDivHTMLByName("pageSingleSelection_pageExtMod_pag1", htmlW);
		rheaSetDivHTMLByName("pageSingleSelection_pageExtMod_pag2", htmlM);
	}
}

function pageSingleSelection_onEVSpeedChanged(ev1_5)
{
	var win = ui.getWindowByID("pageSingleSelection");
	var o = win.getChildByID("pageSingleSelection_W_t" +(ev1_5-1));
	
	var speed0_2 = 0;
	
	if (da3.isInstant())
	{
		var waterSpeedSelector = "pageSingleSelection_W_speed" +(ev1_5-1);
		var oSpeed = win.getChildByID(waterSpeedSelector);
		if (null != oSpeed)
			speed0_2 = parseInt(oSpeed.getSelectedOptionValue());
	}
	
//console.log ("pageSingleSelection_onEVSpeedChanged=" +ev1_5 +", speed=" +speed0_2);
	if (da3.isEVPumpCalibrated(ev1_5, speed0_2))
	{
		o.setDecimals(0);
		o.changeUM("cc");
	}
	else
	{
		o.setDecimals(1);
		o.changeUM("sec");
	}
}

function pageSingleSelection_adjustTemperatureWarns()
{
	var win = ui.getWindowByID("pageSingleSelection");
	var w = win.getChildByID("pageSingleSelection_temp1");
	if (w != null)
		rheaHideElem(rheaGetElemByID("pageSingleSelection_warnTemp1"));

	for (var i=0; i<SINGLESEL_NUM_ACQUE; i++)
	{
		w = win.getChildByID("pageSingleSelection_temp_H" +i);
		if (null == w)
			continue;
	
		rheaHideElem(rheaGetElemByID("pageSingleSelection_warnTemp_H" +i));	
	}

	//GB: commentata in quanto hanno cambiato idea, niente warning e limite minimo impostato a 75, ma la soluzione non è definitiva, potrebbe ricambiare in futuro
	/*var win = ui.getWindowByID("pageSingleSelection");
	
	var w = win.getChildByID("pageSingleSelection_temp1");
	if (w != null)
	{
		if (w.getValue() < LIMITE_MIN_TEMPERATURA)
			rheaShowElem(rheaGetElemByID("pageSingleSelection_warnTemp1"));
		else
			rheaHideElem(rheaGetElemByID("pageSingleSelection_warnTemp1"));
	}
		
	for (var i=0; i<SINGLESEL_NUM_ACQUE; i++)
	{
		w = win.getChildByID("pageSingleSelection_temp_H" +i);
		if (null == w)
			continue;
	
		if (w.getValue() < LIMITE_MIN_TEMPERATURA)
			rheaShowElem(rheaGetElemByID("pageSingleSelection_warnTemp_H" +i));
		else
			rheaHideElem(rheaGetElemByID("pageSingleSelection_warnTemp_H" +i));	
	}
	*/
}

function pageSingleSelection_hideIfDosageIsZero (win, dosageID, rowID)
{
	var e = rheaGetElemByID(rowID);
	if (e === undefined)
		return;
	if (parseInt(win.getChildByID(dosageID).getValue()) == 0)
		rheaHideElem(e);
}

function pageSingleSelection_onProgramming()
{
	var win = ui.getWindowByID("pageSingleSelection");
	var partial = parseInt(win.getChildByID("pageSingleSelection_programming").getSelectedOptionValue());
	pageSingleSelection_showPartialFull (win, partial);
}

function pageSingleSelection_showPartialFull (win, bPartial)
{
	if (bPartial==1)
	{
		for (var i=0; i<SINGLESEL_NUM_PRODOTTI; i++)
			pageSingleSelection_hideIfDosageIsZero (win, "pageSingleSelection_P_d" +i, "pageSingleSelection_P_" +i);
		pageSingleSelection_hideIfDosageIsZero (win, "pageSingleSelection_P_dLM", "pageSingleSelection_P_LM");
		
		for (var i=0; i<SINGLESEL_NUM_ACQUE; i++)
		{
			pageSingleSelection_hideIfDosageIsZero (win, "pageSingleSelection_W_t" +i, "pageSingleSelection_W_" +i);
			pageSingleSelection_hideIfDosageIsZero (win, "pageSingleSelection_M_t" +i, "pageSingleSelection_M_" +i);
		}
	}
	else
	{
		for (var i=0; i<SINGLESEL_NUM_PRODOTTI; i++)
		{
			var rowID = "pageSingleSelection_P_" +i;
			rheaSetDisplayMode(rheaGetElemByID(rowID), "table-row");
		}
		
		rheaSetDisplayMode(rheaGetElemByID("pageSingleSelection_P_LM"), "table-row");
		
		for (var i=0; i<SINGLESEL_NUM_ACQUE; i++)
		{
			var rowID = "pageSingleSelection_W_" +i;
			var e = rheaGetElemByID(rowID);
			if (e != undefined)
				rheaSetDisplayMode(e, "table-row");
			
			rowID = "pageSingleSelection_M_" +i;
			rheaSetDisplayMode(rheaGetElemByID(rowID), "table-row");
		}		
	}
	
	win.showHideScrollBar();
}

function pageSingleSelection_onStatus()
{
	pageSingleSelection_onProgramming();
	pageSingleSelection_onSelector();
	pageSingleSelection_onExtSelector();

	var win = ui.getWindowByID("pageSingleSelection");
	var page = parseInt(win.getChildByID("pageSingleSelection_status").getSelectedOptionValue());
	switch (page)
	{
		case 0: //selection
		case 3: //drip filter/low pressure
			rheaShowElem(rheaGetElemByID("pageSingleSelection_selector"));
			rheaShowElem(rheaGetElemByID("pageSingleSelection_pageSel")); 
			rheaShowElem(rheaGetElemByID("footerBtnTestSelection"));
			rheaShowElem_TR(rheaGetElemByID("pageSingleSelection_pageSel_rowSelRepeat"));
			if (!da3.isGruppoMicro())
				rheaShowElem_TR(rheaGetElemByID("pageSingleSelection_pageSel_rowJug"));
			
			for (var i=0; i<SINGLESEL_NUM_ACQUE; i++)
			{
				var btnTestWaterID = "pageSingleSelection_W_b" +i;
				rheaShowElem_TABLE(rheaGetElemByID(btnTestWaterID));
			}
			
			if (da3.isEspresso())	
			{
				if (page == 3)
				{
					rheaShowElem(rheaGetElemByID("pageSingleSelection_dripFilterOption"));

					//NST ha deciso dei valori di default per questi parametri. Mi accerto di valorizzare i campi correttamente
					//2024-12-18: a seguito di modifiche al fn del gruppo, questo valore 60% non riflette piu' il vero valore di CPU. dato
					//che il campo e' cmq stato "bloccato", lo elimino del tutto in favore di una label
					//win.getChildByID("pageSingleSelection_A1").selectOptionByValue(60);
					
					//202-12-09 NST ha deciso di "sbloccare" A2 A3 A5
					//win.getChildByID("pageSingleSelection_A2").setValue(3);
					//win.getChildByID("pageSingleSelection_A3").setValue(1);
					//win.getChildByID("pageSingleSelection_A5").setValue(3);
					
					var obj = win.getChildByID("pageSingleSelection_A7");
					if (obj.getValue() == 0)
						obj.setValue(95);
				}
				else
					rheaHideElem(rheaGetElemByID("pageSingleSelection_dripFilterOption"));
			}
			break;
			
		case 1: //inhibit
			rheaHideElem(rheaGetElemByID("pageSingleSelection_pageSel")); 
			rheaHideElem(rheaGetElemByID("pageSingleSelection_selector"));
			rheaHideElem(rheaGetElemByID("footerBtnTestSelection"));
			break;
		
		case 2: //presel
			rheaHideElem(rheaGetElemByID("pageSingleSelection_pageSel")); 
			rheaHideElem(rheaGetElemByID("pageSingleSelection_selector"));
			rheaHideElem(rheaGetElemByID("footerBtnTestSelection"));
			break;
			
		case 4: //fountain
			rheaShowElem(rheaGetElemByID("pageSingleSelection_selector"));
			rheaShowElem(rheaGetElemByID("pageSingleSelection_pageSel"));
			rheaHideElem(rheaGetElemByID("pageSingleSelection_pageSel_rowJug"));
			rheaHideElem(rheaGetElemByID("pageSingleSelection_pageSel_rowSelRepeat"));
			rheaHideElem(rheaGetElemByID("footerBtnTestSelection"));
			
			for (var i=0; i<SINGLESEL_NUM_ACQUE; i++)
			{
				var btnTestWaterID = "pageSingleSelection_W_b" +i;
				rheaHideElem(rheaGetElemByID(btnTestWaterID));
			}
			break;		
	}

	var s = win.getChildByID("pageSingleSelection_selector");
	if (page == 4)
	{
		s.hideOptionByValue(1); //tab espresso
		s.hideOptionByValue(2); //tab product
		s.hideOptionByValue(4); //tab mixer
		s.hideOptionByValue(5); //tab milker
	}
	else
		s.unhideAllOptions();

	win.showHideScrollBar();
}


function pageSingleSelection_onExtSelector()
{
	var elemP = rheaGetElemByID("pageSingleSelection_pageExtMod_pag0");
	var elemW = rheaGetElemByID("pageSingleSelection_pageExtMod_pag1");
	var elemM = rheaGetElemByID("pageSingleSelection_pageExtMod_pag2");
	var elemSY = rheaGetElemByID("pageSingleSelection_pageExtMod_pag3");
		
	rheaHideElem(elemP);
	rheaHideElem(elemW);
	rheaHideElem(elemM);
	rheaHideElem(elemSY);
	
	var win = ui.getWindowByID("pageSingleSelection");
	switch (parseInt(win.getChildByID("pageSingleSelection_selectorExt").getSelectedOptionValue()))
	{
		case 0: rheaShowElem(elemP); break;
		case 1: rheaShowElem(elemW); break;
		case 2: rheaShowElem(elemM); break;
		case 3: rheaShowElem(elemSY); break;
	}
	win.showHideScrollBar();
}


function pageSingleSelection_onSelector()
{
	var elemG = rheaGetElemByID("pageSingleSelection_pageG");
	var elemE = rheaGetElemByID("pageSingleSelection_pageE");
	var elemMilker = rheaGetElemByID("pageSingleSelection_pageMilker");
	var elemP = rheaGetElemByID("pageSingleSelection_pageP");
	var elemW = rheaGetElemByID("pageSingleSelection_pageW");
	var elemM = rheaGetElemByID("pageSingleSelection_pageM");
	var elemExtMod = rheaGetElemByID("pageSingleSelection_pageExtMod");
	rheaHideElem(elemG);
	rheaHideElem(elemE);
	rheaHideElem(elemP);
	rheaHideElem(elemW);
	rheaHideElem(elemM);
	rheaHideElem(elemMilker);
	rheaHideElem(elemExtMod);
	
		
	var win = ui.getWindowByID("pageSingleSelection");
	switch (parseInt(win.getChildByID("pageSingleSelection_selector").getSelectedOptionValue()))
	{
		case 0: rheaShowElem(elemG); break;
		case 1: rheaShowElem(elemE); break;
		case 2: rheaShowElem(elemP); break;
		case 3: rheaShowElem(elemW); break;
		case 4: rheaShowElem(elemM); break;
		case 5: rheaShowElem(elemMilker); break;
		case 10: rheaShowElem(elemExtMod); break;
		
	}
	win.showHideScrollBar();
}


var ajax_testSelection_nRetry = 0;
function pageSingleSelection_test (iAttuatore)
{
	console.log ("pageSingleSelection_test:: selnum[" +pageSingleSelection_curSel +"] attuatore[" +iAttuatore +"]");
	//prima di tutto salvo e spedisco la ricetta alla CPU
	ajax_testSelection_nRetry = 3;
	save( function(){ pageSingleSelection_test_afterSave(iAttuatore); } );
}

function pageSingleSelection_test_afterSave(iAttuatore)
{
	//invio il comando alla CPU e aspetto che la CPU finisca
	pleaseWait_show();
	currentTask = new TaskTestSelezione(pageSingleSelection_curSel, iAttuatore);
}

function pageSingleSelection_test_onFinish()
{
	//console.log ("pageSingleSelection_test_onFinish");
	currentTask = voidTask;
	pleaseWait_hide();
}


/***************************************************************************
 *
 * pageTemperature
 *
 */
var PIN_CODE_FUSION3 = 243;
var pageTemperature_x9PrevValue = 0; 
function pageTemperature_show()
{
	var win = ui.getWindowByID("pageTemperature");
	if (showPage("pageTemperature", "温度", 1,1))
	{
		//è la prima volta che visualizziamo la pagina
		win.getChildByID("pageTemperature_selector").selectOptionByValue(0);
		pageTemperature_onSelector();
		
		if (!da3.hasCapab_CICLO_FIRST_COFFEE())
			rheaHideElem(rheaGetElemByID("pageTemperature_selectorCnt"));
	}
	
	pageTemperature_x9PrevValue = win.getChildByID("pageTemperature_1_x9").getValue();
	pageTemperature_adjustTemperatureWarns();
	pageTemperature_onX9Changed();
	currentTask = new TaskTemperature();
}

function pageTemperature_onX9Changed()
{
	var win = ui.getWindowByID("pageTemperature");
	var uiX9 = win.getChildByID("pageTemperature_1_x9");
	var x9CurValue = uiX9.getValue();
	
	if (pageTemperature_x9PrevValue == 0 && x9CurValue!=0)
		currentTask.showPopupConfirmX9();
	else
		pageTemperature_onX9Changed_confirmed();
}

function pageTemperature_askX9PIN (userEnteredPIN)
{
	//chiedo anche un PIN di conferma
	pagePinCode_doShowAndTrapOnEnd (pageTemperature_on_askX9PIN_entered);
}

function pageTemperature_on_askX9PIN_entered(userEnteredPIN)
{
	pagePinCode_hide();
	if (userEnteredPIN == PIN_CODE_FUSION3)
		pageTemperature_onX9Changed_confirmed();
	else
		pageTemperature_onX9Changed_abort();
}

function pageTemperature_onX9Changed_confirmed()
{
	var win = ui.getWindowByID("pageTemperature");
	var uiX9 = win.getChildByID("pageTemperature_1_x9");
	var x9CurValue = uiX9.getValue();
	pageTemperature_x9PrevValue = x9CurValue;
	
	if (x9CurValue == 0)
		rheaHideElem(rheaGetElemByID("pageTemperature_1_params"));
	else
		rheaShowElem_TABLE(rheaGetElemByID("pageTemperature_1_params"));
	win.showHideScrollBar();
}

function pageTemperature_onX9Changed_abort()
{
	var win = ui.getWindowByID("pageTemperature");
	var uiX9 = win.getChildByID("pageTemperature_1_x9");
	x9CurValue = uiX9.setValue(0);
	pageTemperature_x9PrevValue = 0;

}

function pageTemperature_adjustTemperatureWarns()
{
	var win = ui.getWindowByID("pageTemperature");
	
	for (var i=1; i<=2; i++)
	{
		var w = win.getChildByID("pageTemperature_temp" +i);
		if (w != null)
		{
			if (w.getValue() < LIMITE_MIN_TEMPERATURA)
				rheaShowElem(rheaGetElemByID("pageTemperature_warnTemp" +i));
			else
				rheaHideElem(rheaGetElemByID("pageTemperature_warnTemp" +i));
		}
	}
}

function pageTemperature_build()
{
	var html = "<table border='0' class='elenco'>"
			   +"	<tr style='height:30px;'><td colspan='3' align='center'><div id='pageTemperature_live'  class='tip'></div></td></tr>";

	if (da3.isInstant())
	{
		//boiler & delta
		html += "<tr>"
					+"<td style='width:350px'>ボイラー<div id='pageTemperature_warnTemp1' class='warn'>Rheavendorsは最低温度75℃以上を推奨しています</div></td>"
					+"<td><div id='pageTemperature_temp1' class='UINumber' data-numfigures='2' data-decimal='0' data-min='" +LIMITE_MIN_TEMPERATURA +"' data-max='92' data-da3='7032' data-da3bit='8' data-um='&deg;C' data-onChange='pageTemperature_adjustTemperatureWarns()'></div></td>"
				+"</tr>"
			    +"<tr><td>DELTA</td><td><div class='UINumber' data-numfigures='2' data-decimal='0' data-max='16' data-da3='7042' data-da3bit='8' data-um='&deg;C'></div></td></tr>";
	}
	else
	{
		var hasHeaterTemp = 1;
		if (da3.isGruppoMicro())
			hasHeaterTemp = 0;
	
		if (da3.isInduzione())
		{
			//solo temp heater (aka camera caffe')
			if (hasHeaterTemp)
				html += "<tr><td>ヒータ</td><td><div class='UINumber' data-numfigures='2' data-decimal='0' data-max='40' data-da3='7032' data-da3bit='8' data-um='&deg;C'></div></td></tr>";
		}
		else
		{
			//(espresso qui significa bollitore, heater significa camera caffe')
			html += "<tr>"
						+"<td style='width:350px'>ESPRESSO<div id='pageTemperature_warnTemp2' class='warn'>Rheavendorsは最低温度75℃以上を推奨しています</div></td>"
						+"<td><div id='pageTemperature_temp2' class='UINumber' data-numfigures='3' data-decimal='0' data-min='" +LIMITE_MIN_TEMPERATURA +"' data-max='120' data-da3='7032' data-da3bit='8' data-um='&deg;C' data-onChange='pageTemperature_adjustTemperatureWarns()'></div></td>"
					+"</tr>"
					+"<tr><td>DELTA</td><td><div class='UINumber' data-numfigures='2' data-decimal='0' data-max='25' data-da3='7042' data-da3bit='8' data-um='&deg;C'></div></td></tr>"
					+"<tr><td>最初のコーヒー</td><td><div class='UINumber' data-numfigures='2' data-decimal='0' data-max='30' data-da3='7034' data-da3bit='8' data-um=''></div></td></tr>"
					+"<tr><td>加熱時間</td><td><div class='UINumber' data-numfigures='3' data-decimal='1' data-max='100' data-da3='7036' data-da3bit='8' data-um='sec'></div></td></tr>";
				   
			if (hasHeaterTemp)
				html += "<tr><td>ヒータ</td><td><div class='UINumber' data-numfigures='2' data-decimal='0' data-max='40' data-da3='7040' data-da3bit='8' data-um='&deg;C'></div></td></tr>";
		}
	}	
	html += "</table>";
	rheaSetDivHTMLByName("pageTemperature_0", html);
}

function  pageTemperature_onSelector()
{
	var elem0 = rheaGetElemByID("pageTemperature_0");
	var elem1 = rheaGetElemByID("pageTemperature_1");
	
	rheaHideElem(elem0);
	rheaHideElem(elem1);
	
	var win = ui.getWindowByID("pageTemperature");
	switch (parseInt(win.getChildByID("pageTemperature_selector").getSelectedOptionValue()))
	{
		default:
		case 0: rheaShowElem(elem0); break;
		case 1: rheaShowElem(elem1); break;
	}
	win.showHideScrollBar();
}

/***************************************************************************
 *
 * pageClock
 *
 */
function pageClock_show()
{
	var win = ui.getWindowByID("pageClock");
	if (showPage("pageClock", "時計", 1,1))
	{
		//è la prima volta che visualizziamo la pagina
		var selOptions = "0|時計";

		if (!da3.hasCapab_NO_PAYMENT_SYSTEM())
			selOptions += "|1|HAPPY HOUR";
			
		selOptions += "|2|ENERGY SAVING";
		var uiSelector = win.getChildByID("pageClock_selector");
		uiSelector.changeOptions (selOptions);
		uiSelector.selectOptionByIndex(0);
		
		rheaHideElem(rheaGetElemByID("pageClock_tab1_setClock"));
		rheaHideElem(rheaGetElemByID("pageClock_tab1_setDate"));
	}
	
	pageClock_onSelector();
	
	//dyn energu save
	if (da3.isCPUArch_STM32())
	{
		var o = win.getChildByID("pageClock_energySave_dynEnSav_time");
		if (parseInt(o.getValue()) == 0)
			win.getChildByID("pageClock_energySave_dynEnSav").selectOptionByValue(0);
		else
			win.getChildByID("pageClock_energySave_dynEnSav").selectOptionByValue(1);
		pageClock_onDynEnSaveChanged();
		
		if (da3.isInduzione())
			rheaHideElem (rheaGetElemByID("pageClock_dyn_en_save_Stm32"));
	}
	else
	{
		rheaHideElem (rheaGetElemByID("pageClock_dyn_en_save_Stm32"));
	}

	
	if (bGotoHMIAfterLavaggio==1)
		btnBack_setCallback ("gotoHMI()");	
	
	
	//sincronizzo data e ora
	pageClock_syncTime();
	pageClock_syncDate();
}

function pageClock_onDynEnSaveChanged()
{
	var win = ui.getWindowByID("pageClock");
	
	switch (parseInt(win.getChildByID("pageClock_energySave_dynEnSav").getSelectedOptionValue()))
	{
		default:
			rheaHideElem (rheaGetElemByID("pageClock_energySave_dynEnSav_tr2"));
			win.getChildByID("pageClock_energySave_dynEnSav_time").setValue(0);
			break;
			
		case 1:
			rheaShowElem_TR (rheaGetElemByID("pageClock_energySave_dynEnSav_tr2"));
			break;
	}
	
	ui.getWindowByID("pageClock").showHideScrollBar();
	
}

var pageClock_blinkStatus = 0xff;
function pageClock_blinkButtons()
{
console.log ("pageClock_blinkButtons: " +pageClock_blinkStatus);
	var s1 = rheaGetElemByID("pageClock_tab1_setClock");
	var s2 = rheaGetElemByID("pageClock_tab1_setDate");
	
	if (s1.style.display=="none" && s2.style.display=="none")
	{
		pageClock_blinkStatus = 0xff;
		return;
	}
	
	if (pageClock_blinkStatus == 0)
	{
		pageClock_blinkStatus = 1;
		rheaAddClassToElem(s1, "highlight");
		rheaAddClassToElem(s2, "highlight");
	}
	else
	{
		pageClock_blinkStatus = 0;
		if (s1.classList.contains("highlight"))
			rheaRemoveClassToElem(s1, "highlight");
		if (s2.classList.contains("highlight"))
			rheaRemoveClassToElem(s2, "highlight");
	}
	
	setTimeout(pageClock_blinkButtons, 800);
}

function pageClock_onClockChanged()
{
	rheaShowElem(rheaGetElemByID("pageClock_tab1_setClock"));
	if (0xff == pageClock_blinkStatus)
		pageClock_blinkButtons();
}

function pageClock_onDateChanged()
{
	rheaShowElem(rheaGetElemByID("pageClock_tab1_setDate"));
	if (0xff == pageClock_blinkStatus)
		pageClock_blinkButtons();
}

function pageClock_showPageHappy()
{
	var win = ui.getWindowByID("pageClock");
	var selector = win.getChildByID("pageClock_selector");
	selector.selectOptionByValue(1);
	pageClock_onSelector();
	rheaHideElem(rheaGetElemByID("pageClock_selector"));
}

function pageClock_syncTime()
{	
	//console.log ("ajax::getTime");
	rhea.ajax ("getTime", "").then( function(result)
	{
		var win = ui.getWindowByID("pageClock");
		var obj = win.getChildByID("pageClock_time");
		
		var data = JSON.parse(result);
		obj.setValueHH(data.h);
		obj.setValueMM(data.m);
		dataOra_setup();
	})
	.catch( function(result)
	{
		setTimeout ( function() {pageClock_syncTime();}, 200);
	});
}

function pageClock_syncDate()
{
	//console.log ("ajax::getDate");
	rhea.ajax ("getDate", "").then( function(result)
	{
		var data = JSON.parse(result);

		var win = ui.getWindowByID("pageClock");
		win.getChildByID("pageClock_dd").setValue(data.d);
		win.getChildByID("pageClock_mm").setValue(data.m);
		win.getChildByID("pageClock_yy").setValue(data.y);
		dataOra_setup();
	})
	.catch( function(result)
	{
		setTimeout ( function() {pageClock_syncDate();}, 200);
	});	
}

function pageClock_onSelector()
{
	var elemClock = rheaGetElemByID("pageClock_clock");
	var elemHH = rheaGetElemByID("pageClock_happyHour");
	var elemES = rheaGetElemByID("pageClock_energySave");
	
	rheaHideElem(elemClock);
	rheaHideElem(elemHH);
	rheaHideElem(elemES);
	
	var win = ui.getWindowByID("pageClock");
	switch (parseInt(win.getChildByID("pageClock_selector").getSelectedOptionValue()))
	{
		default: rheaShowElem(elemClock); break;
		case 1:  rheaShowElem(elemHH); break;
		case 2:  rheaShowElem(elemES); break;
	}
	
	ui.getWindowByID("pageClock").showHideScrollBar();
}

function pageClock_setTime()
{
	var win = ui.getWindowByID("pageClock");
	var obj = win.getChildByID("pageClock_time");
	rheaHideElem(rheaGetElemByID("pageClock_tab1_setClock"));
	
	pleaseWait_show();
	//console.log ("ajax::setTime");
	rhea.ajax ("setTime", { "h":obj.getValueHH(), "m":obj.getValueMM(), "s":0}).then( function(result)
	{
		pleaseWait_hide();
		pageClock_syncTime();
	})
	.catch( function(result)
	{
		setTimeout ( function() { pageClock_setTime(); }, 200);
	});
}

function pageClock_setDate()
{
	var win = ui.getWindowByID("pageClock");
	var yy = win.getChildByID("pageClock_yy").getValue();
	var mm = win.getChildByID("pageClock_mm").getValue();
	var dd = win.getChildByID("pageClock_dd").getValue();
	rheaHideElem(rheaGetElemByID("pageClock_tab1_setDate"));	
	pleaseWait_show();
	//console.log ("ajax::setDate");
	rhea.ajax ("setDate", { "y":yy, "m":mm, "d":dd}).then( function(result)
	{
		pleaseWait_hide();
		pageClock_syncDate();
	})
	.catch( function(result)
	{
		setTimeout ( function() { pageClock_setDate(); }, 200);
	});
}

/***************************************************************************
 *
 * pageCalibration (instant)
 *
 */
function pageCalibration_show()
{
	if (showPage("pageCalibration", "パウダー<br>キャリブレーション", 1,0))
	{
		//è la prima volta che visualizziamo la pagina
		pageCalibration_onSelector();
		
		if (!da3.hasCapab_CPU_CALIB_POMPE_SOLUBILI())
			rheaHideElem(rheaGetElemByID("pageCalibration_selectorCnt"));
		
		var htmlEVPumpCalibTable = "<table border='0' class='elenco'>"
		if (da3.isEspresso())
		{
			//nascondo motor 1 e motor 2
			rheaHideElem (rheaGetElemByID("pageCalibration_rowMotor1"));
			rheaHideElem (rheaGetElemByID("pageCalibration_rowMotor2"));

			//creo la tabella per la calibrazione delle EV PUMP
			htmlEVPumpCalibTable += "<tr>"
									+"<td style='width:180px'>ウオーター 1</td>"
									+"<td style='width:244px;'><div id='pageCalibration_w1'></div></td>"
									+"<td style='width:300px'><div class='UIButton bigButton60 actionButton' onclick='pageCalibration_waterreset(1,0)'><p>リセット</p></div></td>"
									+"<td style='width:300px'><div class='UIButton bigButton60 actionButton' onclick='pageCalibration_waterstart(1,0)'><p>校正</p></div></td></tr>";
		}
		else
		{
			//creo la tabella per la calibrazione delle EV PUMP
			htmlEVPumpCalibTable += "<tr>"
									+"<td style='width:180px'>ウオーター 1</td>"
									+"<td style='width:244px;'><div id='pageCalibration_w1'></div></td>"
									+"<td style='width:300px'><div class='UIButton bigButton60 actionButton' onclick='pageCalibration_choosePumpSpeed(1)'><p>リセット</p></div></td>"
									+"<td style='width:300px'><div class='UIButton bigButton60 actionButton' onclick='pageCalibration_choosePumpSpeed(1)'><p>校正</p></div></td></tr>";
			for (var i=2; i<=5; i++)
			{
				htmlEVPumpCalibTable += "<tr>"
										+"<td>ウオーター " +i +"</td>"
										+"<td><div id='pageCalibration_w" +i +"'></div></td>"
										+"<td><div class='UIButton bigButton60 actionButton' onclick='pageCalibration_choosePumpSpeed(" +i +")'><p>リセット</p></div></td>"
										+"<td><div class='UIButton bigButton60 actionButton' onclick='pageCalibration_choosePumpSpeed(" +i +")'><p>校正</p></div></td></tr>";
			}
		}
		
		if (da3.doesSupportExtModule())
		{
			rheaShowElem_TR (rheaGetElemByID("pageCalibration_rowMotor21"));
			rheaShowElem_TR (rheaGetElemByID("pageCalibration_rowMotor22"));		
		}
		
		htmlEVPumpCalibTable+= "</table>";
		rheaSetDivHTMLByName ("pageCalibration_1", htmlEVPumpCalibTable);
	}

	pageCalibration_refreshCalibValueOnScreen();
	currentTask = taskCalibMotor;
}

function pageCalibration_onSelector()
{
	var elem0 = rheaGetElemByID("pageCalibration_0");
	var elem1 = rheaGetElemByID("pageCalibration_1");
	
	rheaHideElem(elem0);
	rheaHideElem(elem1);
	
	var win = ui.getWindowByID("pageCalibration");
	switch (parseInt(win.getChildByID("pageCalibration_selector").getSelectedOptionValue()))
	{
		default:
		case 0: rheaShowElem(elem0); break;
		case 1: rheaShowElem(elem1); break;
	}
	win.showHideScrollBar();
}

function pageCalibration_refreshCalibValueOnScreen()
{
	if (da3.isInstant())
	{
		for (var i=1; i<=6; i++)
		{
			var v = helper_intToFixedOnePointDecimal( da3.getCalibFactorGSec(i) );
			rheaSetDivHTMLByName("pageCalibration_m" +i, v +"&nbsp;gr/sec");
		}
	}
	else
	{
		//motori
		for (var i=1; i<=6; i++)
		{
			v = helper_intToFixedOnePointDecimal( da3.getCalibFactorGSec(i) );
			rheaSetDivHTMLByName("pageCalibration_m" +i, v +"&nbsp;gr/sec");
		}
	}
	
	if (da3.doesSupportExtModule())
	{
		for (var i=21; i<=22; i++)
		{
			v = helper_intToFixedOnePointDecimal( da3.getCalibFactorGSec(i) );
			rheaSetDivHTMLByName("pageCalibration_m" +i, v +"&nbsp;gr/sec");
		}
	}

	//pompe solubili
	if (da3.isInstant())
	{
		for (var i=1; i<=5; i++)
		{
			var v1 = helper_intToFixedOnePointDecimal( da3.getFattCalibPompeSolubile(i,0) );
			var v2 = helper_intToFixedOnePointDecimal( da3.getFattCalibPompeSolubile(i,1) );
			var v3 = helper_intToFixedOnePointDecimal( da3.getFattCalibPompeSolubile(i,2) );
			var s= v1 +" cc/sec<br>" +v2 +" cc/sec<br>"+ v3 +" cc/sec";
			rheaSetDivHTMLByName("pageCalibration_w" +i, s);
		}	
	}
	else
	{
		var v1 = helper_intToFixedOnePointDecimal( da3.getFattCalibPompeSolubile(i,0) );
		var s= v1 +" cc/sec";
		rheaSetDivHTMLByName("pageCalibration_w1", s);
	}
	
	ui.getWindowByID("pageCalibration").showHideScrollBar();
}

var pageCalibration_curEVPump = 0;
function pageCalibration_choosePumpSpeed(ev1_5)
{
	pageCalibration_curEVPump = ev1_5;
	taskCalibMotor.showPopupCalibrazioneEVPump(ev1_5);
}

function pageCalibration_waterreset(ev1_5, speed0_2)
{
	pleaseWait_calibEVPump_hide();
	if (ev1_5 == 0xff)
		ev1_5 = pageCalibration_curEVPump;

	pleaseWait_show();
	if (da3.isEspresso())
	{
		da3.setFattCalibPompeSolubile (ev1_5, 0, 0);
		da3.setFattCalibPompeSolubile (ev1_5, 1, 0);
		da3.setFattCalibPompeSolubile (ev1_5, 2, 0);	
		da3.setFattCalibPompeSolubile (5, 0, 0);
		da3.setFattCalibPompeSolubile (5, 1, 0);
		da3.setFattCalibPompeSolubile (5, 2, 0);
	}
	else
		da3.setFattCalibPompeSolubile (ev1_5, speed0_2, 0);
		
	setTimeout (
		function()
		{
			save (function() { 		
				rhea.ajax ("reloadWaterCalibFactor", "").then( function(result) { pageCalibration_refreshCalibValueOnScreen(); pleaseWait_hide(); })
				.catch( function(result) { pageCalibration_refreshCalibValueOnScreen(); pleaseWait_hide(); });
			});
		},
		100);
}

function pageCalibration_waterstart (ev1_5, speed0_2)
{
	pleaseWait_calibEVPump_hide();
	if (ev1_5 == 0xff)
		ev1_5 = pageCalibration_curEVPump;

	pleaseWait_show();
	taskCalibMotor.startCalibrazioneEVPump (ev1_5, speed0_2);
}

function pageCalibration_onFinishWater ()
{
	if (da3.isEspresso())
	{
		da3.setFattCalibPompeSolubile (5, 0, da3.getFattCalibPompeSolubile(1,0));
	}
	save (function() { 		
		rhea.ajax ("reloadWaterCalibFactor", "").then( function(result) { pageCalibration_refreshCalibValueOnScreen(); pleaseWait_hide(); })
		.catch( function(result) { pageCalibration_refreshCalibValueOnScreen(); pleaseWait_hide(); });
	});	
}

function pageCalibration_reset(motor)
{
	pleaseWait_show();
	rhea.ajax ("setFattoreCalib", { "m":motor, "v":0}).then( function(result)
	{
		rheaSetDivHTMLByName("pageCalibration_m" +motor, "0&nbsp;gr/sec");
		da3.setCalibFactorGSec(motor, 0);

		setTimeout (
			function()
			{
				save (function() { pleaseWait_hide();});
			},
			1000);
	})
	.catch( function(result)
	{
		pleaseWait_hide();
	});
}

function pageCalibration_start (motor)
{
	pleaseWait_show();
	
	var bAlsoCalcImpulses = 1;
	if (da3.isGruppoMicro())
		bAlsoCalcImpulses = 0;
	if (motor == 11)
		taskCalibMotor.startCalibrazioneMacina(1, bAlsoCalcImpulses);
	else if (motor == 12)
		taskCalibMotor.startCalibrazioneMacina(2, bAlsoCalcImpulses);
	else
		taskCalibMotor.startMotorCalib(motor);
}

function pageCalibration_onFinish ()
{
	if (currentPageID == "pageExpCalib")
		pageExpCalib_onFinish();
	else
	{
		save (function() { 		
			pageCalibration_refreshCalibValueOnScreen(); pleaseWait_hide();
		});
	}
}

function pageCalibration_grindAgain()
{
	pleaseWait_calibration_varigrind_hide();
	pleaseWait_calibration_num_hide();
	pleaseWait_btn1_hide();
	pleaseWait_calibration_setText("");
	taskCalibMotor.fase = 10;
}

function pageCalibration_setVGrind()
{
	pleaseWait_calibration_varigrind_hide();
	pleaseWait_calibration_num_hide();
	pleaseWait_btn1_hide();
	pleaseWait_calibration_setText("");
	taskCalibMotor.fase = 25;
}

function pageCalibration_runMotorAgain()
{
	pleaseWait_calibration_motor_hide();
	pleaseWait_calibration_num_hide();
	pleaseWait_btn1_hide();
	pleaseWait_calibration_setText("");
	taskCalibMotor.fase = 0;
}

/***************************************************************************
 *
 * pagePayment
 *
 */
var pagePayment_interval1 = 0;
function pagePayment_show()
{
	if (showPage("pagePayment", "ペイメントシステム", 1,1))
	{
	}
	
	var win = ui.getWindowByID("pagePayment");

	//imposta i decimali per le "coin" della pagina "parallel"
	for (var i=0; i<10; i++)
	{
		var obj = win.getChildByID("pagePayment_coin" +i);
		obj.setDecimals(da3.getDecimalsForPrices());	
	}

	pagePayment_onSelector();
	pagePayment_onPaymentMethod();
	
	//imposta i decimali per vari campi "moneta"
	win.getChildByID("pagePayment_creditMax").setDecimals(da3.getDecimalsForPrices());
	win.getChildByID("pagePayment_restMax").setDecimals(da3.getDecimalsForPrices());
	win.getChildByID("pagePayment_tokenV").setDecimals(da3.getDecimalsForPrices());
	win.getChildByID("pagePayment_maxCC").setDecimals(da3.getDecimalsForPrices());
	
	if (0 == pagePayment_interval1)
	{
		pagePayment_interval1 = setInterval (pagePayment_forever_tube_refresh, 800);
	}
	
}

function pagePayment_build()
{
	var win = ui.getWindowByID("pagePayment");
	var paymentMode = parseInt(win.getChildByID("pagePayment_general_payMethod").getSelectedOptionValue());

	var options = "0|ゼネラルオプション|1|MDB";
	
	if (paymentMode == 4) //MDB
		options += "|6|MDB TUBES";
	
	options += "|2|マシンID|3|RFIDカード";
	
	if (da3.isAlipayChinaActive())
		options += "|4|ALIPAY";
	options += "|5|PARALLEL";
	
	//var html = "<div class='UIOptionSmall' id='pagePayment_selector' data-option='" +options +"' data-onclick='pagePayment_onSelector()'></div>";
	//rheaSetElemHTML (rheaGetElemByID("pagePayment_selector"), html);
	var obj = win.getChildByID("pagePayment_selector");
	var selIndex = obj.getSelectedOptionIndex();
	obj.changeOptions (options);
	obj.selectOptionByIndex(selIndex);
}

function pagePayment_onSelector()
{
	var elem0 = rheaGetElemByID("pagePayment_general");
	var elem1 = rheaGetElemByID("pagePayment_mdb");
	var elem2 = rheaGetElemByID("pagePayment_mid");
	var elem3 = rheaGetElemByID("pagePayment_rfid");
	var elem4 = rheaGetElemByID("pagePayment_alipayChina");
	var elem5 = rheaGetElemByID("pagePayment_parallel");
	var elem6 = rheaGetElemByID("pagePayment_mdbTubes");

	rheaHideElem(elem0);
	rheaHideElem(elem1);
	rheaHideElem(elem2);
	rheaHideElem(elem3);
	rheaHideElem(elem4);
	rheaHideElem(elem5);
	rheaHideElem(elem6);
	
	var win = ui.getWindowByID("pagePayment");
	switch (parseInt(win.getChildByID("pagePayment_selector").getSelectedOptionValue()))
	{
		default: rheaShowElem(elem0); break;
		case 1:  rheaShowElem(elem1); break;
		case 2:  rheaShowElem(elem2); break;
		case 3:  rheaShowElem(elem3); break;
		case 4:  
			rheaShowElem(elem4); 
			rhea.ajax ("AliChinaGetConnDetail", "").then( function(result)
			{
				var data = JSON.parse(result);
				rheaSetElemHTML(rheaGetElemByID("pagePayment_alichina_ip"), data.ip1 +"." +data.ip2 +"." +data.ip3 +"." +data.ip4);
				rheaSetElemHTML(rheaGetElemByID("pagePayment_alichina_port"), data.port);
				rheaSetElemHTML(rheaGetElemByID("pagePayment_alichina_mid"), data.mid);
				rheaSetElemHTML(rheaGetElemByID("pagePayment_alichina_key"), data.key);
				
			})
			.catch( function(result)
			{
				console.log ("ERROR[" +result +"]");
			});	
			break;
			
		case 5:  rheaShowElem(elem5); break;
		case 6:  
			rheaShowElem(elem6);
			//pagePayment_tube_refresh();
			break;
	}
	
	ui.getWindowByID("pagePayment").showHideScrollBar();
}

function pagePayment_onPaymentMethod()
{
	var win = ui.getWindowByID("pagePayment");
	var paymentMode = parseInt(win.getChildByID("pagePayment_general_payMethod").getSelectedOptionValue());
	switch (paymentMode)
	{
	default:
		rheaHideElem(rheaGetElemByID("pagePayment_general_trExe1"));
		rheaHideElem(rheaGetElemByID("pagePayment_general_trExe2"));
		break;
		
	case 2: //EXECUTIVE
		rheaSetElemHTML(rheaGetElemByID("pagePayment_general_trExe2_label"), "決済タイムアウト");
		rheaHideElem(rheaGetElemByID("pagePayment_general_trExe1"));
		rheaShowElem_TR(rheaGetElemByID("pagePayment_general_trExe2"));
		break;
		
	case 3: //PRICE_HOLDING	
		rheaSetElemHTML(rheaGetElemByID("pagePayment_general_trExe2_label"), "決済タイムアウト");
		rheaShowElem_TR(rheaGetElemByID("pagePayment_general_trExe1"));
		rheaShowElem_TR(rheaGetElemByID("pagePayment_general_trExe2"));
		break;
		
	case 4: //MDB
		rheaSetElemHTML(rheaGetElemByID("pagePayment_general_trExe2_label"), "MDB タイムアウト<br><span class='tip'>0=デフォルトのタイムアウト設定を反映します</span>");
		rheaHideElem(rheaGetElemByID("pagePayment_general_trExe1"));
		rheaShowElem_TR(rheaGetElemByID("pagePayment_general_trExe2"));
		break;
		
		pagePayment_general_trExe2_label
	}
	
	pagePayment_build();
}

var pagePayment_tube_coinValue = [0,0,0,0,0,0];
var pagePayment_tube_ajaxRunning = 0;
var pagePayment_tube_started = 0;
function pagePayment_forever_tube_refresh()
{
	if ("pagePayment" == currentPageID)
	{
		if (ui.getWindowByID("pagePayment").getChildByID("pagePayment_selector").getSelectedOptionValue() == "6")
		{
			if (0 == pagePayment_tube_ajaxRunning)
			{
				pagePayment_tube_refresh();
				return;
			}
		}
	}
	
	if (pagePayment_tube_started == 1)
	{
		if (0 == pagePayment_tube_ajaxRunning)
		{
			pagePayment_tube_end();
			pagePayment_tube_started = 0;
		}		
	}
}

function pagePayment_tube_end()
{
	console.log ("pagePayment_tube_end");
	rhea.ajax ("getMdbTubesValue", {"begin":0}).then( function(result)
	{
	})
	.catch( function(result)
	{
		console.log ("AJAX::getMdbTubesValue(0) ERR=>" +result);
	});	
}

function pagePayment_tube_refresh()
{
	pagePayment_tube_started = 1;
	pagePayment_tube_ajaxRunning = 1;
	console.log ("pagePayment_tube_refresh...");
	rhea.ajax ("getMdbTubesValue", {"begin":1}).then( function(result)
	{
		var j = JSON.parse(result);
		var numDecimal = da3.getDecimalsForPrices();
		rheaSetElemHTML (rheaGetElemByID("pagePayment_mdbTubes_tot"), rheaFormatPrice (j.MDBtubeV, numDecimal, "."));

		pagePayment_tube_coinValue[0] = j.moneyValue1;
		pagePayment_tube_coinValue[1] = j.moneyValue2;
		pagePayment_tube_coinValue[2] = j.moneyValue3;
		pagePayment_tube_coinValue[3] = j.moneyValue4;
		pagePayment_tube_coinValue[4] = j.moneyValue5;
		pagePayment_tube_coinValue[5] = j.moneyValue6;

		for (var i=0; i<6; i++)
		{
			var coinValue = rheaFormatPrice (pagePayment_tube_coinValue[i], numDecimal, ".");
			rheaSetElemHTML (rheaGetElemByID("pagePayment_mdbTubes_t" +(i+1)), coinValue);
		}
		
		pagePayment_tube_ajaxRunning = 0;
	})
	.catch( function(result)
	{
		pagePayment_tube_ajaxRunning = 0;
		console.log ("AJAX::getMdbTubesValue(1) ERR=>" +result);
		pleaseWait_hide();
	});	
}

function pagePayment_tube_eject (tubeIndex_1toN)
{
	var coinValue = pagePayment_tube_coinValue[tubeIndex_1toN-1];
	//console.log ("pagePayment_tube_eject(" +tubeIndex_1toN +") [coin=" +coinValue +"]");
	rhea.ajax ("attivazioneMdbTubesEject", {"t":coinValue}).then( function(result)
	{
		console.log (result);
		//setTimeout (function() {pagePayment_tube_refresh(); }, 6000);
	})
	.catch( function(result)
	{
		console.log ("AJAX::attivazioneMdbTubesEject ERR=>" +result);
		pleaseWait_hide();
	});		
}

/***************************************************************************
 *
 * pageDevices
 *
 */
var pageDevices_selector = null;
function pageDevices_show()
{
	var win = ui.getWindowByID("pageDevices");
	if (showPage("pageDevices", "デバイス", 1,1))
	{
		//è la prima volta che visualizziamo la pagina
		pageDevices_selector = win.getChildByID("pageDevices_selectorVFlex");

		var selOptions = "";
		if (da3.isGruppoMicro())
			selOptions = "1|MICRO|0|OTHER";
		else
			selOptions = "1|VARIFLEX|2|VARIGRIND|0|OTHER";
		
		if (da3.isInstant())
			selOptions = "0|OTHER";
	
		if (da3.hasCapab_SUPPORTA_SNACK() && !da3.hasCapab_NO_PAYMENT_SYSTEM())
			selOptions += "|3|SNACK";
		
		if (da3.isMotherboardD23())
			selOptions += "|4|NETWORK";
		
		pageDevices_selector.changeOptions(selOptions);
		pageDevices_selector.selectOptionByIndex(0);
		if (pageDevices_selector.optionValue.length < 2)
			rheaHideElem(rheaGetElemByID("pageDevices_selectorTable"));
	
		if (da3.isInstant())
		{
			rheaHideElem(rheaGetElemByID("pageDevices_cofSensor"));
			rheaHideElem(rheaGetElemByID("pageDevices_grpTest"));
			rheaHideElem(rheaGetElemByID("pageDevices_motorTest"));
		}
		
		if (da3.isInstant() || da3.hasCapab_BOLLITORE_BELTRAMI_650())
			rheaHideElem(rheaGetElemByID("pageDevices_boilerSize"));		
		
		if (da3.isGruppoMicro())
		{
			rheaHideElem(rheaGetElemByID("pageDevices_cofSensor"));
			rheaHideElem(rheaGetElemByID("pageDevices_cupSensor"));
			rheaHideElem(rheaGetElemByID("pageDevices_vflex_autoAdjust"));
			rheaHideElem(rheaGetElemByID("pageDevices_vflex_deliveryPhase"));
			rheaHideElem(rheaGetElemByID("pageDevices_motorTest"));
			rheaHideElem(rheaGetElemByID("pageDevices_grpTest"));
			win.getChildByID("pageDevices_vflex_brewerDiam").changeCaptionByIndex(1,"40mm");
		}
		
		if (!da3.hasCapab_VARIFLEX_SPECIAL_MOV_1811())
		{
			rheaHideElem(rheaGetElemByID("pageDevices_vfles_specialMove1811_1"));
			rheaHideElem(rheaGetElemByID("pageDevices_vfles_specialMove1811_2"));
		}
		else
		{
			//normalmente dovrei mostrare entrambe le voci, ma per NST ne devo mostrare una sola
			if (da3.isCustomer_NESTLE())
				rheaHideElem(rheaGetElemByID("pageDevices_vfles_specialMove1811_1"));
		}

		//grinder speed test, valido solo per "multibona espresso"
		//Il valore viene memorizzato nella loc 7558 del da3
		//La locazione 7558 è usata sia per indicare se l'auto adjustment su varifilex 1 è attivo, sia per memorizzare lo speed dell'oFF09
		//Se il gruppo è micro, si usa il secondo caso, se il gruppo è vflex, si usa il primo
		if (da3.isGruppoMicro() && da3.isMachine_MultibonaEspresso())
		{
			rheaSetDisplayMode(rheaGetElemByID("pageDevices_grinderSpeedTest", "table-row"));
			rheaHideElem(rheaGetElemByID("pageDevices_vflex_v1AutoAdjust"));
			win.getChildByID("pageDevices_vflex_v1AutoAdjust").dontSaveToDa3();
		}
		else
		{
			rheaHideElem(rheaGetElemByID("pageDevices_grinderSpeedTest"));
			win.getChildByID("pageDevices_vflex_grnSpeedOff9").dontSaveToDa3();
		}
		
		if (da3.isInduzione())
			rheaHideElem(rheaGetElemByID("pageDevices_boilerSize"));
		
		if (!da3.isMachine_Brewmatic4Macine())
			rheaHideElem(rheaGetElemByID("pageDevices_vibrationTest"));
			
		var optionsForVGrindSelector = "1|VARIGRIND 1|2|VARIGRIND 2";
		for (var i=3; i<=da3.getNumMacine(); i++)
			optionsForVGrindSelector += "|" +i +"|VARIGRIND " +i;
		var uiVGrindSelector = win.getChildByID("pageDevices_vgrind_selector");
		uiVGrindSelector.changeOptions(optionsForVGrindSelector);
		uiVGrindSelector.selectOptionByIndex(0);
		
		for (var i=1; i<=4; i++)
			rheaSetDivHTMLByName("pageDevices_vgrind" +i +"_lastPos_caption", da3.read16( da3.getVarigrindLastPosDa3Loc(i) ));
		pageDevices_vgrind_setLastFluxAndPos(pageDevices_vgrind_lastFlux, pageDevices_vgrind_lastPos);
		
		
		if (da3.isMachine_Brewmatic4Macine())
		{
			rheaHideElem(rheaGetElemByID("pageDevices_cupSensor"));
			rheaShowElem_TR(rheaGetElemByID("pageDevices_cupSensorBrewmatic"));
		}
		else
		{
			rheaHideElem(rheaGetElemByID("pageDevices_cupSensorBrewmatic"));
		}
			
		if (da3.hasCapab_SENSORE_WENGLOR_CUP_PRESENCE())
		{
			rheaHideElem(rheaGetElemByID("pageDevices_cupSensor"));
			rheaShowElem_TR(rheaGetElemByID("pageDevices_cupSensorWenglor"));
			rheaShowElem_TR(rheaGetElemByID("pageDevices_cupSensorWenglorLive"));
			win.getChildByID("pageDevices_cupSensorOBJ").dontSaveToDa3();
		}
		else
		{
			rheaHideElem(rheaGetElemByID("pageDevices_cupSensorWenglor"));
			rheaHideElem(rheaGetElemByID("pageDevices_cupSensorWenglorLive"));
			win.getChildByID("pageDevices_cupSensorWenglorOBJ").dontSaveToDa3();
		}

	}


	//nella pagina snack, aggiusta i decimali per i prezzi 
	for (var i=1; i<=18; i++)
	{
		var obj = win.getChildByID("pageDevices_snack_prc" +i);
		obj.setDecimals(da3.getDecimalsForPrices());
	}
	
	pageDevices_getFlowMeterModel();

	currentTask = new TaskDevices();
	pageDevices_onSelector();
	pageDevices_onEnableAuto(1);
	pageDevices_onEnableAuto(2);
	pageDevices_onEnableAuto(3);
	pageDevices_onEnableAuto(4);
	
	if (da3.isMotherboardD23())
		pageDevices_network_showHideStuff();
}


var pageDevices_whichPage = 0;
function pageDevices_onSelector()
{
	var elem0 = rheaGetElemByID("pageDevices_general");
	var elem1 = rheaGetElemByID("pageDevices_vflex");
	var elem2 = rheaGetElemByID("pageDevices_vgrind");
	var elem3 = rheaGetElemByID("pageDevices_snack");
	var elem4 = rheaGetElemByID("pageDevices_network");

	rheaHideElem(elem0);
	rheaHideElem(elem1);
	rheaHideElem(elem2);
	rheaHideElem(elem3);
	rheaHideElem(elem4);
	
	pageDevices_network_stopForeverRefresh();
	
	var win = ui.getWindowByID("pageDevices");
	pageDevices_whichPage = parseInt(pageDevices_selector.getSelectedOptionValue());
	switch (pageDevices_whichPage)
	{
	default: 
		rheaShowElem(elem0); 
		break;
	case 1:  
		rheaShowElem(elem1); 
		break;
	case 2:  
		rheaShowElem(elem2); 
		pageDevices_onVGrindSelector();
		break;
	case 3:  
		rheaShowElem(elem3);
		break;
	case 4:  
		rheaShowElem(elem4); 
		pageDevices_network_onFirstTimeShow();
		break;
	}
	
	win.showHideScrollBar();
}

function pageDevices_snack_enterProg()
{
	pleaseWait_show();
	rhea.ajax ("snackEnterProg", "").then( function(result)
	{
		console.log (result);
		if (result!="OK")
		{
			pleaseWait_hide();
		}
		else
			currentTask.snackEnterProg();
	})
	.catch( function(result)
	{
		console.log ("AJAX::snackEnterProg ERR=>" +result);
		pleaseWait_hide();
	});	
}

function pageDevices_snack_exitProg()
{
	pleaseWait_show();
	rhea.ajax ("snackExitProg", "").then( function(result)
	{
		console.log (result);
		pleaseWait_hide();
	})
	.catch( function(result)
	{
		console.log ("AJAX::snackExitProg ERR=>" +result);
		pleaseWait_hide();
	});	
}

function pageDevices_snack_status()
{
	rhea.ajax ("snackGetState", "").then( function(result)
	{
		console.log (result);
	})
	.catch( function(result)
	{
		console.log ("AJAX::snackGetState, err=>" +result);
	});	
}

function pageDevices_getFlowMeterModel()
{
	rhea.ajax ("getFlowMeterModel", "").then( function(result)
	{
		var tipo = "";
		switch (parseInt(result))
		{
			case 0:  tipo = "モデル DIGMESA 2P"; break;
			case 1:  tipo = "モデル GICAR 4P"; break;
			case 3:  tipo = "CAN'T DETECT"; break;
			default: tipo = "UNSUPPORTED"; break;
		}
		
		rheaGetElemByID('divFlowMeterModelLabel')
		rheaSetElemHTML( rheaGetElemByID('divFlowMeterModelLabel'), tipo)
	})
	.catch( function(result)
	{
		console.log ("AJAX::getFlowMeterModel, err=>" +result);
	});	
}

function pageDevices_onVGrindSelector()
{
	var win = ui.getWindowByID("pageDevices");
	var uiSelector = win.getChildByID ("pageDevices_vgrind_selector");

	var n = uiSelector.getNumOptions();
	for (var i=0; i<n; i++)
		rheaHideElem (rheaGetElemByID("pageDevices_vgrind" +(i+1)));


	var selectedVGrindIndex = uiSelector.getSelectedOptionValue();
	currentTask.enterQueryMacinePos(selectedVGrindIndex);
	rheaShowElem (rheaGetElemByID("pageDevices_vgrind" +selectedVGrindIndex));
	win.showHideScrollBar();
}


function pageDevices_vgrind_runSelection(whichVG)
{
	var win = ui.getWindowByID("pageDevices");
	var selNum = parseInt(win.getChildByID("pageDevices_vgrind" +whichVG +"_selNum").getValue())
	
	//vogliamo far partire la selezione [selNum].
	//Devo verificare che la granulometria di questa selezione sia DISABLED o REFERRING, altrimenti non
	//la si può utilizzare per calibrare la macchina dato che con granulemtria FINE o ROUGHLY la CPU apre/chiude di suo la macina
	var da3Loc = 175 + 100 * (selNum-1);
	var gran = da3.read8(da3Loc);
	if (gran == 0 || gran == 2)	
		currentTask.runSelection(selNum);
	else
	{
		currentTask.messageBox ("警告：その選択は豆が細かすぎるか粗すぎる為、使用出来ない可能性があります。"); //you can't use this selection..please choose another one
	}
}

function pageDevices_vgrind_runSelection_onFinish()
{
	//chiedo le info relativamente all'ultimo flusso e posizione
	rhea.ajax ("getLastFluxInfo", "").then( function(result)
	{
		var data = JSON.parse(result);
		pageDevices_vgrind_setLastFluxAndPos (data.flux, data.grinderPos);
		pageDevices_vgrind_runSelection_onFinish2();
	})
	.catch( function(result)
	{
		pageDevices_vgrind_runSelection_onFinish2();
	});	
}

function pageDevices_vgrind_runSelection_onFinish2()
{
	pleaseWait_hide();
	if (pageDevices_whichPage == 3)
		currentTask.enterQueryMacinePos(2);
	else
		currentTask.enterQueryMacinePos(1);
}

var pageDevices_vgrind_lastFlux = -1;
var pageDevices_vgrind_lastPos = -1
function pageDevices_vgrind_setLastFluxAndPos(flux, pos)
{
	pageDevices_vgrind_lastFlux = flux;
	pageDevices_vgrind_lastPos = pos;
	
	if (flux < 0)
	{
		var msg = "最後のフラックス/位置：<br> <b> RUN選択</ b>をクリックしてください";
		for (var i=1; i<=4; i++)
		{
			rheaSetDivHTMLByName ("pageDevices_vgrind" +i +"_lastFlux_caption", msg);
			rheaHideElem (rheaGetElemByID ("pageDevices_vgrind" +i +"_lastFlux_btnUse"));
		}
	}
	else
	{
		//flux è di 3 cifre, con due decimali
		var s = flux.toString();
		while (s.length < 3) s = "0" +s;
		s = s.substr(0,1) +"." +s.substr(1,2);
		var msg = "Last flux: " +s +"<br>Last pos: " +pos;
		for (var i=1; i<=4; i++)
		{
			rheaSetDivHTMLByName ("pageDevices_vgrind" +i +"_lastFlux_caption", msg);
			rheaSetDisplayMode (rheaGetElemByID ("pageDevices_vgrind" +i +"_lastFlux_btnUse"), "table");
		}
		
		rheaSetDivHTMLByName("pageExpCalib_lastFlux", s +" cc/sec");
	}
}

function pageDevices_vgrind_useLastFluxAndPos(whichVG)
{
	var win = ui.getWindowByID("pageDevices");

	win.getChildByID("pageDevices_vgrind" +whichVG +"_refFlux").setValue(pageDevices_vgrind_lastFlux);
	
	da3.write16 ( da3.getVarigrindLastPosDa3Loc(whichVG), pageDevices_vgrind_lastPos);
	rheaSetDivHTMLByName("pageDevices_vgrind" +whichVG +"_lastPos_caption", pageDevices_vgrind_lastPos);
	
	//forzo un salvataggio dei dati
	save ( function() { pleaseWait_hide(); } );
}

function pageDevices_onEnableAuto(whichVG)
{
	if (da3.isGruppoMicro())
		return;
	var win = ui.getWindowByID("pageDevices");
	
	var tableName = "pageDevices_vgrind" +whichVG +"_params";
	var elemTable = rheaGetElemByID(tableName);
	
	var selectorName = "pageDevices_vgrind" +whichVG +"_selector";
	switch (parseInt(win.getChildByID(selectorName).getSelectedOptionValue()))
	{
		default: rheaHideElem(elemTable); break;
		case 1:  rheaSetDisplayMode(elemTable, "table"); break;
	}
	
	win.showHideScrollBar();
}

function pageDevices_startModemTest()					{ currentTask.runModemTest(); }
function pageDevices_startTestAssorbGruppo()			{ currentTask.runTestAssorbGruppo(); }
function pageDevices_startTestAssorbMotoriduttore()		{ currentTask.runTestAssorbMotoriduttore(); }
function pageDevices_startGrinderSpeedTest()			{ currentTask.runGrinderSpeedTest(1); }
function pageDevices_startBrewmaticVibrationTest()
{ 
	var win = ui.getWindowByID("pageDevices");
	var perc0_100 = win.getChildByID("pageDevices_vibrationTest_perc").getValue();
	currentTask.runScivoloBrewmatic (perc0_100);
}

function pageDevices_network_onFirstTimeShow()
{
	pleaseWait_show();
	pleaseWait_freeText_setText("Retrieving LAN settings...");
	pleaseWait_freeText_show();
	
	rheaSetElemHTML(rheaGetElemByID("pageDevices_network_mac"), "");
	rheaSetElemHTML(rheaGetElemByID("pageDevices_network_lanIP"), "");
	rheaSetElemHTML(rheaGetElemByID("pageDevices_network_wifiIP"), "");
	//rheaSetElemHTML(rheaGetElemByID("pageDevices_network_ssid"), "");

	pageDevices_network_stopForeverRefresh();
	pageDevices_network_refresh( function() {
		pleaseWait_hide();		
		pageDevices_network_startForeverRefresh();
	});
}

var pageDevice_handlerRefreshNetSettings = null;
function pageDevices_network_startForeverRefresh()
{
	if (null == pageDevice_handlerRefreshNetSettings)
	{
		console.log ("START NETWORK REFRESH");
		pageDevices_network_refresh();
		pageDevice_handlerRefreshNetSettings = setInterval (pageDevices_network_refresh, 5000);
	}
}

function pageDevices_network_stopForeverRefresh()
{
	if (null != pageDevice_handlerRefreshNetSettings)
	{
		console.log ("STOP NETWORK REFRESH");
		clearInterval (pageDevice_handlerRefreshNetSettings);
		pageDevice_handlerRefreshNetSettings = null;
	}
}

function pageLTEConfigBegin()
{
	rheaGetElemByID("pageLTEConfig_apn").value = "";
	rheaGetElemByID("pageLTEConfig_usr").value = "";
	rheaGetElemByID("pageLTEConfig_pwd").value = "";
	rheaShowElem (rheaGetElemByID("pageLTEConfig"));
	
	pleaseWait_hide
	rhea.ajax ("GetAPN", "").then( function(result)
	{
	console.log (result);
		var data = JSON.parse(result);
		console.log (data);
		rheaGetElemByID("pageLTEConfig_apn").value = data.APN;
		rheaGetElemByID("pageLTEConfig_usr").value = data.usr;
		rheaGetElemByID("pageLTEConfig_pwd").value = data.pwd;
		pleaseWait_hide();
	});		
}

function pageDevices_network_onLTEConfigEnd(bDoSave)
{
	if (1 == bDoSave)
	{
		pleaseWait_show()
		var APN = rheaGetElemByID("pageLTEConfig_apn").value;
		var usr = rheaGetElemByID("pageLTEConfig_usr").value;
		var pwd = rheaGetElemByID("pageLTEConfig_pwd").value;
		
		rhea.ajaxWithCustomTimeout ("SetAPN", {"APN":APN, "usr":usr, "pwd":pwd }, 20000).then( function(result)
		{
			pleaseWait_hide();
			rheaHideElem (rheaGetElemByID("pageLTEConfig"));
		});		
	}
	else
	{
		rheaHideElem (rheaGetElemByID("pageLTEConfig"));
	}
}


var pageDevice_handlerRefreshWifiSSID = null;
function pageDevices_network_startForeverSSIDRefresh()
{
	if (null == pageDevice_handlerRefreshWifiSSID)
	{
		console.log ("START SSID REFRESH");
		pageDevices_network_onScanWIFISSID_step2();
		pageDevice_handlerRefreshWifiSSID = setInterval (pageDevices_network_onScanWIFISSID_step2, 5000);
	}
}

function pageDevices_network_stopForeverSSIDRefresh()
{
	if (null != pageDevice_handlerRefreshWifiSSID)
	{
		console.log ("STOP SSID REFRESH");
		clearInterval (pageDevice_handlerRefreshWifiSSID);
		pageDevice_handlerRefreshWifiSSID = null;
	}
}



function pageDevices_network_refresh(callback)
{
	rhea.ajax ("getNetworkSettings", "").then( function(result)
	{
		var data = JSON.parse(result);
		//console.log (data);

		rheaSetElemHTML(rheaGetElemByID("pageDevices_network_verSecoOS"), data.verSECOOS);
		rheaSetElemHTML(rheaGetElemByID("pageDevices_network_lanIP"), data.ip_eth0);
		rheaSetElemHTML(rheaGetElemByID("pageDevices_network_wifiIP"), data.ip_wifi);
		rheaSetElemHTML(rheaGetElemByID("pageDevices_network_LTEIP"), data.ip_LTE);
		rheaSetElemHTML(rheaGetElemByID("pageDevices_network_mac"), data.mac);

		var win = ui.getWindowByID("pageDevices");
		win.getChildByID("pageDevices_network_LTE").selectOptionByValue(parseInt(data.LTE_enabled));
		rheaSetElemHTML(rheaGetElemByID("pageDevices_network_LTE_APN_info"), "APN: " +data.LTE_APN);

		win.getChildByID("pageDevices_network_WIFISelector").selectOptionByValue(data.wifi_enabled);
		var wifiSSID = data.wifi_SSID +"&nbsp;&nbsp;"; 
		if (data.wifi_SSID != "")
		{
			if (parseInt(data.wifi_isConnected) == 1)
				wifiSSID += "<span style='color:#0f0'>connected</span>";
			else
				wifiSSID += "<span style='color:#f00'>connecting...</span>";
		}
		pageDevices_helper_displaySSIDAndPwd (wifiSSID, data.wifi_pwd);
		pageDevices_network_showHideStuff();
		
		if (typeof callback !== undefined)
			setTimeout (callback, 10);
	})
	.catch( function(result)
	{
		console.log ("AJAX getNetworkSettings::ERR = " +result);
		if (typeof callback !== undefined)
			setTimeout (callback, 10);
	});	
}

function pageDevices_network_showHideStuff()
{
	var win = ui.getWindowByID("pageDevices");
	var sel = win.getChildByID("pageDevices_network_WIFISelector");
	if (sel.getSelectedOptionValue() == 0)
	{
		//modalità hot spot
		rheaHideElem(rheaGetElemByID("pageDevices_network_wifi_ssid"));
	}
	else
	{
		//modalità ssid
		rheaShowElem(rheaGetElemByID("pageDevices_network_wifi_ssid"));
	}
	
	
	sel = win.getChildByID("pageDevices_network_LTE");
	if (sel.getSelectedOptionValue() == 0)
	{
		//LTE disabled
		rheaHideElem(rheaGetElemByID("pageDevices_network_LTE_APN"));
	}
	else
	{
		//LTE enabled
		rheaShowElem(rheaGetElemByID("pageDevices_network_LTE_APN"));
	}	
	
	win.showHideScrollBar();
}

function pageDevices_helper_displaySSIDAndPwd (ssid, pwd)
{
    rheaSetElemHTML(rheaGetElemByID("pageDevices_network_WIFI_ssidName"), "SSID: " +ssid);

    //trasformo pwd in "****"
    var asterisk = "";
    for (var i=0; i<pwd.length; i++)
        asterisk += "*";
    rheaSetElemHTML(rheaGetElemByID("pageDevices_network_WIFI_ssidPwd"), "PWD: " +asterisk);
}

function pageDevices_network_onWIFISelector()
{
	pageDevices_network_stopForeverRefresh();
	pageDevices_network_showHideStuff();
	//mostro la rotella per una 10a di secondi
	pleaseWait_show();
	setTimeout (pageDevices_network_onWIFISelector2, 5000);
}
function pageDevices_network_onWIFISelector2 (ssid_canBeUndefined, pwd_canBeUndefined)
{
	var win = ui.getWindowByID("pageDevices");
	var sel = win.getChildByID("pageDevices_network_WIFISelector");
	if (sel.getSelectedOptionValue() == 0)
	{
		rhea.ajax ("wifiSetMode", { "mode":0 }).then( function(result)
		{
			pleaseWait_hide();
			pageDevices_network_startForeverRefresh();;
		})
		.catch( function(result)
		{
			pleaseWait_hide();
			pageDevices_network_startForeverRefresh();
			console.log ("AJAX wifiSetMode(0)::ERR = " +result);
		});
	}
	else
	{
		var ssid = "";
		var pwd = "";
		if (typeof ssid_canBeUndefined !== "undefined")
			ssid = ssid_canBeUndefined;
		if (typeof pwd_canBeUndefined !== "undefined")
			pwd = pwd_canBeUndefined;
			
//console.log ("onWIFISelector2 [ssid=" +ssid +"][pwd=" +pwd +"]");
			
		pageDevices_helper_displaySSIDAndPwd (ssid, pwd);
		rhea.ajax ("wifiSetMode", { "mode":1, "SSID":ssid, "pwd":pwd }).then( function(result)
		{
			pleaseWait_hide();
			pageDevices_network_startForeverRefresh();
		})
		.catch( function(result)
		{
			pleaseWait_hide();
			pageDevices_network_startForeverRefresh();
			console.log ("AJAX wifiSetMode(1)::ERR = " +result);
		});
	}
	
}

function pageDevices_network_onLTEChanged()
{
	//mostro la rotella per una 10a di secondi
	pleaseWait_show();
	pageDevices_network_stopForeverRefresh();
	
	var win = ui.getWindowByID("pageDevices");
	if (0 == parseInt(win.getChildByID("pageDevices_network_LTE").getSelectedOptionValue()))
		rheaHideElem (rheaGetElemByID("pageDevices_network_LTE_APN"));
	else
		rheaShowElem_TABLE (rheaGetElemByID("pageDevices_network_LTE_APN"));
		
	setTimeout (pageDevices_network_onLTEChanged2, 5000);
}
function pageDevices_network_onLTEChanged2()
{
	var win = ui.getWindowByID("pageDevices");
	var sel = win.getChildByID("pageDevices_network_LTE");
	rhea.ajax ("LTEModemEnable", { "e":sel.getSelectedOptionValue() }).then( function(result)
	{
		pleaseWait_hide();
		pageDevices_network_startForeverRefresh();
	})
	.catch( function(result)
	{
		console.log ("AJAX LTEModemEnable::ERR = " +result);
		pleaseWait_hide();
		pageDevices_network_startForeverRefresh();
	});		
}

function pageDevices_network_onScanWIFISSID()
{
	//mostro la rotella per una qualche secondo
	pageDevices_network_stopForeverRefresh();
	pleaseWait_show();
	setTimeout (pageDevices_network_onScanWIFISSID_step2, 2000);
}
function pageDevices_network_onScanWIFISSID_step2()	
{
	rhea.ajax ("wifiGetSSIDList", "").then( function(result)
	{
		pleaseWait_hide();
		//pageDevices_network_startForeverRefresh();
		
		console.log ("wifiGetSSIDList => " +result);
		var data = JSON.parse(result);
		//console.log (data);
		var nSSID = parseInt(data.n);
		var ssidList = data.list.split("|");
		
		var html = "";
		
		if (nSSID == 0)
			html = "Searching for SSID...";
		else
		{
			html = "<ul>";
			for (var i=0; i<nSSID; i++)	
				html += "<li onmousedown='pageDevices_network_onWiFiSSIDChoosen(\""+ ssidList[i] +"\")'>" +ssidList[i] +"</li>";
			html += "</ul>";
		}
		rheaSetDivHTMLByName("pagePasswordForWiFi_list_cnt", html);
		rheaShowElem (rheaGetElemByID("pagePasswordForWiFi_list"));
		rheaHideElem (rheaGetElemByID("pagePasswordForWiFi_pwd"));
		rheaShowElem (rheaGetElemByID("pagePasswordForWiFi"));
		
		pageDevices_network_startForeverSSIDRefresh();		
	})
	.catch( function(result)
	{
		pleaseWait_hide();
		//pageDevices_network_startForeverRefresh();
		console.log ("AJAX wifiGetSSIDList::ERR = " +result);
		pageDevices_network_startForeverSSIDRefresh();		
	});	
}

var pageDevices_ssidName = "";
function pageDevices_network_onWiFiSSIDChoosen (ssidName)
{
	//E' stata scelta una rete SSID, chiedo di inserire la pwd
	pageDevices_ssidName = ssidName;
	pageDevices_network_stopForeverRefresh();
	pageDevices_network_stopForeverSSIDRefresh();

	rheaHideElem (rheaGetElemByID("pagePasswordForWiFi_list"));
	rheaGetElemByID("txtPasswordForWiFi").value = "";
	rheaShowElem (rheaGetElemByID("pagePasswordForWiFi_pwd"));
	rheaShowElem(rheaGetElemByID("pagePasswordForWiFi"));
}

function pageDevices_network_onWiFiPwdEntered ()
{
	var ssidPwd = rheaGetElemByID("txtPasswordForWiFi").value;
	pageDevices_network_hidePagePasswordWiFi();
	if (pageDevices_ssidName == "rheaguest" && ssidPwd=="")
		ssidPwd = "rhea*02mag21";
	pageDevices_network_onWIFISelector2 (pageDevices_ssidName, ssidPwd);	
}

function pageDevices_network_hidePagePasswordWiFi ()
{
	pageDevices_network_stopForeverSSIDRefresh();
	pageDevices_network_stopForeverRefresh();
	pageDevices_network_startForeverRefresh();
	rheaHideElem(rheaGetElemByID("pagePasswordForWiFi"));
}

/***************************************************************************
 *
 * pageDataAudit
 *
 */
var taskResetEVA = new TaskResetEVA();
var pageDA_secretBtnCounter = 0;
var pageDA_secretBtnLastTimeClickedMSec=0;
function pageDataAudit_show (bShowCompleteMenu)
{
	if (showPage("pageDataAudit", "データー　オーデット", 1,0))
	{
		pageDataAudit_downloadEVA();
		
		var node = document.getElementById("divSecretDAResetButton");		
		node.addEventListener("mousedown", function (ev)
		{
			var timeNowMSec = ev.timeStamp;
			if (timeNowMSec - pageDA_secretBtnLastTimeClickedMSec > 1000)
				pageDA_secretBtnCounter = 0;
			pageDA_secretBtnLastTimeClickedMSec = timeNowMSec;
			pageDA_secretBtnCounter++;
			console.log ("pageDA_secretBtnCounter[" +pageDA_secretBtnCounter +"]");
			if (pageDA_secretBtnCounter >= 6)
			{
				pageDA_secretBtnCounter=0;
				setTimeout (function(){pageDataAudit_showSecretDaResetButtonWindow();}, 100);
			}
		}, 
		true);
	}
	
	if (bShowCompleteMenu==0)
		btnBack_setCallback ("gotoHMI()");
	
	var win = ui.getWindowByID("pageDataAudit");
	var selector = win.getChildByID("pageDataAudit_selector");
	if (bShowCompleteMenu)
		selector.changeOptions ("0|概要|1|合計|2|累計|4|プレセレクション|3|データの更新");
	else
		selector.changeOptions ("1|合計|4|プレセレクション");
	selector.selectOptionByIndex(0);
	pageDataAudit_onSelector();
}

function pageDataAudit_showSecretDaResetButtonWindow()
{
	pleaseWait_show();
	currentTask = new TaskDAResetTotals();
}

function pageDataAudit_showSecretDaResetButtonWindow_finished()
{
	pleaseWait_hide();
	currentTask = voidTask;
}

function toCurrency (numberIN, numDecimali)
{
	var s = numberIN.toString();
	if (numDecimali == 0)
		return s;
		
	while (s.length < numDecimali)
		s = "0" +s;

	var n = s.length;
	if (n == numDecimali)
		return "0." +s;
		
	return s.substr(0, n-numDecimali) +"." +s.substr(n-numDecimali, numDecimali);
}

function formatInteger(x) { return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " "); }

function pageDataAudit_build_overview (numSelezioni, numDecimali, buffer, offset)
{
	var col = [];
	var html = "<table class='dataAudit' align='center'><tr valign='bottom'>"
				+"<th>&nbsp;</th>"
				+"<th colspan='2' align='center'>NUM PAID (VA1)</th>"
				+"<th colspan='2' align='center'>NUM FREEVEND (VA3)</th>"
				+"<th colspan='2' align='center'>NUM TESTVEND (VA2)</th>"
			+"</tr><tr valign='bottom'>"
				+"<th style='width:100px'>&nbsp;</th>"
				+"<th style='width:130px'>TOT</th>"
				+"<th style='width:130px'>PAR</th>"
				+"<th style='width:130px'>TOT</th>"
				+"<th style='width:130px'>PAR</th>"
				+"<th style='width:130px'>TOT</th>"
				+"<th style='width:130px'>PAR</th>"
			+"</tr>";

	//VA101/2/3
	var va101 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	var va102 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	var va103 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	var va104 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;

	var va201 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	var va202 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	var va203 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	var va204 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	
	var va301 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	var va302 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	var va303 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
	var va304 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;

	html += "<tr>"
				+"<td>TOTALS</td>"
				+"<td>" +formatInteger(va102) +"</td>"
				+"<td>" +formatInteger(va104) +"</td>"
				+"<td>" +formatInteger(va302) +"</td>"
				+"<td>" +formatInteger(va304) +"</td>"
				+"<td>" +formatInteger(va202) +"</td>"
				+"<td>" +formatInteger(va204) +"</td>"
			+"</tr></table><br>";
				
				
				
	html += "<table class='dataAudit' align='center'><tr valign='bottom'>"
				+"<th>&nbsp;</th>"
				+"<th colspan='2' align='center'>NUM PAID (PA2)</th>"
				+"<th colspan='2' align='center'>NUM FREEVEND (PA4)</th>"
				+"<th colspan='2' align='center'>NUM TESTVEND (PA3)</th>"
			+"</tr><tr valign='bottom'>"
				+"<th style='width:100px'>SEL NUM</th>"
				+"<th style='width:130px'>TOT</th>"
				+"<th style='width:130px'>PAR</th>"
				+"<th style='width:130px'>TOT</th>"
				+"<th style='width:130px'>PAR</th>"
				+"<th style='width:130px'>TOT</th>"
				+"<th style='width:130px'>PAR</th>"
			+"</tr>";
			
	for (var i=0; i<numSelezioni; i++)
	{
		var selNum = (i+1).toString();
		if (selNum.length<2) selNum = "0"+selNum;
		
		var pa201 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		var pa202 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		var pa203 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		var pa204 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;		
		
		var pa301 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		var pa302 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		var pa303 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		var pa304 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;		

		var pa401 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		var pa402 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		var pa403 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		var pa404 = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;		
		
		var rowCss="";
		if (pa201+pa203+ pa301+pa303 +pa401+pa403==0)
			rowCss = " class='rowAllZero'";		
		html += "<tr" +rowCss +">"
				+"<td>#" +selNum +"</td>"
				+"<td>" +formatInteger(pa201) +"</td>"
				+"<td>" +formatInteger(pa203) +"</td>"
				+"<td>" +formatInteger(pa401) +"</td>"
				+"<td>" +formatInteger(pa403) +"</td>"
				+"<td>" +formatInteger(pa301) +"</td>"
				+"<td>" +formatInteger(pa303) +"</td>"
			+"</tr>";
	}
	html += "</table>";
	
	rheaSetDivHTMLByName("pageDataAudit_o", html);
}

function pageDataAudit_build_fromBuffer(numSelezioni, numDecimali, buffer, offset)
{
	var htmlTable = "<table class='dataAudit' align='center'><tr valign='bottom'>"
				+"<th>SEL NUM</th>"
				+"<th>NUM PAID<br>PRICE1</th>"
				+"<th>NUM PAID<br>HAPPY</th>"
				+"<th>NUM<br>FREEVEND</th>"
				+"<th>NUM<br>TESTVEND</th>"
				+"<th>NUM TOTAL</th>"
				+"<td style='width:100px'>&nbsp;</td>"
				+"<th>MONEY<br>PRICE1</th>"
				+"<th>MONEY<br>PRICE2</th>"
				+"<th>MONEY TOTAL</th>"
				+"</tr>";
	
	var html = "";	
	var rowSum = [0,0,0,0,0,0,0,0,0,0,0,0];
	for (var i=0; i<numSelezioni; i++)
	{
		var selNum = (i+1).toString();
		if (selNum.length<2) selNum = "0"+selNum;
		
		var col = [];
		col[0] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[1] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[2] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[3] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[4] = col[0] +col[1] +col[2] +col[3];
		col[5] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[6] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[7] = col[5] +col[6];
		
		for (var i2=0; i2<=7;i2++)
			rowSum[i2] += col[i2];
			
		var rowCss="";
		if (parseFloat(col[4]) == 0 && parseFloat(col[7]) == 0)
			rowCss = " class='rowAllZero'";
		html += "<tr" +rowCss +">"
					+"<td>#" +selNum +"</td>"
					+"<td>" +formatInteger(col[0]) +"</td>"
					+"<td>" +formatInteger(col[1]) +"</td>"
					+"<td>" +formatInteger(col[2]) +"</td>"
					+"<td>" +formatInteger(col[3]) +"</td>"
					+"<td><b>" +formatInteger(col[4]) +"</b></td>"
					+"<td></td>"
					+"<td>" +toCurrency(col[5], numDecimali) +"</td>"
					+"<td>" +toCurrency(col[6], numDecimali) +"</td>"
					+"<td><b>" +toCurrency(col[7], numDecimali) +"</b></td>"
				+"</tr>";
	}

	//totali di riga
	var htmlTotali = "<tr class='rowTot'>"
				+"<td>TOTALS</td>"
				+"<td>" +formatInteger(rowSum[0]) +"</td>"
				+"<td>" +formatInteger(rowSum[1]) +"</td>"
				+"<td>" +formatInteger(rowSum[2]) +"</td>"
				+"<td>" +formatInteger(rowSum[3]) +"</td>"
				+"<td><b>" +formatInteger(rowSum[4]) +"</b></td>"
				+"<td></td>"
				+"<td>" +toCurrency(rowSum[5], numDecimali) +"</td>"
				+"<td>" +toCurrency(rowSum[6], numDecimali) +"</td>"
				+"<td><b>" +toCurrency(rowSum[7], numDecimali) +"</b></td>"
			+"</tr>";
	
	return htmlTable + htmlTotali +html +"</table>";
}

function pageDataAudit_build_partial(numSelezioni, numDecimali, buffer, offset)		{ rheaSetDivHTMLByName("pageDataAudit_p", pageDataAudit_build_fromBuffer(numSelezioni, numDecimali, buffer, offset)); }
function pageDataAudit_build_total(numSelezioni, numDecimali, buffer, offset)		{ rheaSetDivHTMLByName("pageDataAudit_t", pageDataAudit_build_fromBuffer(numSelezioni, numDecimali, buffer, offset)); }
function  pageDataAudit_onSelector()
{
	var elemO = rheaGetElemByID("pageDataAudit_o");
	var elemP = rheaGetElemByID("pageDataAudit_p");
	var elemT = rheaGetElemByID("pageDataAudit_t");
	var elemR = rheaGetElemByID("pageDataAudit_r");
	var elemPRS = rheaGetElemByID("pageDataAudit_prs");
	
	rheaHideElem(elemO);
	rheaHideElem(elemP);
	rheaHideElem(elemT);
	rheaHideElem(elemR);
	rheaHideElem(elemPRS);
	
	var win = ui.getWindowByID("pageDataAudit");
	switch (parseInt(win.getChildByID("pageDataAudit_selector").getSelectedOptionValue()))
	{
		case 0: rheaShowElem(elemO); break;
		case 1: rheaShowElem(elemP); break;
		case 2: rheaShowElem(elemT); break;
		case 3: rheaShowElem(elemR); break;
		case 4: rheaShowElem(elemPRS); break;
	}
	win.showHideScrollBar();
}

function pageDataAudit_build_preselection(numPresel, numDecimali, buffer, offset)
{
	if (0 == numPresel)
	{
		rheaSetElemHTML (rheaGetElemByID("pageDataAudit_prs"), "<br><br><center>表示するものはありません</center>");
		return;
	}
	var htmlTable = "<table class='dataAudit' align='center'><tr valign='bottom'>"
				+"<th>PP101<br>PRESEL NUM</th>"
				+"<th>PP102<br><br>PRICE1</th>"
				+"<th>PP103<br><br>NAME</th>"
				+"<th>PP104<br><br>&nbsp;</th>"
				+"<th>PP105<br>NUM SINCE START</th>"
				+"<th>PP106<br>VALUE SINCE START</th>"
				+"<th>PP107<br>NUM SINCE RESET</th>"
				+"<th>PP108<br>VALUE SINCE RESET</th>"
				+"</tr>";
	
	var html = "";	
	for (var i=0; i<numPresel; i++)
	{
		var col = [];
		col[0] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[1] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[2] = "";
		col[3] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[4] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[5] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[6] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;
		col[7] = rheaReadU32FromUint8Buffer(buffer, offset); offset+=4;

		var nameLen = buffer[offset++];
		while (nameLen--)
			col[2] += String.fromCharCode (buffer[offset++]);

		if (col[0].length<2) col[0] = "0"+col[0];
		html += "<tr>"
					+"<td>#" +col[0] +"</td>"
					+"<td>" +toCurrency(col[1], numDecimali) +"</td>"
					+"<td>" +col[2] +"</td>"
					+"<td>" +toCurrency(col[3], numDecimali) +"</td>"
					+"<td>" +formatInteger(col[4]) +"</td>"
					+"<td>" +toCurrency(col[5], numDecimali) +"</td>"
					+"<td>" +formatInteger(col[6]) +"</td>"
					+"<td>" +toCurrency(col[7], numDecimali) +"</td>"
				+"</tr>";
	}
	rheaSetElemHTML (rheaGetElemByID("pageDataAudit_prs"), htmlTable + html +"</table>");
}

function pageDataAudit_resetPartialData()
{
	pleaseWait_show();
	pleaseWait_btn1_setText("YES, do reset partial data");
	pleaseWait_btn1_show();

	pleaseWait_btn2_setText("NO, do NOT reset partial data");
	pleaseWait_btn2_show();

	pleaseWait_freeText_setText ("You're about to reset partial EVA-DTS data.<br><br>Do you confirm?");
	pleaseWait_freeText_show();
	currentTask = taskResetEVA;
}


function pageDataAudit_downloadEVA()
{
	pleaseWait_show();
	rheaSetDivHTMLByName("pageDataAudit_o", "");
	rheaSetDivHTMLByName("pageDataAudit_t", "");
	rheaSetDivHTMLByName("pageDataAudit_p", "");

	currentTask = new TaskDataAudit();
}

function pageDataAudit_downloadEVA_onFinish()
{
	if (currentTask.bufferSize != 0)
	{
		//download riuscito
		//console.log (currentTask.buffer);
		
		rheaSetDivHTMLByName("pageDataAudit_lastDownload", "EVA-DTS, last downloaded on " +dataOra_getYYYYMMDD() +" " +dataOra_getHHMM(":"));
		
		var numSelezioni = parseInt(currentTask.buffer[1]);
		var numDecimali  = parseInt(currentTask.buffer[2]);
		var numPresel    = parseInt(currentTask.buffer[3]);
		var addrBloccoGeneral = rheaReadU32FromUint8Buffer(currentTask.buffer, 4);
		var addrBloccoPartial = rheaReadU32FromUint8Buffer(currentTask.buffer, 8);
		var addrBloccoTotal = rheaReadU32FromUint8Buffer(currentTask.buffer, 12);
		var addrBloccoPreselezioni = rheaReadU32FromUint8Buffer(currentTask.buffer, 16);
		
		
		pageDataAudit_build_overview(numSelezioni, numDecimali, currentTask.buffer, addrBloccoGeneral);;
		pageDataAudit_build_partial (numSelezioni, numDecimali, currentTask.buffer, addrBloccoPartial);
		pageDataAudit_build_total (numSelezioni, numDecimali, currentTask.buffer, addrBloccoTotal);
		pageDataAudit_build_preselection(numPresel, numDecimali, currentTask.buffer, addrBloccoPreselezioni);

		var win = ui.getWindowByID("pageDataAudit");
		var selector = win.getChildByID("pageDataAudit_selector");
		if (selector.optionValue.length > 4)
			selector.selectOptionByValue(0);
		else
			selector.selectOptionByValue(1);
		pageDataAudit_onSelector();
	}
	
	pleaseWait_hide();
	currentTask = voidTask;
}

/***************************************************************************
 *
 * pageExpCalib
 *
 */
var taskEspressoCalib = null;
var pageExpCalib_macina1o2 = 1;
function pageExpCalib_show()
{
	var win = ui.getWindowByID("pageExpCalib");
	if (showPage("pageExpCalib", "コーヒーキャリブレーション", 1,0))
	{
		//è la prima volta che visualizziamo la pagina
		if (da3.isGruppoMicro())
		{
			rheaHideElem(rheaGetElemByID("pageExpCalib_rowvarigrind"));
			rheaHideElem(rheaGetElemByID("pageExpCalib_rowimpulsi"));
			rheaHideElem(rheaGetElemByID("pagePleaseWait_calibration_1_varigrind"));
		}
		
		var optionsForGrinder = "1|1|2|2";
		for (var i=2; i<da3.getNumMacine(); i++)
			optionsForGrinder += "|" +(i+1) +"|" +(i+1);			
		var uiOptions = win.getChildByID("pageExpCalib_macina1o2");
		uiOptions.changeOptions (optionsForGrinder);
		uiOptions.selectOptionByIndex(0);
	}
	btnTestSelection_hide();

	if (null == taskEspressoCalib)
		taskEspressoCalib = new TaskEspressoCalib();
	currentTask = taskEspressoCalib;
	currentTask.setMacina(pageExpCalib_macina1o2);
	pageExpCalib_refreshCalibValueOnScreen();
}

function pageExpCalib_regolaVG()
{
	var win = ui.getWindowByID("pageExpCalib");
	var target = parseInt(win.getChildByID("pageExpCalib_vg_target").getValue());
	
	if (da3.isVarigrindAutoRegolationEnabled(currentTask.macina1o2))
	{
		currentTask.messageBox("Varigrind Auto-Regulationが有効になっているため、現在のVARIGRIND位置を変更することはできません。<br>デバイス> Varigrindと無効にしてください");
	}
	else
		currentTask.enterSetMacinaPos(target);
}

function pageExpCalib_editSelection()
{
	currentTask = voidTask;
	pleaseWait_show();
	var win = ui.getWindowByID("pageExpCalib");
	var selNum = parseInt(win.getChildByID("pageExpCalib_selNum").getValue())
	pageSingleSelection_show(selNum);
	btnBack_setCallback("pageExpCalib_show()");
}

function pageExpCalib_runSelection()
{
	var win = ui.getWindowByID("pageExpCalib");
	var selNum = parseInt(win.getChildByID("pageExpCalib_selNum").getValue());
	
	//vogliamo far partire la selezione [selNum].
	//Devo verificare che la granulometria di questa selezione sia DISABLED o REFERRING, altrimenti non
	//la si può utilizzare per calibrare la macchina dato che con granulemtria FINE o ROUGHLY la CPU apre/chiude di suo la macina
	var da3Loc = 175 + 100 * (selNum-1);
	var gran = da3.read8(da3Loc);
	if (gran == 0 || gran == 2)	
		currentTask.runSelection(selNum);
	else
	{
		currentTask.messageBox ("警告：その選択は豆が細かすぎるか粗すぎる為、使用出来ない可能性があります。"); //you can't use this selection..please choose another one
	}
}

function pageExpCalib_runSelection_onFinish()
{
	//chiedo le info relativamente all'ultimo flusso e posizione
	rhea.ajax ("getLastFluxInfo", "").then( function(result)
	{
		var data = JSON.parse(result);
		pageDevices_vgrind_setLastFluxAndPos(data.flux, data.grinderPos);
		pageExpCalib_runSelection_onFinish2();
	})
	.catch( function(result)
	{
		pageExpCalib_runSelection_onFinish2();
	});	
}

function pageExpCalib_runSelection_onFinish2()
{
	pleaseWait_hide();
	currentTask.enterQueryMacinePos();
}

function pageExpCalib_resetMacinaCalib()
{
	pleaseWait_show();
	var motor = 10 + currentTask.macina1o2;
	rhea.ajax ("setFattoreCalib", { "m":motor, "v":0}).then( function(result)
	{
		rheaSetDivHTMLByName("pageExpCalib_grSec", "0");
		da3.setCalibFactorGSec(motor, 0);
		da3.setImpulsi(motor,0);
		rheaSetDivHTMLByName("pageExpCalib_imp", "0.00");
		
		setTimeout ( function() { save (function() { pleaseWait_hide();}); }, 1000);
	})
	.catch( function(result)
	{
		pleaseWait_hide();
	});
}

function pageExpCalib_startMacinaCalib ()
{
	if (da3.isVarigrindAutoRegolationEnabled(currentTask.macina1o2))
	{
		currentTask.messageBox("You can't start calibration because Varigrind auto-regulation is enabled.<br>Please go to DEVICES > VARIGRIND and disable it");
		return;
	}
	
	pleaseWait_show();
	var macina = currentTask.macina1o2;
	currentTask = taskCalibMotor;
	
	var bAlsoCalcImpulses = 1;
	if (da3.isGruppoMicro())
		bAlsoCalcImpulses = 0;
	taskCalibMotor.startCalibrazioneMacina(macina, bAlsoCalcImpulses);
}

function pageExpCalib_onFinish ()
{
	save (function() { currentTask = taskEspressoCalib; pageExpCalib_refreshCalibValueOnScreen(); pleaseWait_hide();});
}

function pageExpCalib_refreshCalibValueOnScreen()
{
	//macina num
	var motor = 10 + currentTask.macina1o2;
	
	var v = helper_intToFixedOnePointDecimal( da3.getCalibFactorGSec(motor) );
	if (v == 0)
		rheaSetDivHTMLByName("pageExpCalib_grSec", "0");
	else
		rheaSetDivHTMLByName("pageExpCalib_grSec", v +"&nbsp;gr/sec");
	
	v = helper_decodeImpulsi(da3.getImpulsi(motor));
	if (v == 0)
		rheaSetDivHTMLByName("pageExpCalib_imp", "0");
	else
		rheaSetDivHTMLByName("pageExpCalib_imp", v +"&nbsp;imp/gr");
		
	if (da3.isVarigrindAutoRegolationEnabled(currentTask.macina1o2))
		rheaSetDivHTMLByName("pageExpCalib_vgAutoAjustEnabled", "オートレギュレーション：有効");
	else
		rheaSetDivHTMLByName("pageExpCalib_vgAutoAjustEnabled", "オートレギュレーション：無効");
	
}

function pageExpCalib_onChangeGrinder()
{
	pleaseWait_show();
	var win = ui.getWindowByID("pageExpCalib");

	pageExpCalib_macina1o2 = parseInt(win.getChildByID("pageExpCalib_macina1o2").getSelectedOptionValue());
	if (pageExpCalib_macina1o2 == 0 || pageExpCalib_macina1o2 > da3.getNumMacine())
		pageExpCalib_macina1o2 = 1;

	rheaSetDivHTMLByName("pageExpCalib_vgCurPos", "");
	win.getChildByID("pageExpCalib_vg_target").setValue(0);
	
	setTimeout ( function() {pageExpCalib_show();}, 200);
}


/***************************************************************************
 *
 * pageDebugLang
 *
 */
var PAGE_DEBUGLANG_FIRST_TABLE_ID = 1;
var PAGE_DEBUGLANG_LAST_TABLE_ID = 16;
function pageDebugLang_show()
{
	if (showPage("pageDebugLang", "DEBUG LANGUAGES", 1,0))
	{
		//è la prima volta che visualizziamo la pagina
		pageDebugLang_build();
		pageDebugLang_refresh();
	}
	
	pageDebugLang_onSelector();
}

function pageDebugLang_onSelector()
{
	var win = ui.getWindowByID("pageDebugLang");
	var uiSelector = win.getChildByID("pageDebugLang_selector");
	var n = uiSelector.optionValue.length;
	
	for (var i=1; i<=n; i++)
		rheaHideElem(rheaGetElemByID("pageDebugLang_content" +i));
	
	rheaShowElem(rheaGetElemByID("pageDebugLang_content" +uiSelector.getSelectedOptionValue()));
	win.showHideScrollBar();
}


function pageDebugLang_build()
{
	var htmlTabHeader = "<table class='dataAudit'>"
				+"<tr>"
					+"<th style='text-align:right'>TabID</th>"
					+"<th style='text-align:right'>Row</th>"
					+"<th style='text-align:left'>MESSAGE</th>"
				+"</tr>";
	var html1="";
	var html2="";
	for (var i=PAGE_DEBUGLANG_FIRST_TABLE_ID; i<=PAGE_DEBUGLANG_LAST_TABLE_ID; i++)
	{
		var tableID = i;
		var idTabID = "pageDebugLang_c1_" +tableID;
		var idRowNum = idTabID +"_rowNum";
		var idMessage = idTabID +"_msg";
		html1 += "<tr><td id='" +idTabID +"'></td><td id='" +idRowNum +"' align='right'></td><td style='text-align:left' id='" +idMessage +"'></td>";
		
		idTabID = "pageDebugLang_c2_" +tableID;
		idRowNum = idTabID +"_rowNum";
		idMessage = idTabID +"_msg";
		html2 += "<tr><td id='" +idTabID +"'></td><td id='" +idRowNum +"' align='right'></td><td style='text-align:left' id='" +idMessage +"'></td>";
	}
	
	html1 += "</table>";
	html2 += "</table>";

	rheaSetElemHTML (rheaGetElemByID("pageDebugLang_content1"), htmlTabHeader + html1);
	rheaSetElemHTML (rheaGetElemByID("pageDebugLang_content2"), htmlTabHeader + html2);
}

function pageDebugLang_refresh()
{
	pageDebugLang_refreshSingle (PAGE_DEBUGLANG_FIRST_TABLE_ID, 1);
	pageDebugLang_refreshSingle (PAGE_DEBUGLANG_FIRST_TABLE_ID, 2);
}
	
function pageDebugLang_refreshSingle (tabID, langNum)
{
	console.log ("pageDebugLang_refreshSingle(" +tabID +"," +langNum +")");
	rhea.ajax ("askMsgFromLangTable", {"tabID":tabID, "rowNum":255, "lang":langNum}).then( function(result)
	{
		var idTabID = "pageDebugLang_c" +langNum +"_" +tabID;
		var idRowNum = idTabID +"_rowNum";
		var idMessage = idTabID +"_msg";
		
		rheaSetElemHTML(rheaGetElemByID(idTabID), tabID);

		try
		{
			var j = JSON.parse(result);
			rheaSetElemHTML(rheaGetElemByID(idRowNum), j.rowNum);
			rheaSetElemHTML(rheaGetElemByID(idMessage), j.msg);
		}
		catch (error)
		{
			rheaSetElemHTML(rheaGetElemByID(idRowNum), "§");
			rheaSetElemHTML(rheaGetElemByID(idMessage), "§§§§§§§§§§§");
		}
		
		
		tabID++;
		if (tabID <= PAGE_DEBUGLANG_LAST_TABLE_ID)
			setTimeout (pageDebugLang_refreshSingle(tabID, langNum), 100);
		else
			ui.getWindowByID("pageDebugLang").showHideScrollBar();
	})
	.catch( function(result)
	{
		console.log ("AJAX TIMEOUT: pageDebugLang_refresh => askMsgFromLangTable. ERR=[" +result +"]");
		setTimeout (pageDebugLang_refreshSingle(tabID, langNum), 200);
	});		
}

function pageMilker_refreshTuningSpeedPump()
{
	var win = ui.getWindowByID("pageMilker");
	
	//tuning velocita' pompa latte x cappuccinatore indux

	var com_indirizzo=8366;	
	var com_valore=da3.read16(com_indirizzo);		
	if ((com_valore < 70) || (com_valore > 130)) com_valore=100;
	var com_valore_vis= (com_valore - 100) ;
    if (com_valore_vis < 0) com_valore_vis = com_valore_vis * -1;
		
	var com_visual="pageMilker_tSpeedT";
	var com_visual_val = "pageMilker_tSpeedV";
	var com_tuning = win.getChildByID(com_visual_val);
		
	if ((com_valore > 69) && (com_valore < 100))
	{
		rheaSetDivHTMLByName(com_visual, "-");
		operTuningSpeedMilkPump="-";
	}		
	else
	{		
		rheaSetDivHTMLByName(com_visual, "+");	
		operTuningSpeedMilkPump="+";			
	}
	
	rheaShowElem(rheaGetElemByID(com_visual));	
	com_tuning.setValue(com_valore_vis);
	rheaShowElem(rheaGetElemByID(com_visual_val));
}

function pageMilker_tuningPumpP()				 
{
	operTuningSpeedMilkPump="+";
	rheaSetDivHTMLByName("pageMilker_tSpeedT", "+");
	var com_segno = "pageMilker_tSpeedT";
	rheaShowElem(rheaGetElemByID(com_segno));	
}

function pageMilker_tuningPumpM()	 
{
	operTuningSpeedMilkPump="-";
	rheaSetDivHTMLByName("pageMilker_tSpeedT", "-");
	var com_segno = "pageMilker_tSpeedT";
	rheaShowElem(rheaGetElemByID(com_segno)); 		
}

function pageMilker_tuningPumpReset()
{
    var win = ui.getWindowByID("pageMilker");
    win.getChildByID("pageMilker_tSpeedV").setValue("00");
    pageMilker_tuningPumpP();    
}    
    
/***************************************************************************
*
* pageMilker - calculae Milk Pump Tuning - +/- 30%
*
*/
function pageMilker_tuningPumpStart()					//@TP - #1885
{			
    	areYouSureYouWishToLaunchTheChosenOperation(
			function YES()
			{
				pleaseWait_show();
				rhea.requestGPUEvent(RHEA_EVENT_CPU_MESSAGE);
				currentTask = taskCalibMilkPump;
			    InitTaskCalibMilkPump();
			}
		);
}		

function InitTaskCalibMilkPump()						//@TP - #1885
{
	taskCalibMilkPump.startCalibMilkPump();
}

function pageMilker_dispenseAgainWater()				//@TP - #1885
{
	pleaseWait_calibMilkPump_dispenseWater_hide();
	pleaseWait_calibMilkPump_num_hide();
	pleaseWait_btn1_hide();
	pleaseWait_calibMilkPump_setText("");
	taskCalibMilkPump.fase = 15;
	taskCalibMilkPump.what = 1;
}

function pageMilker_tuningPumpOnFinish()				//@TP - #1885
{ 
	currentTask = voidTask;
	pageMilker_refreshTuningSpeedPump();
	pleaseWait_hide(); 
}


function pageDebug_show()
{
	if (showPage("pageDebug", "DEBUG", 1, 0))
	{
	}
}

function pageDebug_onBtnSend()
{
	rheaHideElem(rheaGetElemByID("pageDebug_snd"));
	
	var divOUT = rheaGetElemByID("pageDebug_answ");
	rheaSetElemHTML (divOUT, "");

	var win = ui.getWindowByID("pageDebug");
	var n0 = win.getChildByID("pageDebug_num0").getValue();
	var n1 = win.getChildByID("pageDebug_num1").getValue();
	var n2 = win.getChildByID("pageDebug_num2").getValue();
	var n3 = win.getChildByID("pageDebug_num3").getValue();
	var n4 = win.getChildByID("pageDebug_num4").getValue();

							
	rhea.ajax ("debugBtn", {"n0":n0,"n1":n1,"n2":n2,"n3":n3,"n4":n4}).then( function(result)
	{
		rheaSetElemHTML (divOUT, result);
		rheaShowElem_TABLE(rheaGetElemByID("pageDebug_snd"));
	})
	.catch( function(result)
	{
		rheaSetElemHTML (divOUT, "ERROR: " +result);
		rheaShowElem_TABLE(rheaGetElemByID("pageDebug_snd"));
	});		
	
}

function quit()
{
	if(isTEMPESTIVECLOUD())
	{
		TempestiveCloud.quit();
	}
}
</script>
</html>

